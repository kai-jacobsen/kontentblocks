/*! Kontentblocks ProdVersion 2015-03-03 07:03 */
KB.Fields.BaseView=Backbone.View.extend({rerender:function(){this.render()}}),KB.Fields.register("Fonticonpicker",function(a){return{init:function(){a(".kb-fonticonpicker").fontIconPicker({source:["icon-heart","icon-search","icon-user","icon-tag","icon-help"],emptyIcon:!1,hasSearch:!1})},update:function(){this.init()},frontUpdate:function(){this.init()}}}(jQuery)),KB.Fields.register("Gallery",function(a){return{init:function(b){a(".kb-gallery--stage",a("body")).each(function(c,d){var e=a(d).closest(".kb-js-field-identifier").attr("id"),f=KB.payload.Fields[e].baseId,g=b||KB.Views.Modules.get(a(d).data("module"))||new KB.FieldCollection,h=a(d).data("fieldkey"),i=a(d).data("arraykey");if(g.hasField(h,i))g.getField(h,i).bootstrap.call(g.getField(h,i));else{var j=new KB.Gallery.Controller({baseId:f,fid:e,key:h,arrayKey:i,el:d});g.addField(h,j,i)}})},update:function(){this.init()},frontUpdate:function(a){this.init(a)}}}(jQuery)),KB.Gallery={},KB.Gallery.ImageView=Backbone.View.extend({tagName:"div",className:"kb-gallery--image-wrapper",initialize:function(a){this.parentView=a.parentView,this.uid=this.model.get("uid")||_.uniqueId("kbg"),this.editorAdded=!1,this._remove=!1},events:{"click .kb-gallery--js-edit":"edit","click .kb-gallery--js-delete":"delete","click .kb-gallery--js-meta-close":"close"},edit:function(){this.$el.wrap('<div class="kb-gallery--item-placeholder kb-gallery--image-wrapper"></div>'),this._placeholder=this.$el.parent(),this.$el.addClass("kb-gallery--active-item kb_field").appendTo("body"),jQuery("#wpwrap").addClass("module-browser-open"),this.handleEditor(),KB.Ui.initTabs()},handleEditor:function(){var a=this;$re=jQuery(".kb-js--remote-editor",this.$el);var b=this.createInputName(this.uid)+"[details][description]";if(this.editorAdded)KB.TinyMCE.addEditor($re,null,150);else{var c=KB.TinyMCE.remoteGetEditor($re,b,this.uid,this.model.get("details").description,null,!1,!1);c.done(function(b){a.editorAdded=b,KB.Ui.initTabs()})}},"delete":function(){this._remove?(this.$el.fadeTo(450,1).css("borderColor","#ccc"),jQuery(".kb-gallery--image-remove",this.$el).val(""),this._remove=!1):(this.$el.fadeTo(450,.5).css("borderColor","red"),this._remove=!0,jQuery(".kb-gallery--image-remove",this.$el).val("true"))},remove:function(){this.$el.remove(),delete this.$el},close:function(){var a=tinymce.get(this.uid+"_ededitor"),b=this.model.get("details");b.description=this.getEditorContent(a),tinymce.remove(a),this.$el.appendTo(this._placeholder).unwrap(),this.$el.removeClass("kb-gallery--active-item").removeClass("kb_field"),jQuery("#wpwrap").removeClass("module-browser-open")},getEditorContent:function(a){var b=jQuery("#wp-"+this.uid+"_ededitor-wrap"),c=b.hasClass("tmce-active");if(c)return a.getContent();var d=document.getElementById(this.uid+"_ededitor").value;return d=d.replace(/<br\s*\/?>/gm,"\n"),a.setContent(d),d},render:function(){var a=this.createInputName(this.uid),b=this.model.toJSON();return this.$el.append(KB.Templates.render("fields/Gallery/single-image",{image:b,id:b.id,inputName:a,uid:this.uid}))},createInputName:function(a){return this.createBaseId()+"["+this.parentView.params.key+"][images]["+a+"]"},createBaseId:function(){return _.isEmpty(this.parentView.params.arrayKey)?this.parentView.parentModuleId:this.parentView.parentModuleId+"["+this.parentView.params.arrayKey+"]"}}),KB.Gallery.Controller=Backbone.View.extend({initialize:function(a){this.params=a,this.fieldArgs=KB.Payload.getFieldArgs(a.fid),this.parentModuleId=a.baseId,this._frame=null,this.subviews=[],this._initialized=!1,this.bootstrap(),KB.FrontendEditModal&&this.listenTo(KB.FrontendEditModal,"kb:frontend-save",this.frontendSave)},events:{"click .kb-gallery--js-add-images":"addImages"},bootstrap:function(){this._initialized?_K.log("Fields: Gallery instance was already initialized. Doing nothing."):(this.setupElements(),this.initialSetup(),this._initialized=!0,_K.log("Fields: Gallery instance created and initialized"))},setupElements:function(){this.$list=jQuery('<div class="kb-gallery--item-list"></div>').appendTo(this.$el),this.$list.sortable({revert:!0,delay:300}),this.$addButton=jQuery('<a class="button button-primary kb-gallery--js-add-images">Add Images</a>').appendTo(this.$el)},addImages:function(){this.openModal()},frame:function(){return this._frame?this._frame:void 0},openModal:function(){var a=this;return this._frame?void this._frame.open():(this._frame=wp.media({title:KB.i18n.Refields.image.modalTitle,button:{text:KB.i18n.Refields.common.select},multiple:!0,library:{type:"image"}}),this._frame.state("library").on("select",function(){a.select(this)}),this._frame.open(),this._frame)},select:function(a){var b=a.get("selection");b.length>0&&this.handleModalSelection(b.models)},handleModalSelection:function(a){var b=this;_.each(a,function(a){var c={file:a.toJSON(),details:{title:"",alt:"",description:""},id:a.get("id")},d=new Backbone.Model(c),e=new KB.Gallery.ImageView({model:d,parentView:b});b.subviews.push=e,b.$list.append(e.render()),KB.FrontendEditModal&&KB.FrontendEditModal.trigger("recalibrate")})},initialSetup:function(){var a=this,b=KB.Payload.getFieldData("gallery",this.parentModuleId,this.params.key,this.params.arrayKey);b.length>0&&_.each(b,function(b){var c=new Backbone.Model(b),d=new KB.Gallery.ImageView({model:c,parentView:a});a.subviews.push(d),a.$list.append(d.render())})},frontendSave:function(){var a=this;this.subviews.length>0&&_.each(this.subviews,function(b,c){b._remove&&(delete a.subviews[c],b.remove())})}}),KB.Fields.register("GalleryRedux",function(){return{$input:null,init:function(){},update:function(){this.init()},updateFront:function(){this.init()}}}(jQuery)),KB.Fields.register("OpeningTimes",function(a){return{init:function(){a(".otimes-field--stage",a("body")).each(function(b,c){var d=a(c);a(".kb-ot-timepicker",d).datetimepicker({datepicker:!1,format:"H:i",validateOnBlur:!1})}),a(".js-oday-activate-split").on("click",function(){a(this).parent().find("table").toggleClass("split")})},update:function(){this.init()},frontUpdate:function(a){this.init(a)}}}(jQuery)),KB.Fields.register("Plupload",function(a){return{init:function(b){if(wp&&wp.media){wp.media.controller.KBImageDetails=wp.media.controller.State.extend({defaults:_.defaults({id:"kb-image-details",title:"Hab nix",content:"image-details",menu:!1,router:!1,toolbar:"image-details",editing:!1,priority:60},wp.media.controller.Library.prototype.defaults),initialize:function(a){this.image=a.image,wp.media.controller.State.prototype.initialize.apply(this,arguments)},activate:function(){this.frame.modal.$el.addClass("kb-image-details")}});var c=wp.media.view.MediaFrame.ImageDetails;wp.media.view.MediaFrame.KBImageDetails=c.extend({initialize:function(){console.clear(),c.prototype.initialize.apply(this,arguments)},createStates:function(){this.states.add([new wp.media.controller.KBImageDetails({image:this.image,editable:!1}),new wp.media.controller.ImageDetails({image:this.image,editable:!1}),new wp.media.controller.ReplaceImage({id:"replace-image",library:wp.media.query({type:"image"}),image:this.image,multiple:!1,title:"Bla",toolbar:"replace",priority:80,displaySettings:!0}),new wp.media.controller.EditImage({image:this.image,selection:this.options.selection})])}}),a(".kb-plupload--stage",a("body")).each(function(c,d){var e=a(d).closest(".kb-js-field-identifier").attr("id"),f=KB.payload.Fields[e].baseId,g=b||KB.Views.Modules.get(a(d).data("module"))||new KB.FieldCollection,h=KB.payload.Fields[e].fieldkey,i=KB.payload.Fields[e].arrayKey;if(g.hasField(h,i))g.getField(h,i).bootstrap.call(g.getField(h,i));else{var j=new KB.Plupload.Controller({baseId:f,fid:e,key:h,arrayKey:i,el:d});g.addField(h,j,i)}}),jQuery.get(KB.Config.getFieldJsUrl()+"templates/plupload/partials/file-header.hbs",{async:!1},function(a){HandlebarsKB.registerPartial("plupload-file-header",a)})}},update:function(){this.init()},updateFront:function(a){this.init(a)}}}(jQuery)),KB.Plupload={},KB.Plupload.File=Backbone.Model.extend({initialize:function(a){this.original=a}}),KB.Plupload.UploadFileView=Backbone.View.extend({tagName:"li",className:"kb-plupload__file-item",template:"file-upload.hbs",initTemplate:"file-upload.hbs",events:{click:"openDetails"},initialize:function(){var a;this.model.original.View=this,a={file:this.model.toJSON()},this.$el.append(KB.Templates.render(KB.Config.getFieldJsUrl()+"templates/plupload/"+this.initTemplate,a)),this.$progress=this.$el.find(".kb-plupload__file-percent"),this.$progressBar=this.$el.find(".kb-plupload__file-percent-bar")},render:function(){return this.$el},updateProgress:function(a){this.$progress.html(a+"%"),this.$progressBar.css("width",a+"%")},updateView:function(){data={file:this.model.toJSON()},this.$el.html(KB.Templates.render(KB.Config.getFieldJsUrl()+"templates/plupload/"+this.template,data))},openDetails:function(){var a=this.model.get("attachment"),b=new wp.media.model.Attachment(a);this.kbFrame=new wp.media.view.MediaFrame.KBImageDetails({metadata:b.toJSON(),state:"kb-image-details"}),this.kbFrame.open()}}),KB.Plupload.ImageFileView=KB.Plupload.UploadFileView.extend({template:"file-image.hbs"}),KB.Plupload.VideoFileView=KB.Plupload.UploadFileView.extend({template:"file-video.hbs",openDetails:function(){console.log(this)}}),KB.Plupload.FileCollection=Backbone.Collection.extend({model:KB.Plupload.File}),KB.Plupload.FileRenderer=Backbone.View.extend({tagName:"ul",className:"kb-plupload__file-list",initialize:function(a){this.subviews={},this.controller=a.controller,this.listenTo(this.collection,"add",this.addView),this.listenTo(this.collection,"remove",this.removeView),this.$el.appendTo(this.controller.$el)},addView:function(a){var b=this.detectViewType(a),c=new b({model:a});this.$el.append(c.render())},removeView:function(a){console.log("remove:",a)},detectViewType:function(a){var b;return b=a.get("type"),-1!==b.search("image")?KB.Plupload.ImageFileView:-1!==b.search("video")?KB.Plupload.VideoFileView:-1!==b.search("pdf")?KB.Plupload.PdfFileView:KB.Plupload.GenericFileView}}),KB.Plupload.Controller=Backbone.View.extend({Uploader:{},initialize:function(a){var b=this;this.Collection=new KB.Plupload.FileCollection,this.FileRenderer=new KB.Plupload.FileRenderer({collection:this.Collection,controller:this}),this.params=a,this.fieldArgs=KB.Payload.getFieldArgs(a.fid),this._initialized=!1,this.customSettings=this.fieldArgs.plupload||{},this.defaults=_.extend(KB.payload.defaults.plupload,this.customSettings,{container:a.fid+"-plupload__container",browse_button:a.fid+"-plupload-browse-button",drop_element:a.fid+"-plupload__drag-drop-area"}),this.Uploader=new plupload.Uploader(this.defaults),this.Uploader.init(),this.Uploader.bind("FilesAdded",function(a,c){c&&c.length>0&&_.each(c,function(a){b.Collection.add(a)}),a.refresh(),a.start()}),this.Uploader.bind("BeforeUpload",function(){}),this.Uploader.bind("Error",function(a,b){console.log(b),a.removeFile(b.file)}),this.Uploader.bind("UploadProgress",function(a,b){b.View.updateProgress(b.percent)}),this.Uploader.bind("FileUploaded",function(a,b,c){var d=JSON.parse(c.response);d.success&&b.View&&(b.View.model.set("attachment",d.data.attachment),b.View.updateView())}),this.bootstrap()},bootstrap:function(){this._initialized?_K.log("Fields: Plupload instance was already initialized. Doing nothing."):(this._initialized=!0,_K.log("Fields: Plupload instance created and initialized"))}}),KB.Fields.registerObject("color",KB.Fields.BaseView.extend({initialize:function(){this.render()},events:{"mouseup .kb-field--color":"recalibrate"},render:function(){this.$(".kb-color-picker").wpColorPicker({}),jQuery("body").on("click.wpcolorpicker",this.update)},derender:function(){jQuery("body").off("click.wpcolorpicker",this.update)},update:function(){KB.Events.trigger("modal.preview")},recalibrate:function(){_.delay(function(){KB.Events.trigger("modal.recalibrate")},150)}})),KB.Fields.registerObject("date",KB.Fields.BaseView.extend({initialize:function(){var a=this;this.defaults={format:"d M Y",offset:[0,250],onSelect:function(b,c,d){a.$machineIn.val(c),a.$unixIn.val(Math.round(d.getTime()/1e3))}},this.settings=this.model.get("options")||{},this.render()},render:function(){this.$machineIn=this.$(".kb-date-machine-format"),this.$unixIn=this.$(".kb-date-unix-format"),this.$(".kb-datepicker").Zebra_DatePicker(_.extend(this.defaults,this.settings))},derender:function(){}})),KB.Fields.registerObject("datetime",KB.Fields.BaseView.extend({initialize:function(){var a=this;this.defaults={format:"d.m.Y H:i",inline:!1,mask:!0,lang:"de",allowBlank:!0,onChangeDateTime:function(b){a.$unixIn.val(b.dateFormat("unixtime")),a.$sqlIn.val(b.dateFormat("Y-m-d H:i:s"))}},this.setting=this.model.get("settings")||{},this.render()},render:function(){this.$unixIn=this.$(".kb-datetimepicker--js-unix"),this.$sqlIn=this.$(".kb-datetimepicker--js-sql"),this.$(".kb-datetimepicker").datetimepicker(_.extend(this.defaults,this.settings))},derender:function(){this.$(".kb-datetimepicker").datetimepicker("destroy")}})),KB.Fields.registerObject("file",KB.Fields.BaseView.extend({initialize:function(){this.render()},events:{"click .kb-js-add-file":"openFrame","click .kb-js-reset-file":"reset"},render:function(){this.$container=this.$(".kb-field-file-wrapper"),this.$IdIn=this.$(".kb-file-attachment-id"),this.$resetIn=this.$(".kb-js-reset-file")},derender:function(){this.frame&&(this.frame.dispose(),this.frame=null)},openFrame:function(){var a=this;return this.frame?this.frame.open():(this.frame=wp.media({title:KB.i18n.Refields.file.modalTitle,button:{text:KB.i18n.Refields.common.select},multiple:!1,library:{type:""}}),this.frame.on("ready",function(){a.ready(this)}),this.frame.state("library").on("select",function(){a.select(this)}),this.frame.open())},ready:function(){this.$(".media-modal").addClass(" smaller no-sidebar")},select:function(a){var b=a.get("selection").first();this.handleAttachment(b)},handleAttachment:function(a){this.$(".kb-file-filename",this.$container).html(a.get("filename")),this.$(".kb-file-attachment-id",this.$container).val(a.get("id")),this.$(".kb-file-title",this.$container).html(a.get("title")),this.$(".kb-file-id",this.$container).html(a.get("id")),this.$(".kb-file-editLink",this.$container).attr("href",a.get("editLink")),this.$resetIn.show(),this.$container.show(450,function(){KB.Events.trigger("modal.recalibrate")})},reset:function(){this.$IdIn.val(""),this.$container.hide(450),this.$resetIn.hide()}})),KB.Fields.registerObject("flexfields",KB.Fields.BaseView.extend({initialize:function(){this.render()},render:function(){this.$stage=this.$(".flexible-fields--stage"),this.createController()},derender:function(){this.FlexFieldsController.dispose()},rerender:function(){this.derender(),this.render()},createController:function(){return this.FlexFieldsController?(this.FlexFieldsController.setElement(this.$stage.get(0)),this.FlexFieldsController.render()):this.FlexFieldsController=new KB.FlexibleFields.Controller({el:this.$stage.get(0),model:this.model})}})),KB.FlexibleFields={},KB.FlexibleFields.ItemView=Backbone.View.extend({tagName:"li",className:"kb-flexible-fields--item-wrapper",initialize:function(a){this.Controller=a.Controller,this.listenTo(this.Controller,"dispose",this.dispose)},events:{"click .flexible-fields--js-toggle":"toggleItem","click .flexible-fields--js-trash":"deleteItem"},toggleItem:function(){this.$(".flexible-fields--toggle-title").next().slideToggle(250,function(){KB.Events.trigger("modal.recalibrate")})},deleteItem:function(){this.$el.hide(250);var a=this.createInputName(this.model.get("_tab").uid);this.$el.append('<input type="hidden" name="'+a+'[delete]" value="'+this.model.get("_tab").uid+'" >'),KB.Notice.notice("Please click update to save the changes","success")},render:function(){var a=this.createInputName(this.model.get("_tab").uid),b=this.model.toJSON(),c=this.$el.append(KB.Templates.render("fields/FlexibleFields/single-item",{item:b,inputName:a,uid:this.model.get("_tab").uid}));return this.renderTabs(c),c},renderTabs:function(a){var b=this,c=HandlebarsKB.compile("<li><a href='#tab-{{ uid }}-{{ index }}'>{{ tab.label }}</a></li>"),d=HandlebarsKB.compile("<div id='tab-{{ uid }}-{{ index }}'></div>");_.each(this.Controller.Tabs,function(e,f){jQuery(".flexible-field--tab-nav",a).append(c({uid:b.model.get("_tab").uid,tab:e,index:f}));var g=jQuery(".kb-field--tabs",a),h=jQuery(d({uid:b.model.get("_tab").uid,index:f})).appendTo(g);b.renderFields(e,h)})},renderFields:function(a,b){var c,d,e=this;_.each(a.fields,function(a){a.model.set("index",e.model.get("_tab").uid),c=KB.FieldsAPI.get(a),d=e.model.get("value"),_.isUndefined(d)||c.setValue(d.get(a.model.get("primeKey"))),b.append(c.render(e.uid)),b.append('<input type="hidden" name="'+c.model.get("baseId")+"["+c.model.get("index")+"][_mapping]["+c.model.get("primeKey")+']" value="'+c.model.get("type")+'" >'),c.$container=b,c.postRender&&c.postRender.call(c),setTimeout(function(){if(e.Controller.model.FieldView){e.Controller.model.FieldView.model.collection.add(c.model.toJSON())}},150)})},createInputName:function(a){return this.createBaseId()+"["+this.Controller.model.get("fieldkey")+"]["+a+"]"},createBaseId:function(){return _.isEmpty(this.Controller.model.get("arrayKey"))?this.Controller.model.get("fieldId"):this.Controller.model.get("fieldId")+"["+this.Controller.model.get("arrayKey")+"]"},dispose:function(){this.stopListening(),this.remove()}}),KB.FlexibleFields.Controller=Backbone.View.extend({initialize:function(){this.Tabs=this.setupConfig(),this.subviews=[],this.setupElements(),this.initialSetup()},events:{"click .kb-flexible-fields--js-add-item":"addItem"},initialSetup:function(){var a,b=this;a=this.model.get("value"),_.isEmpty(a)||_.each(a,function(a,c){var d=new KB.FlexibleFields.ItemView({Controller:b,model:new Backbone.Model({_tab:{title:a._tab.title,uid:c},value:new Backbone.Model(a)})});b.subviews.push(d),b.$list.append(d.render())}),KB.Ui.initTabs(),this.$list.sortable({handle:".flexible-fields--js-drag-handle",start:function(){KB.TinyMCE.removeEditors()},stop:function(){KB.TinyMCE.restoreEditors()}}),KB.Events.trigger("modal.recalibrate"),this._initialized=!0},render:function(){this.setupElements(),this.initialSetup()},setupConfig:function(){var a=this;return _.each(this.model.get("config"),function(b){b.fields&&(b.fields=a.setupFields(b.fields))}),this.model.get("config")},setupFields:function(a){var b=this;return _.each(a,function(c,d){c.baseId=b.model.get("baseId"),c.ModuleModel=b.model.get("ModuleModel"),c.fieldId=b.model.get("fieldId"),c.fieldKey=b.model.get("fieldkey"),c.arrayKey=b.model.get("arrayKey"),c.index=null,c.primeKey=d,a[d]=new Backbone.View({Controller:b,el:b.el,model:new Backbone.Model(c)})}),a},setupElements:function(){this.$list=jQuery('<ul class="flexible-fields--item-list"></ul>').appendTo(this.$el),this.$addButton=jQuery('<a class="button button-primary kb-flexible-fields--js-add-item">Add Item</a>').appendTo(this.$el)},addItem:function(){var a=new KB.FlexibleFields.ItemView({Controller:this,model:new Backbone.Model({_tab:{title:_.uniqueId("ff"),uid:_.uniqueId("ff")}})});this.subviews.push(a),this.$list.append(a.render()),KB.Ui.initTabs(),KB.Events.trigger("modal.recalibrate")},dispose:function(){this.trigger("dispose"),this.subviews=[]}}),KB.Fields.registerObject("image",KB.Fields.BaseView.extend({initialize:function(){this.defaultState="replace-image",this.defaultFrame="image",this.render()},events:{"click .kb-js-add-image":"openFrame","click .kb-js-reset-image":"resetImage"},render:function(){this.$reset=this.$(".kb-js-reset-image"),this.$container=this.$(".kb-field-image-container"),this.$saveId=this.$(".kb-js-image-id")},editImage:function(){this.openFrame(!0)},openFrame:function(){var a,b=this;this.frame&&this.frame.dispose();var c={};""!==this.model.get("value").id&&(c.post__in=[this.model.get("value").id]),wp.media.query(c).more().done(function(){var c=this.first();b.attachment=c,c?(c.set("attachment_id",c.get("id")),a=b.attachment.toJSON()):(a={},b.defaultFrame="select",b.defaultState="library"),b.frame=wp.media({frame:b.defaultFrame,state:b.defaultState,metadata:a,imageEditView:b,library:{type:"image"}}).on("update",function(a){b.update(a)}).on("ready",function(){b.ready()}).on("replace",function(){b.replace(b.frame.image.attachment)}).on("select",function(){var a=this.get("library").get("selection").first();b.replace(a)}).open()})},ready:function(){jQuery(".media-modal").addClass("smaller no-sidebar")},replace:function(a){this.attachment=a,this.handleAttachment(a)},update:function(a){this.attachment.set(a),this.attachment.sync("update",this.attachment)},handleAttachment:function(a){var b=this,c=a.get("id"),d=this.prepareValue(a),e=_.clone(this.model.get("ModuleModel").get("moduleData")),f=this.model.get("kpath");KB.Util.setIndex(e,f,d),this.model.get("ModuleModel").set("moduleData",e);var g={width:b.model.get("width")||null,height:b.model.get("height")||null,crop:b.model.get("crop")||!0,upscale:b.model.get("upscale")||!1};if(g.width&&g.height)jQuery.ajax({url:ajaxurl,data:{action:"fieldGetImage",args:g,id:c,_ajax_nonce:KB.Config.getNonce("read")},type:"GET",dataType:"json",success:function(a){b.$container.html('<img src="'+a+'" >')},error:function(){}});else{var h=a.get("sizes").thumbnail?a.get("sizes").thumbnail.url:a.get("sizes").full.url;this.$container.html('<img src="'+h+'" >')}this.$saveId.val(a.get("id")),KB.Events.trigger("modal.preview")},prepareValue:function(a){return{id:a.get("id"),title:a.get("title"),caption:a.get("caption"),alt:a.get("alt")}},resetImage:function(){this.$container.html(""),this.$saveId.val(""),this.model.set("value",{id:null})}})),KB.Fields.registerObject("link",KB.Fields.BaseView.extend({initialize:function(){this.render()},events:{"click .kb-js-add-link":"openModal"},render:function(){this.$input=this.$(".kb-js-link-input")},derender:function(){},openModal:function(){wpActiveEditor=this.$input.attr("id"),kb_restore_htmlUpdate=wpLink.htmlUpdate,kb_restore_isMce=wpLink.isMCE,wpLink.isMCE=this.isMCE,wpLink.htmlUpdate=this.htmlUpdate,wpLink.open()},htmlUpdate:function(){var a,b,c,d=wpLink.textarea;d&&(a=wpLink.getAttrs(),a.href&&"http://"!=a.href&&(b=a.href,c=a.title,jQuery(d).empty(),d.value=b,wpLink.close(),this.close(),d.focus()))},isMCE:function(){return!1},close:function(){wpLink.isMCE=kb_restore_isMce,wpLink.htmlUpdate=kb_restore_htmlUpdate}}));