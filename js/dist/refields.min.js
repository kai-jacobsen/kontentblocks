/*! kontentblocks 2013-11-16 */
var KB=KB||{};KB.Fields.Image=function($){function openMediaDialog(){return _frame?(_frame.open(),void 0):(_frame=wp.media({title:"My first Media Modal",button:{text:"whooop"},multiple:!1,library:{type:"image"}}),_frame.state("library").on("select",function(){var attachment=this.get("selection").first();handleAttachment(attachment)}),_frame.open(),void 0)}function handleAttachment(attachment){$container.html('<img src="'+attachment.get("sizes").thumbnail.url+'" >'),$id.val(attachment.get("id")),$title.val(attachment.get("title")),$caption.val(attachment.get("caption")),$(document).trigger("KB:osUpdate")}var $id,$title,$caption,selector=".kb-js-add-image",$container=null,$wrapper=null,_frame=null;$(document).on("click",selector,function(){$container=$(this),$wrapper=$(this).parent(),$id=$(".kb-js-image-id",$wrapper),$title=$(".kb-js-image-title",$wrapper),$caption=$(".kb-js-image-caption",$wrapper),openMediaDialog()})}(jQuery);