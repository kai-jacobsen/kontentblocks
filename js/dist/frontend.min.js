/*! Kontentblocks ProdVersion 2015-07-20 11:07 */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){b.exports=Backbone.View.extend({tagName:"div",className:"",isValid:function(){return!0}})},{}],2:[function(a,b,c){b.exports=Backbone.View.extend({initialize:function(a){this.Controller=a.Controller,this.ContextsViews=this.setupContextsViews(),this.isVisible=!0,this.listenTo(this.Controller,"columns.rendered",this.columnActivated),this.listenTo(this.Controller,"columns.reset",this.reset)},setupContextsViews:function(){var a={},b=this,c=this.$(".kb-context-container");return _.each(c,function(c,d){var e=c.dataset.kbcontext,f=KB.Contexts.get(e);a[f.View.cid]=f.View,f.View.isVisible=!0,f.View.ColumnView=b,b.listenTo(f.View,"context.activated",b.activateColumn)}),a},activateColumn:function(){this.trigger("column.activate",this)},columnActivated:function(a){a.cid!==this.cid?_.each(this.ContextsViews,function(a){a.renderProxy()}):_.each(this.ContextsViews,function(a){a.removeProxy()})},reset:function(){_.each(this.ContextsViews,function(a){a.removeProxy()})}})},{}],3:[function(a,b,c){var d=a("templates/backend/context-bar.hbs"),e=a("backend/Views/ContextUi/ContextUiView"),f=a("backend/Views/ContextUi/ContextColumnView"),g=a("backend/Views/ContextUi/controls/ResetControl"),h=a("backend/Views/ContextUi/controls/ColumnControl");b.exports=Backbone.View.extend({initialize:function(){var a=this;this.columns=this.setupColumns(),this.layoutBackup=this.createLayoutBackup(),this.cols=_.toArray(this.columns).length,this.render(),jQuery(window).resize(function(){a.resetLayout()})},setupColumns:function(){var a=this,b=this.$(".kb-context-col");return _.map(b,function(b){var c=new f({el:b,Controller:a});return a.listenTo(c,"column.activate",a.evalLayout),c})},render:function(){var a=jQuery(d({}));this.$el.before(a),this.BarView=new e({el:a}),this.setupMenuItems()},setupMenuItems:function(){var a=this;this.BarView.addItem(new g({model:this.model,parent:this})),_.each(this.columns,function(b){a.BarView.addItem(new h({model:a.model,parent:a,ColumnView:b}))})},createLayoutBackup:function(){var a={};return _.each(this.columns,function(b,c){a[c]=b.$el.attr("class")}),a},resetLayout:function(){var a=this;_.each(this.columns,function(b){b.isVisible||b.Control["switch"](),b.$el.attr("class",a.layoutBackup[b.cid]),b.$el.width("")}),this.trigger("columns.reset")},evalLayout:function(a){var b=this.$el.width()-20*this.cols,c=this.findProportion(this.cols);return 1100>b?!1:(_.each(this.columns,function(d){d.cid===a.cid?d.$el.width(Math.floor(b*c.large)):d.$el.width(Math.floor(b*c.small))}),void this.trigger("columns.rendered",a))},renderLayout:function(){var a=_.filter(this.columns,function(a){return a.isVisible}),b=a.length,c=this.$el.width()-20*b;_.each(a,function(a){a.$el.width(Math.floor(c*(100/b/100)))})},findProportion:function(a){switch(a){case 3:return{small:.1,large:.8};case 2:return{small:.3333,large:.6666};default:return{small:1,large:1}}}})},{"backend/Views/ContextUi/ContextColumnView":2,"backend/Views/ContextUi/ContextUiView":4,"backend/Views/ContextUi/controls/ColumnControl":5,"backend/Views/ContextUi/controls/ResetControl":6,"templates/backend/context-bar.hbs":62}],4:[function(a,b,c){var d=a("backend/Views/ModuleControls/ControlsView");b.exports=d.extend({initialize:function(){this.$menuList=jQuery(".kb-context-bar--actions",this.$el)}})},{"backend/Views/ModuleControls/ControlsView":7}],5:[function(a,b,c){var d=a("backend/Views/BaseControlView");b.exports=d.extend({initialize:function(a){this.options=a||{},this.Controller=a.parent,this.ColumnView=a.ColumnView,this.ColumnView.Control=this},className:"context-visibility",events:{click:"switch"},render:function(){this.$el.append('<span class="kb-button-small">'+this.ColumnView.$el.data("kbcolname")+"</span>")},isValid:function(){return!0},"switch":function(){this.$el.toggleClass("kb-context-hidden"),this.ColumnView.$el.toggle(),this.ColumnView.isVisible=!this.ColumnView.isVisible,this.Controller.renderLayout()}})},{"backend/Views/BaseControlView":1}],6:[function(a,b,c){var d=a("backend/Views/BaseControlView");b.exports=d.extend({initialize:function(a){this.options=a||{},this.Controller=a.parent},className:"context-reset-layout",events:{click:"resetLayout"},render:function(){this.$el.append('<span class="kb-button-small">Reset</span>')},isValid:function(){return!0},resetLayout:function(){this.Controller.resetLayout()}})},{"backend/Views/BaseControlView":1}],7:[function(a,b,c){var d=a("templates/backend/module-menu.hbs");b.exports=Backbone.View.extend({$menuWrap:{},$menuList:{},initialize:function(){this.$menuWrap=jQuery(".menu-wrap",this.$el),this.$menuWrap.append(d({})),this.$menuList=jQuery(".module-actions",this.$menuWrap)},addItem:function(a){if(a.isValid&&a.isValid()===!0){var b=jQuery("<li></li>").appendTo(this.$menuList),c=b.append(a.el);this.$menuList.append(c),a.render.call(a)}}})},{"templates/backend/module-menu.hbs":63}],8:[function(a,b,c){var d=a("common/Notice");b.exports={send:function(a,b,c,e){var f,g=e||{};f=a.postId?a.postId:KB.Environment&&KB.Environment.postId?KB.Environment.postId:!1;var h=_.extend({supplemental:a.supplemental||{},nonce:jQuery("#_kontentblocks_ajax_nonce").val(),post_id:f,kbajax:!0},a);return jQuery("#publish").attr("disabled","disabled"),jQuery.ajax({url:ajaxurl,data:h,type:"POST",dataType:"json",success:function(a){a&&(c&&b?b.call(c,a,g):b&&b(a,g))},error:function(){d.notice("<p>Generic Ajax Error</p>","error")},complete:function(){jQuery("#publish").removeAttr("disabled")}})}}},{"common/Notice":12}],9:[function(a,b,c){var d=a("common/Config");b.exports={blockLimit:function(a){var b=a.get("limit"),c=jQuery("#"+a.get("id")+" li.kb-module").length;return!(0!==b&&c===b)},userCan:function(a){var b=jQuery.inArray(a,d.get("caps"));return-1!==b}}},{"common/Config":10}],10:[function(a,b,c){var d=function(a){var b=KB.appData.config;return{get:function(a){return a?b[a]?b[a]:null:b},getNonce:function(a){var c=["update","create","delete","read"];return-1!==_.indexOf(c,a)?b.nonces[a]:(console.error("Invalid nonce requested in kb.cm.Config.js"),null)},inDevMode:function(){return b.env.dev},getRootURL:function(){return b.env.rootUrl},getFieldJsUrl:function(){return b.env.fieldJsUrl},getHash:function(){return b.env.hash}}}(jQuery);b.exports=d},{}],11:[function(a,b,c){var d=a("common/Config");Function.prototype.bind&&window.console&&"object"==typeof console.log&&["log","info","warn","error","assert","dir","clear","profile","profileEnd"].forEach(function(a){console[a]=this.bind(console[a],console)},Function.prototype.call),Logger.useDefaults();var e=Logger.get("_K"),f=Logger.get("_KS");e.setLevel(e.INFO),f.setLevel(f.INFO),d.inDevMode()||e.setLevel(Logger.OFF),Logger.setHandler(function(a,b){if(KB.Menubar&&2===b.level.value&&"_KS"===b.name)a[0]&&KB.Menubar.StatusBar.setMsg(a[0]);else{var c=window.console,d=c.log;b.name&&(a[0]="["+b.name+"] "+a[0]),b.level===Logger.WARN&&c.warn?d=c.warn:b.level===Logger.ERROR&&c.error?d=c.error:b.level===Logger.INFO&&c.info&&(d=c.info),d.apply(c,a)}}),b.exports={Debug:e,User:f}},{"common/Config":10}],12:[function(a,b,c){"use strict";b.exports={notice:function(a,b,c){var d=c||3;window.alertify.notify(a,b,d)},confirm:function(a,b,c,d,e){var f=a||"Title";window.alertify.confirm(f,b,function(){c.call(e)},function(){d.call(e)})}}},{}],13:[function(a,b,c){b.exports={getFieldData:function(a,b,c,d){var e;return this._typeExists(a)?(e=KB.payload.fieldData[a],e[b]?_.isEmpty(d)?e[b][c]?e[b][c]:[]:e[b][d]&&e[b][d][c]?e[b][d][c]:[]:[]):[]},_typeExists:function(a){return!_.isUndefined(KB.payload.fieldData[a])},getFieldArgs:function(a,b){return KB.payload.Fields&&KB.payload.Fields[a]?b&&KB.payload.Fields[a][b]?KB.payload.Fields[a][b]:KB.payload.Fields[a]:null},parseAdditionalJSON:function(a){var b;return b={Fields:[]},a&&a.Fields&&(b.Fields=KB.FieldConfigs.add(_.toArray(a.Fields))),b},getPayload:function(a){return KB&&KB.payload&&KB.payload[a]?KB.payload[a]:{}}}},{}],14:[function(a,b,c){var d=a("common/Config"),e=a("common/Utilities"),f=function(){function a(a,b,f,g){var h,i;if(b=b||{},g=g||this,h=f||null,!c[a]){var j=d.getRootURL()+"js/templates",k=j+"/"+a+".hbs?"+d.getHash(),l=/^https?:\/\//i;l.test(a)&&(k=a),e.stex.get(k)?(i=e.stex.get(k),h&&h.call(g)):jQuery.ajax({url:k,method:"GET",async:!1,success:function(a){i=a,e.stex.set(k,i,12e4),h&&h.call(g)}}),c[a]=HandlebarsKB.compile(i)}return c[a](b)}function b(a){if(!f[a]){var b;jQuery.ajax({url:a,method:"GET",async:!1,dataType:"html",success:function(a){b=a}}),f[a]=a}return f[a]}var c={},f={};return{render:a,helpfile:b}}();b.exports=f},{"common/Config":10,"common/Utilities":17}],15:[function(a,b,c){var d=a("common/Ajax"),e=a("common/Logger"),f=a("common/Config");b.exports={removeEditors:function(a){a||(a=jQuery("body")),jQuery(".wp-editor-area",a).each(function(){if("wp-content-wrap"===jQuery(this).attr("id")||"ghosteditor"===jQuery(this).attr("id"));else{var a=this.id;tinyMCE.execCommand("mceRemoveEditor",!0,a)}})},restoreEditors:function(a){a||(a=jQuery("body")),jQuery(".wp-editor-wrap",a).each(function(){var a=jQuery(this).find("textarea").attr("id"),b=jQuery(this).find("textarea");"ghosteditor"!==a&&(b.val(switchEditors.wpautop(b.val())),tinyMCE.execCommand("mceAddEditor",!0,a),switchEditors.go(a,"tmce"))})},addEditor:function(a,b,c,d){if(!a)return e.Debug.error("No scope element ($el) provided"),!1;if(_.isUndefined(tinyMCEPreInit))return!1;var f=c||350,g=_.isUndefined(d)?!0:!1;jQuery(".wp-editor-area",a).each(function(){var a=this.id,b=tinyMCE.get(a);b&&tinyMCE.execCommand("mceRemoveEditor",null,a);var c=_.clone(tinyMCEPreInit.mceInit.ghosteditor);c.elements=a,c.selector="#"+a,c.id=a,c.kblive=g,c.height=f,c.remove_linebreaks=!1,c.setup=function(a){a.on("init",function(){KB.Events.trigger("KB::tinymce.new-editor",a)}),a.on("change",function(){var b;a.module||(b=jQuery(a.editorContainer).closest(".kb-module"),a.module=KB.Views.Modules.get(b.attr("id"))),a.module.$el.trigger("tinymce.change")})},tinymce.init(c),tinyMCEPreInit.mceInit[a]||(tinyMCEPreInit.mceInit[a]=c);var d={buttons:"",disabled_buttons:"",id:a};window.quicktags(d)}),setTimeout(function(){jQuery(".wp-editor-wrap",a).removeClass("html-active").addClass("tmce-active"),window.QTags._buttonsInit()},1500)},remoteGetEditor:function(a,b,c,g,h,i,j){var k=h||KB.appData.config.post.ID,c=c||a.attr("id");if(!i)var i=!1;var l=g||"";return d.send({action:"getRemoteEditor",editorId:c+"_ed",editorName:b,post_id:k,editorContent:l,_ajax_nonce:f.getNonce("read"),args:{media_buttons:i}},function(b){b.success?(a.empty().append(b.data.html),this.addEditor(a,null,150,j)):e.Debug.info("Editor markup could not be retrieved from the server")},this)}}},{"common/Ajax":8,"common/Config":10,"common/Logger":11}],16:[function(a,b,c){var d=jQuery,e=a("common/Config"),f=a("common/Ajax"),g=a("common/TinyMCE"),h=a("common/Notice"),i=a("backend/Views/ContextUi/ContextRowGrid"),j={isSorting:!1,init:function(){var a=this,b=d("body");this.initTabs(),this.initSortable(),this.initSortableAreas(),this.initToggleBoxes(),this.flexContext(),this.flushLocalStorage(),this.initTipsy(),b.on("mousedown",".kb_field",function(a){activeField=this}),b.on("mousedown",".kb-module",function(a){activeBlock=this.id}),b.on("mouseenter",".kb-js-field-identifier",function(){KB.currentFieldId=this.id}),b.on("mouseenter",".kb-area__list-item li",function(){KB.currentModuleId=this.id}),jQuery(document).ajaxComplete(function(b,c,d){a.metaBoxReorder(b,c,d,"restore")}),jQuery(document).ajaxSend(function(b,c,d){a.metaBoxReorder(b,c,d,"remove")})},flexContext:function(){jQuery(".kb-context-row").each(function(a,b){var c=jQuery(b);c.data("KB.ContextRow",new i({el:b}))})},repaint:function(a){this.initTabs(),this.initToggleBoxes(),g.addEditor(a)},initTabs:function(a){var b=a||jQuery("body"),c=d(".kb_fieldtabs",b);c.tabs({activate:function(a,b){d(".kb-nano").nanoScroller({contentClass:"kb-nano-content"}),KB.Events.trigger("modal.recalibrate")}}),c.each(function(){var a=d(".ui-tabs-nav li",d(this)).length;1===a&&d(this).find(".ui-tabs-nav").css("display","none")})},initToggleBoxes:function(){d(".kb-togglebox-header").on("click",function(){d(this).next("div").slideToggle()}),d(".kb_fieldtoggles div:first-child").trigger("click")},initSortable:function(a){function b(){var a=f.get("limit"),b=c(f.get("id"));return-1===_.indexOf(f.get("assignedModules"),e.get("settings")["class"])?!1:0!==a&&b-1>=a?(h.notice("Not allowed here","error"),!1):!0}function c(a){return d("#"+a+" li.kb-module").length}var e,f,i=a||jQuery("body"),j=this;d(".kb-module-ui__sortable",i).sortable({placeholder:"ui-state-highlight",ghost:!0,connectWith:".kb-module-ui__sortable--connect",handle:".kb-move",cancel:"li.disabled, li.cantsort",tolerance:"pointer",delay:150,revert:350,start:function(a,b){j.isSorting=!0,d("#kontentblocks-core-ui").addClass("kb-is-sorting"),e=KB.Modules.get(b.item.attr("id")),f=KB.currentArea,d(KB).trigger("kb:sortable::start"),d(".kb-open").toggleClass("kb-open"),d(".kb-module__body").hide(),g.removeEditors(),d(document).trigger("kb_sortable_start",[a,b])},stop:function(a,b){j.isSorting=!1,d("#kontentblocks-core-ui").removeClass("kb-is-sorting"),g.restoreEditors(),d(document).trigger("kb_sortable_stop",[a,b]),e.get("open")&&e.View.toggleBody(155)},over:function(a,b){f=KB.Areas.get(this.id)},receive:function(a,c){b()||(h.notice("Module not allowed in this area","error"),d(c.sender).sortable("cancel"))},update:function(a,c){if(!b())return!1;if(this!==c.item.parent("ul")[0]||c.sender){if(c.sender){if(c.item.parent("ul")[0].id===c.sender.attr("id"))return!1;d.when(j.changeArea(f,e)).then(function(a){return a.success?void j.resort(c.sender):!1}).done(function(){j.triggerAreaChange(f,e),d(KB).trigger("kb:sortable::update"),e.View.clearFields(),h.notice("Area change and order were updated successfully","success")})}}else d.when(j.resort(c.sender)).done(function(a){return a.success?(d(KB).trigger("kb:sortable::update"),void h.notice(a.message,"success")):(h.notice(a.message,"error"),!1)})}})},flushLocalStorage:function(){var a=e.get("env").hash;store.get("kbhash")!==a&&(store.clear(),store.set("kbhash",a))},resort:function(a){var b={};return d(".kb-module-ui__sortable").each(function(){b[this.id]=d("#"+this.id).sortable("serialize",{attribute:"rel"})}),f.send({action:"resortModules",data:b,_ajax_nonce:e.getNonce("update")})},changeArea:function(a,b){return f.send({action:"changeArea",_ajax_nonce:e.getNonce("update"),mid:b.get("mid"),area_id:a.get("id"),context:a.get("context")})},triggerAreaChange:function(a,b){b.unsubscribeFromArea(),b.setArea(a)},toggleModule:function(){d("body").on("click",".kb-toggle",function(){KB.isLocked()&&!KB.userCan("lock_kontentblocks")?h.notice(kontentblocks.l18n.gen_no_permission,"alert"):(d(this).parent().nextAll(".kb-module__body:first").slideToggle("fast",function(){d("body").trigger("module::opened")}),d("#"+activeBlock).toggleClass("kb-open",1e3))})},initSortableAreas:function(){jQuery(".kb-context__inner").sortable({items:".kb-area__wrap",handle:".kb-area-move-handle",start:function(a,b){g.removeEditors()},stop:function(a,b){var c=jQuery("#post").serializeJSON(),d=c.kbcontext;d&&f.send({action:"updateContextAreaOrder",_ajax_nonce:e.getNonce("update"),data:d},function(a){a.success?h.notice(a.message,"success"):h.notice(a.message,"error"),g.restoreEditors()},this)}})},initTipsy:function(){jQuery("[data-tipsy]").tipsy({title:function(){return this.getAttribute("data-tipsy")},gravity:d.fn.tipsy.autoNS,live:!0})},metaBoxReorder:function(a,b,c,e){if(c.data){var f=c.data,h=f.split("&"),i={};d.each(h,function(a,b){var c=b.split("=");i[c[0]]=c[1]}),"meta-box-order"===i.action&&("restore"===e?g.restoreEditors():"remove"===e&&g.removeEditors())}}};b.exports=j},{"backend/Views/ContextUi/ContextRowGrid":3,"common/Ajax":8,"common/Config":10,"common/Notice":12,"common/TinyMCE":15}],17:[function(a,b,c){var d=function(a){return{stex:{set:function(a,b,c){store.set(a,{val:b,exp:c,time:(new Date).getTime()})},get:function(a){var b=store.get(a);return b?(new Date).getTime()-b.time>b.exp?null:b.val:null}},setIndex:function(a,b,c){return"string"==typeof b?this.setIndex(a,b.split("."),c):1==b.length&&void 0!==c?a[b[0]]=c:0==b.length?a:this.setIndex(a[b[0]],b.slice(1),c)},getIndex:function(a,b){b=b.replace(/\[(\w+)\]/g,".$1"),b=b.replace(/^\./,"");for(var c=b.split(".");c.length;){var d=c.shift();if(!(_.isObject(a)&&d in a))return{};a=a[d]}return a},sleep:function(a){for(var b=(new Date).getTime(),c=0;1e7>c&&!((new Date).getTime()-b>a);c++);}}}(jQuery);b.exports=d},{}],18:[function(a,b,c){var d=a("common/Checks"),e=a("common/Utilities"),f=a("common/Payload");b.exports=Backbone.Model.extend({idAttribute:"uid",initialize:function(){var a=this.get("fieldId");a&&(this.ModuleModel=KB.ObjectProxy.get(a))&&this.getType()&&(this.set("ModuleModel",this.ModuleModel),this.setData(),this.bindHandlers(),this.setupType())},bindHandlers:function(){this.listenToOnce(this.ModuleModel,"remove",this.remove),this.listenTo(this.ModuleModel,"change:moduleData",this.setData),this.listenTo(this,"change:value",this.upstreamData),this.listenTo(this.ModuleModel,"modal.serialize.before",this.unbind),this.listenTo(this.ModuleModel,"modal.serialize",this.rebind),this.listenTo(this.ModuleModel,"change:area",this.unbind),this.listenTo(this.ModuleModel,"after.change.area",this.rebind)},setupType:function(){(obj=this.getType())&&(this.FieldView=new obj({el:this.getElement(),model:this}))},getElement:function(){return jQuery('*[data-kbfuid="'+this.get("uid")+'"]')[0]},getType:function(){var a=this.get("type");if(this.ModuleModel){if("panel"===this.ModuleModel.type&&"EditableImage"===a)return!1;if("panel"===this.ModuleModel.type&&"EditableText"===a)return!1}if(!d.userCan("edit_kontentblocks"))return!1;var b=KB.Fields.get(a);return b&&b.prototype.hasOwnProperty("initialize")?b:!1},setData:function(a){var b,c,d,g,h,i={};b=a||this.get("ModuleModel"),c=f.getPayload("fieldData"),c[this.get("type")]&&(d=c[this.get("type")],d[this.get("fieldId")]&&(g=d[this.get("fieldId")],i=e.getIndex(g,this.get("kpath")))),h=e.getIndex(b.get("moduleData"),this.get("kpath")),this.set("value",_.extend(h,i))},upstreamData:function(){if(this.get("ModuleModel")){var a=_.clone(this.get("ModuleModel").get("moduleData"));e.setIndex(a,this.get("kpath"),this.get("value")),this.get("ModuleModel").set("moduleData",a,{silent:!0}),this.get("ModuleModel").View.getDirty()}},remove:function(){this.stopListening(),KB.FieldConfigs.remove(this)},rebind:function(){this.FieldView&&(this.FieldView.setElement(this.getElement()),this.FieldView.rerender())},unbind:function(){this.FieldView&&this.FieldView.derender&&this.FieldView.derender()}})},{"common/Checks":9,"common/Payload":13,"common/Utilities":17}],19:[function(a,b,c){var d=a("./FieldConfigModel");b.exports=Backbone.Collection.extend({initialize:function(){this._byModule={},this.listenTo(this,"add",this.addToModules)},model:d,addToModules:function(a){if(a.ModuleModel){var b=a.ModuleModel.id;this._byModule[b]||(this._byModule[b]={}),this._byModule[b][a.id]=a}},getFieldsforModule:function(a){return this._byModule[a]?this._byModule[a]:{}}})},{"./FieldConfigModel":18}],20:[function(a,b,c){var d=a("fields/FieldConfigModel");b.exports=Backbone.Collection.extend({model:d})},{"fields/FieldConfigModel":18}],21:[function(a,b,c){var d=window.KB||{};d.Events={},_.extend(d,Backbone.Events),_.extend(d.Events,Backbone.Events),d.currentModule={},d.currentArea={};var e=a("shared/ViewsCollection"),f=a("frontend/Views/EditModalModules"),g=a("frontend/Views/Sidebar"),h=a("fields/FieldsConfigsCollection"),i=a("common/Payload"),j=a("frontend/Models/ModuleModel"),k=a("frontend/Models/AreaModel"),l=a("common/UI"),m=a("common/Logger"),n=a("frontend/Views/ChangeObserver");d.Views={Modules:new e,Areas:new e,Context:new e},d.Modules=new Backbone.Collection([],{model:j}),d.Areas=new Backbone.Collection([],{model:k}),d.ObjectProxy=new Backbone.Collection,d.App=function(){function b(){d.appData.config.initFrontend&&(d.appData.config.useModuleNav&&(d.Sidebar=new g),d.EditModalModules=new f({}),d.ChangeObserver=new n,d.Modules.on("add",j),d.Areas.on("add",k),d.Modules.on("remove",m),e(),a("./InlineSetup"),d.FieldConfigs=new h,d.FieldConfigs.add(_.toArray(i.getPayload("Fields"))),l.init())}function c(){_.each(d.Modules.toArray(),function(a){d.Modules.remove(a)}),jQuery(".editable").each(function(a,b){tinymce.remove("#"+b.id)})}function e(){return d.appData.config.preview?!1:(_.each(i.getPayload("Areas"),function(a){d.ObjectProxy.add(d.Areas.add(a))}),_.each(i.getPayload("Modules"),function(a){d.ObjectProxy.add(d.Modules.add(a))}),d.trigger("kb:moduleControlsAdded"),void d.Events.trigger("KB.frontend.init"))}function j(b){var c;d.ObjectProxy.add(b);var e=a("./Views/ModuleView");c=d.Views.Modules.add(b.get("mid"),new e({model:b,el:"#"+b.get("mid")})),l.initTabs()}function k(b){var c=a("./Views/AreaView");d.Views.Areas.add(b.get("id"),new c({model:b,el:"#"+b.get("id")}))}function m(a){a.dispose(),d.Views.Modules.remove(a.get("mid"))}return{init:b,shutdown:c}}(jQuery),d.App.init(),jQuery(document).ready(function(){d.appData&&d.appData.config.frontend&&(d.Views.Modules.readyOnFront(),m.User.info("Frontend welcomes you"),jQuery("body").addClass("kontentblocks-ready")),d.Events.trigger("KB::ready"),jQuery(window).on("scroll resize",function(){d.Events.trigger("window.change")}),setUserSetting("editor","tinymce"),jQuery("body").on("click",".kb-fx-button",function(a){jQuery(this).addClass("kb-fx-button--click"),jQuery(a.currentTarget).one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){a.currentTarget.classList.remove("kb-fx-button--click")})})})},{"./InlineSetup":28,"./Views/AreaView":33,"./Views/ModuleView":43,"common/Logger":11,"common/Payload":13,"common/UI":16,"fields/FieldsConfigsCollection":19,"frontend/Models/AreaModel":29,"frontend/Models/ModuleModel":30,"frontend/Views/ChangeObserver":34,"frontend/Views/EditModalModules":35,"frontend/Views/Sidebar":44,"shared/ViewsCollection":61}],22:[function(a,b,c){var d=a("common/Config"),e=a("common/Utilities"),f=a("frontend/Inline/controls/EditImage"),g=Backbone.View.extend({initialize:function(){this.mode=this.model.get("mode"),this.defaultState=this.model.get("state")||"replace-image",this.parentView=this.model.get("ModuleModel").View,this.render()},events:{mouseenter:"showControl"},render:function(){this.delegateEvents(),this.$el.addClass("kb-inline-imageedit-attached"),this.$caption=jQuery("*[data-"+this.model.get("uid")+"-caption]"),this.renderControl()},rerender:function(){this.render()},derender:function(){this.EditControl.remove(),this.frame&&(this.frame.dispose(),this.frame=null)},renderControl:function(){this.EditControl=new f({model:this.model,parent:this})},showControl:function(){this.EditControl.show()},hideControl:function(a){this.EditControl.hide()},openFrame:function(){var a=this;if(this.frame)return this.frame.open();var b={post__in:[this.model.get("value").id]};wp.media.query(b).more().done(function(){var b=a.attachment=this.first();a.attachment.set("attachment_id",b.get("id")),a.frame=wp.media({frame:"select",state:"library",metadata:b.toJSON(),imageEditView:a}).on("update",function(b){a.update(b)}).on("ready",function(){a.ready()}).on("replace",function(){a.replace(a.frame.image.attachment)}).on("select",function(){var b=this.get("library").get("selection").first();a.replace(b)}).open()})},ready:function(){jQuery(".media-modal").addClass("smaller no-sidebar")},replace:function(a){this.attachment=a,this.handleAttachment(a)},update:function(a){this.attachment.set(a),this.attachment.sync("update",this.attachment),this.$caption.length>0&&this.$caption.html(this.attachment.get("caption"))},handleAttachment:function(a){var b=this,c=a.get("id"),f=this.prepareValue(a),g=_.clone(this.model.get("ModuleModel").get("moduleData")),h=this.model.get("kpath");e.setIndex(g,h,f),this.model.get("ModuleModel").set("moduleData",g),KB.Events.trigger("modal.refresh");var i={width:b.model.get("width"),height:b.model.get("height"),crop:b.model.get("crop"),upscale:b.model.get("upscale")};jQuery.ajax({url:ajaxurl,data:{action:"fieldGetImage",args:i,id:c,_ajax_nonce:d.getNonce("read")},type:"POST",dataType:"json",success:function(a){"simple"===b.mode?b.$el.attr("src",a.data.src):"background"===b.mode&&b.$el.css("backgroundImage","url('"+a.data.src+"')"),b.delegateEvents()},error:function(){}})},prepareValue:function(a){return{id:a.get("id"),title:a.get("title"),caption:a.get("caption")}}});KB.Fields.registerObject("EditableImage",g),b.exports=g},{"common/Config":10,"common/Utilities":17,"frontend/Inline/controls/EditImage":25}],23:[function(a,b,c){var d=(a("common/Config"),a("common/Utilities"),a("frontend/Inline/controls/EditLink")),e=Backbone.View.extend({initialize:function(){this.parentView=this.model.get("ModuleModel").View,this.setupDefaults(),this.render()},events:{mouseenter:"showControl"},render:function(){this.delegateEvents(),this.$el.addClass("kb-inline-imageedit-attached"),this.$caption=jQuery("*[data-"+this.model.get("uid")+"-caption]"),this.renderControl()},rerender:function(){this.render()},derender:function(){this.EditControl.remove(),this.frame&&(this.frame.dispose(),this.frame=null)},renderControl:function(){this.EditControl=new d({model:this.model,parent:this})},showControl:function(){this.EditControl.show()},hideControl:function(a){this.EditControl.hide()},openDialog:function(){var a=this;window.wpActiveEditor="ghosteditor",jQuery("#wp-link-wrap").addClass("kb-customized"),window.kb_restore_htmlUpdate=wpLink.htmlUpdate,window.kb_restore_isMce=wpLink.isMCE,wpLink.isMCE=function(){return!1},wpLink.htmlUpdate=function(){a.htmlUpdate.call(a)},wpLink.open(),jQuery("#wp-link-text").val(this.model.get("value").linktext),jQuery("#wp-link-url").val(this.model.get("value").link)},htmlUpdate:function(){var a,b,c,d=wpLink.textarea;if(d&&(a=wpLink.getAttrs(),c=jQuery("#wp-link-text").val(),a.href&&"http://"!=a.href)){b=a.href,this.$el.attr("href",b),this.$el.text(c);var e={link:b,linktext:c};this.model.set("value",e),wpLink.close(),this.close()}},close:function(){wpLink.isMCE=window.kb_restore_isMce,wpLink.htmlUpdate=window.kb_restore_htmlUpdate,this.EditControl.show()},setupDefaults:function(){var a=this.model.get("value");a&&""!==a||(a={});var b=_.defaults(a,{link:"",linktext:""});this.model.set("value",b)}});KB.Fields.registerObject("EditableLink",e),b.exports=e},{"common/Config":10,"common/Utilities":17,"frontend/Inline/controls/EditLink":26}],24:[function(a,b,c){var d=a("common/Utilities"),e=a("common/Config"),f=a("frontend/Inline/controls/EditText"),g=Backbone.View.extend({initialize:function(){this.placeHolderSet=!1,this.placeholder="<span class='kb-editable-text-placeholder'>Start typing here</span>",this.settings=this.model.get("tinymce"),this.parentView=this.model.get("ModuleModel").View,this.setupDefaults(),this.maybeSetPlaceholder(),this.listenToOnce(this.model.get("ModuleModel"),"remove",this.deactivate),this.render(),this.$("a").on("click",function(a){a.preventDefault()})},render:function(){this.el.id&&(this.id=this.el.id),this.renderControl()},derender:function(){this.EditControl.remove(),this.deactivate()},rerender:function(){this.render()},renderControl:function(){this.EditControl=new f({model:this.model,parent:this})},events:{mouseenter:"showControl"},showControl:function(){this.EditControl.show()},setupDefaults:function(){var a=this,b={theme:"modern",skin:!1,menubar:!1,add_unload_trigger:!1,fixed_toolbar_container:null,schema:"html5",inline:!0,plugins:"textcolor, wptextpattern",statusbar:!1,preview_styles:!1,setup:function(b){b.on("init",function(){a.editor=b,b.module=a.model.get("ModuleModel"),b.kfilter=a.model.get("filter")&&"content"===a.model.get("filter")?!0:!1,KB.Events.trigger("KB::tinymce.new-inline-editor",b),b.focus(),jQuery(".mce-panel.mce-floatpanel").hide(),jQuery(window).on("scroll.kbmce resize.kbmce",function(){jQuery(".mce-panel.mce-floatpanel").hide()})}),b.on("selectionchange mouseup",function(c){a.getSelection(b,c)}),b.on("NodeChange",function(a){KB.Events.trigger("window.change")}),b.on("focus",function(){var c;window.wpActiveEditor=a.el.id,c=d.getIndex(b.module.get("moduleData"),a.model.get("kpath")),b.kfilter&&b.setContent(switchEditors.wpautop(c)),b.previousContent=b.getContent(),a.$el.addClass("kb-inline-text--active"),a.placeHolderSet&&b.setContent("")}),b.on("blur",function(c){var f,g,h;a.$el.removeClass("kb-inline-text--active"),f=b.getContent(),b.kfilter&&(f=switchEditors._wp_Nop(b.getContent())),g=_.clone(b.module.get("moduleData")),h=a.model.get("kpath"),d.setIndex(g,h,f),b.isDirty()?(b.placeholder=!1,b.kfilter?jQuery.ajax({url:ajaxurl,data:{action:"applyContentFilter",content:f,postId:b.module.toJSON().parentObjectId,_ajax_nonce:e.getNonce("read")},type:"POST",dataType:"json",success:function(a){b.setContent(a.data.content),b.module.set("moduleData",g)},error:function(){}}):b.module.set("moduleData",g)):b.setContent(b.previousContent),setTimeout(function(){window.twttr&&window.twttr.widgets.load(),jQuery(window).off("scroll.kbmce resize.kbmce"),a.deactivate(),a.maybeSetPlaceholder()},500)})}};this.defaults=_.extend(b,this.settings)},activate:function(a){a.stopPropagation(),this.editor||tinymce.init(_.defaults(this.defaults,{selector:"#"+this.id}))},deactivate:function(){this.editor&&this.editor.destroy(),this.editor=null},maybeSetPlaceholder:function(){var a=this.editor?this.editor.getContent():this.$el.html(),b=this.cleanString(a);_.isEmpty(b)&&(this.$el.html(this.placeholder),this.placeHolderSet=!0)},cleanString:function(a){return a.replace(/\s/g,"").replace(/&nbsp;/g,"").replace(/<br>/g,"").replace(/<p><\/p>/g,"")},getSelection:function(a,b){var c=a.selection.getContent(),d=jQuery(".mce-panel.mce-floatpanel");if(""===c)d.hide();else{var e=h(),f=d.width();d.css({top:e.top-40+"px",left:e.left-f+"px"}),d.show()}}}),h=function(){var a,b="\ufeff",c="&#xfeff;",d="sel_"+(new Date).getTime()+"_"+Math.random().toString().substr(2);return function(){var e,f;if(document.selection&&document.selection.createRange)f=document.selection.createRange().duplicate(),f.collapse(!1),f.pasteHTML('<span id="'+d+'" style="position: relative;">'+c+"</span>"),a=document.getElementById(d);else if(window.getSelection){e=window.getSelection(),e.getRangeAt?f=e.getRangeAt(0).cloneRange():(f.setStart(e.anchorNode,e.anchorOffset),f.setEnd(e.focusNode,e.focusOffset),f.collapsed!==e.isCollapsed&&(f.setStart(e.focusNode,e.focusOffset),f.setEnd(e.anchorNode,e.anchorOffset))),f.collapse(!1),a=document.createElement("span"),a.id=d;var g=jQuery(a);g.prepend(document.createTextNode(b)),f.insertNode(a)}if(a){var h=a,i=0,j=0;do i+=h.offsetLeft,j+=h.offsetTop;while(h=h.offsetParent);return a.parentNode.removeChild(a),g.remove(),{left:i,top:j}}}}();b.exports=g},{"common/Config":10,"common/Utilities":17,"frontend/Inline/controls/EditText":27}],25:[function(a,b,c){var d=a("common/Checks");b.exports=Backbone.View.extend({initialize:function(a){this.visible=!1,this.options=a||{},this.Parent=a.parent,this.$el.append('<span class="dashicons dashicons-format-image"></span>'),this.isValid()&&this.render(),this.listenTo(KB.Events,"window.change",this.reposition)},className:"kb-inline-control",events:{click:"openFrame"},openFrame:function(){this.Parent.openFrame()},render:function(){this.Parent.parentView.$el.append(this.$el),this.$el.hide()},show:function(){this.$el.show(),this.setPosition(),this.visible=!0},hide:function(){this.$el.hide(),this.visible=!1},reposition:function(){this.visible&&this.setPosition()},setPosition:function(){
var a=this.Parent.$el.offset(),b=this.Parent.$el.width();a.left=a.left+b-40,a.top=a.top+20,this.$el.offset(a)},isValid:function(){return d.userCan("edit_kontentblocks")}})},{"common/Checks":9}],26:[function(a,b,c){var d=a("common/Checks");b.exports=Backbone.View.extend({initialize:function(a){this.visible=!1,this.options=a||{},this.Parent=a.parent,this.$el.append('<span class="dashicons dashicons-admin-links"></span>'),this.isValid()&&this.render(),this.listenTo(KB.Events,"window.change",this.reposition)},className:"kb-inline-control",events:{click:"openDialog",mouseenter:"mouseenter",mouseleave:"mouseleave"},openDialog:function(){this.Parent.openDialog()},render:function(){this.Parent.parentView.$el.append(this.$el),this.$el.hide()},show:function(){this.$el.show(),this.setPosition(),this.visible=!0},hide:function(){this.$el.hide(),this.visible=!1},reposition:function(){this.visible&&this.setPosition()},setPosition:function(){var a=this.Parent.$el.offset(),b=this.Parent.$el.innerWidth();a.left=a.left+b,a.top=a.top+20,this.$el.offset(a)},isValid:function(){return d.userCan("edit_kontentblocks")},mouseenter:function(){this.Parent.$el.addClass("editable-element-active")},mouseleave:function(){this.Parent.$el.removeClass("editable-element-active")}})},{"common/Checks":9}],27:[function(a,b,c){var d=a("common/Checks");b.exports=Backbone.View.extend({initialize:function(a){this.visible=!1,this.options=a||{},this.Parent=a.parent,this.$el.append('<span class="dashicons dashicons-edit"></span>'),this.isValid()&&this.render(),this.listenTo(KB.Events,"window.change",this.reposition)},className:"kb-inline-control",events:{click:"focusEditor",mouseenter:"mouseenter",mouseleave:"mouseleave"},focusEditor:function(a){this.Parent.activate(a)},render:function(){this.Parent.parentView.$el.append(this.$el),this.$el.hide()},show:function(){this.$el.show(),this.setPosition(),this.visible=!0},hide:function(){this.$el.hide(),this.visible=!1},reposition:function(){this.visible&&this.setPosition()},setPosition:function(){var a=this.Parent.$el.offset(),b=this.Parent.$el.width(),c=this.Parent.$el.height();a.left=a.left+b-40,a.top=a.top+3,c>30&&(a.top=a.top+20),this.$el.offset(a)},isValid:function(){return d.userCan("edit_kontentblocks")},mouseenter:function(){}})},{"common/Checks":9}],28:[function(a,b,c){var d=a("frontend/Inline/EditableTextView"),e=a("frontend/Inline/EditableLinkView"),f=a("frontend/Inline/EditableImageView");KB.Fields.registerObject("EditableText",d),KB.Fields.registerObject("EditableImage",f),KB.Fields.registerObject("EditableLink",e)},{"frontend/Inline/EditableImageView":22,"frontend/Inline/EditableLinkView":23,"frontend/Inline/EditableTextView":24}],29:[function(a,b,c){b.exports=Backbone.Model.extend({defaults:{id:"generic"},idAttribute:"id"})},{}],30:[function(a,b,c){var d=a("common/Config"),e=(a("common/Notice"),a("common/Logger"));b.exports=Backbone.Model.extend({idAttribute:"mid",initialize:function(){this.subscribeToArea()},subscribeToArea:function(a){a||(a=KB.Areas.get(this.get("area"))),a.View.attachModuleView(this),this.Area=a},dispose:function(){this.stopListening()},sync:function(a,b){var c=this;return jQuery.ajax({url:ajaxurl,data:{action:"updateModule",data:c.toJSON().moduleData,module:c.toJSON(),editmode:a?"update":"preview",_ajax_nonce:d.getNonce("update")},context:b?b:c,type:"POST",dataType:"json",success:function(a){c.set("moduleData",a.data.newModuleData),c.trigger("module.model.updated",c)},error:function(){e.Debug.error("serialize | FrontendModal | Ajax error")}})}})},{"common/Config":10,"common/Logger":11,"common/Notice":12}],31:[function(a,b,c){var d=a("shared/ModuleBrowser/ModuleBrowserController"),e=a("frontend/Models/ModuleModel"),f=a("common/TinyMCE");b.exports=d.extend({success:function(a){var b;this.dropZone?(this.dropZone.$el.after(a.data.html),this.dropZone.removeDropZone()):this.options.area.$el.append(a.data.html).removeClass("kb-area__empty"),b=KB.Modules.add(new e(a.data.module)),this.parseAdditionalJSON(a.data.json),f.addEditor(b.View.$el),KB.Fields.trigger("newModule",KB.Views.Modules.lastViewAdded),this.options.area.trigger("kb.module.created"),setTimeout(function(){b.View.openOptions()},300)},close:function(){delete this.dropZone,d.prototype.close.apply(this,arguments)}})},{"common/TinyMCE":15,"frontend/Models/ModuleModel":30,"shared/ModuleBrowser/ModuleBrowserController":54}],32:[function(a,b,c){var d=a("common/Payload");b.exports=Backbone.View.extend({hasLayout:!1,initialize:function(a){this.AreaView=a.AreaView,this.listenTo(this.AreaView,"kb.module.created",this.handleModuleCreated),this.listenTo(this.AreaView,"kb.module.deleted",this.handleModuleDeleted),this.listenTo(this.model,"change:layout",this.handleLayoutChange),this.setupLayout(),this.renderPlaceholder()},setupLayout:function(a){var b,c;return c=d.getPayload("AreaTemplates")||{},b=a||this.model.get("layout"),"default"===b?(this.hasLayout=!1,null):void(c[b]?(this.hasLayout=!0,this.LayoutIterator=new KB.LayoutIterator(c[b],this.AreaView)):this.hasLayout=!1)},unwrap:function(){_.each(this.AreaView.getAttachedModules(),function(a){a.View.$el.unwrap()});var a=jQuery(".kb-outer-wrap",this.AreaView.$el);a.each(function(a){jQuery(".kb-wrap:first-child",a).unwrap()})},render:function(a){this.hasLayout?this.LayoutIterator.applyLayout(a):this.unwrap()},applyClasses:function(){var a,b,c=this.AreaView.$el.find(".module");c.removeClass("first-module last-module repeater");for(var d=0;d<c.length;d++){var e=jQuery(c[d]).data("ModuleView");_.isUndefined(e)||(0===d&&e.$el.addClass("first-module"),d===c.length-1&&e.$el.addClass("last-module"),b&&e.model.get("settings").id===b&&e.$el.addClass("repeater"),b=e.model.get("settings").id,a=e.$el.parent(),a.hasClass("kb-wrap")&&a.attr("rel",e.$el.attr("rel")))}},handleModuleCreated:function(){this.applyClasses(),this.LayoutIterator&&this.LayoutIterator.applyLayout(null)},handleModuleDeleted:function(){this.applyClasses(),this.renderPlaceholder(),this.LayoutIterator&&this.LayoutIterator.applyLayout(null)},handleLayoutChange:function(){this.setupLayout(),this.AreaView.setupSortables(),this.render(null)},renderPlaceholder:function(){0===this.AreaView.getNumberOfModules()&&this.AreaView.$el.addClass("kb-area__empty")}})},{"common/Payload":13}],33:[function(a,b,c){var d=a("frontend/Views/AreaLayout"),e=a("frontend/ModuleBrowser/ModuleBrowserExt"),f=a("common/Config"),g=a("common/Notice"),h=a("common/Ajax");b.exports=Backbone.View.extend({isSorting:!1,events:{},initialize:function(){this.attachedModuleViews={},this.renderSettings=this.model.get("renderSettings"),this.listenToOnce(KB.Events,"KB.frontend.init",this.setupUi),this.listenTo(this,"kb.module.deleted",this.removeModule),this.model.View=this},setupUi:function(){this.Layout=new d({model:new Backbone.Model(this.renderSettings),AreaView:this}),this.model.get("sortable")&&this.setupSortables()},openModuleBrowser:function(){return this.ModuleBrowser||(this.ModuleBrowser=new e({area:this})),this.ModuleBrowser.render(),this.ModuleBrowser},attachModuleView:function(a){this.attachedModuleViews[a.get("mid")]=a,this.listenTo(a,"change:area",this.removeModule),this.getNumberOfModules()>0&&this.$el.removeClass("kb-area__empty"),this.trigger("kb.module.created",a)},getNumberOfModules:function(){return _.size(this.attachedModuleViews)},getAttachedModules:function(){return this.attachedModuleViews},setupSortables:function(){var a=this;this.Layout.hasLayout?this.$el.sortable({handle:".kb-module-inline-move",items:".kb-wrap",helper:"clone",opacity:.5,forcePlaceholderSize:!0,delay:150,placeholder:"kb-front-sortable-placeholder",start:function(b,c){a.isSorting=!0,c.helper.hasClass("ui-draggable-dragging")&&c.helper.addClass("kb-wrap"),c.placeholder.attr("class",c.helper.attr("class")),c.placeholder.addClass("kb-front-sortable-placeholder"),c.placeholder.append("<div class='module kb-dummy'></div>"),jQuery(".module",c.helper).addClass("ignore"),c.helper.addClass("ignore"),a.Layout.applyClasses(),a.Layout.render(c)},receive:function(b,c){var d=c.item.data("module");a.isSorting=!1,d.create(c)},beforeStop:function(b,c){a.Layout.applyClasses(),jQuery(".ignore",c.helper).removeClass("ignore")},stop:function(b,c){var d={};return a.isSorting=!1,d[a.model.get("id")]=a.$el.sortable("serialize",{attribute:"rel"}),h.send({action:"resortModules",data:d,_ajax_nonce:f.getNonce("update")},function(){g.notice("Order was updated successfully","success"),a.Layout.render(c)},a)},change:function(b,c){a.Layout.applyClasses(),a.Layout.render(c)},over:function(b){a.Layout.applyClasses(),a.Layout.render(b)}}):this.$el.sortable({handle:".kb-module-inline-move",items:".module",helper:"clone",cursorAt:{top:5,left:5},delay:150,forceHelperSize:!0,forcePlaceholderSize:!0,placeholder:"kb-front-sortable-placeholder",start:function(){a.isSorting=!0},receive:function(b,c){var d=c.item.data("module");a.isSorting=!1,d.create(c)},stop:function(){a.isSorting&&(a.isSorting=!1,a.resort(a.model))},change:function(){a.Layout.applyClasses()}})},changeLayout:function(a){this.Layout.model.set("layout",a),this.$el.sortable("destroy"),this.setupSortables()},removeModule:function(a){var b=a.model.get("mid");this.attachedModuleViews[b]&&delete this.attachedModuleViews[b],this.getNumberOfModules()<0&&this.$el.addClass("kb-area__empty")},resort:function(a){var b={};return b[a.get("id")]=a.View.$el.sortable("serialize",{attribute:"rel"}),h.send({action:"resortModules",postId:a.get("envVars").postId,data:b,_ajax_nonce:f.getNonce("update")},function(){g.notice("Order was updated successfully","success"),a.trigger("area.resorted")},null)}})},{"common/Ajax":8,"common/Config":10,"common/Notice":12,"frontend/ModuleBrowser/ModuleBrowserExt":31,"frontend/Views/AreaLayout":32}],34:[function(a,b,c){var d=a("common/Notice"),e=a("templates/frontend/change-observer.hbs");b.exports=Backbone.View.extend({models:new Backbone.Collection,className:"kb-change-observer",initialize:function(){this.listenTo(KB.Modules,"add",this.attachHandler),this.render()},events:{"click .kb-button":"saveAll"},render:function(){this.$el.append(e({})),this.$el.appendTo("body")},attachHandler:function(a){this.listenTo(a,"change:moduleData",this.add),this.listenTo(a,"module.model.updated",this.remove)},add:function(a){this.models.add(a),this.handleState()},remove:function(a){this.models.remove(a,{silent:!0}),this.handleState()},getModels:function(){return this.models},saveAll:function(){_.each(this.models.models,function(a){a.sync(!0)})},handleState:function(){var a=this.models.models.length;a>0?this.$el.addClass("show"):(this.$el.removeClass("show"),d.notice("all saved","success"))}})},{"common/Notice":12,"templates/frontend/change-observer.hbs":71}],35:[function(a,b,c){var d=a("common/Logger"),e=a("frontend/Collections/ModalFieldCollection"),f=a("frontend/Views/LoadingAnimation"),g=a("common/Config"),h=a("common/UI"),i=a("common/TinyMCE"),j=a("common/Notice"),k=a("common/Ajax"),l=a("templates/frontend/module-edit-form.hbs");b.exports=Backbone.View.extend({tagName:"div",id:"onsite-modal",timerId:null,initialize:function(){var a=this;return jQuery(l({model:{},i18n:KB.i18n.jsFrontend})).appendTo(this.$el),this.$form=jQuery("#onsite-form",this.$el),this.$formContent=jQuery("#onsite-content",this.$el),this.$inner=jQuery(".os-content-inner",this.$formContent),this.$title=jQuery(".controls-title",this.$el),this.$draft=jQuery(".kb-modal__draft-notice",this.$el),this.LoadingAnimation=new f({el:this.$form}),this.FieldModels=new e,this.listenTo(KB.Events,"modal.recalibrate",this.recalibrate),this.listenTo(KB.Events,"modal.preview",this.preview),jQuery(window).on("resize",function(){a.recalibrate()}),this.listenTo(KB.Events,"KB::tinymce.new-editor",function(b){b.settings&&b.settings.kblive&&a.attachEditorEvents(b)}),jQuery(document).on("change",".kb-observe",function(){a.serialize(!1,!0)}),this},events:{keyup:"delayInput","click a.close-controls":"destroy","click a.kb-save-form":"update","click a.kb-preview-form":"preview","change .kb-template-select":"viewfileChange"},openView:function(a,b){return this.ModuleView&&this.ModuleView.cid===a.cid?this:(this.setupWindow(),this.ModuleView=a,this.model=a.model,this.attach(),this.render(),this.recalibrate(),this)},attach:function(){var a=this;this.listenTo(this.ModuleView,"kb.frontend.module.inline.saved",this.frontendViewUpdated),this.listenTo(KB.Events,"modal.refresh",this.reload),this.listenTo(this.model,"change:viewfile",function(){a.serialize(!1,!0),a.reload()}),this.listenTo(this.model,"data.updated",this.preview),this.listenTo(this.ModuleView.model,"remove",this.destroy)},reload:function(){this.render(!0)},detach:function(){this.FieldModels.reset(),this.stopListening(),delete this.ModuleView,KB.Events.trigger("modal.close",this)},destroy:function(){var a=this;a.detach(),jQuery(".wp-editor-area",this.$el).each(function(a,b){tinymce.remove("#"+b.id)}),a.unbind(),a.initialized=!1,a.$el.detach()},setupWindow:function(){var a=this;KB.Sidebar.visible?(this.$el.appendTo(KB.Sidebar.$el),this.mode="sidebar",this.listenToOnce(KB.Sidebar,"sidebar.close",function(){this.mode="body",this.destroy()}),KB.Sidebar.clearTimer()):(this.mode="body",this.$el.appendTo("body").show()),"body"===this.mode&&this.$el.css("position","fixed").draggable({handle:"h2",containment:"window",stop:function(b,c){a.recalibrate(c.position)}})},frontendViewUpdated:function(){this.$el.removeClass("isDirty"),this.reload()},preview:function(){this.serialize(!1,!1)},update:function(){this.serialize(!0,!0),this.switchDraftOff()},render:function(a){var b,c=this;d.User.info("Frontend modal retrieves data from the server"),b=this.model.toJSON(),this.applyControlsSettings(this.$el),this.updateViewClassTo=!1,jQuery.ajax({url:ajaxurl,data:{action:"getModuleForm",module:b,moduleData:b.moduleData,_ajax_nonce:g.getNonce("read")},type:"POST",dataType:"json",beforeSend:function(){c.LoadingAnimation.show()},success:function(b){c.$inner.empty(),c.ModuleView.clearFields(),c.$inner.attr("id",c.model.get("mid")),c.$inner.append(b.data.html),c.model.get("state").draft?c.$draft.show(150):c.$draft.hide(),b.data.json&&(KB.payload=_.extend(KB.payload,b.data.json),b.data.json.Fields&&c.FieldModels.add(_.toArray(b.data.json.Fields))),h.initTabs(),h.initToggleBoxes(),i.addEditor(c.$form),d.User.info("Frontend modal done."),c.$title.text(c.model.get("settings").name),a&&c.FieldModels.length>0&&KB.Events.trigger("modal.reload"),setTimeout(function(){KB.Fields.trigger("frontUpdate",c.ModuleView)},500),setTimeout(function(){c.$el.show(),c.recalibrate(),c.LoadingAnimation.hide()},550)},error:function(){j.notice("There went something wrong","error")}})},recalibrate:function(){var a,b,c,d;if(a=jQuery(window).height()-16,b=jQuery(".os-content-inner").height(),c=this.$el.position(),d=b+c.top-a,d>0?this.initScrollbars(b-(d+30)):b-c.top<a?this.initScrollbars(b):this.initScrollbars(a-c.top),c.top<32&&this.$el.css("top","32px"),"sidebar"===this.mode){var e=this.model.get("settings"),f=e.controls&&e.controls.width||600;KB.Sidebar.$el.width(f),this.$el.addClass("kb-modal-sidebar")}},initScrollbars:function(a){jQuery(".kb-nano",this.$el).height(a+20),jQuery(".kb-nano").nanoScroller({preventPageScrolling:!0,contentClass:"kb-nano-content"})},serialize:function(a,b){var c,d=this,e=a||!1,f=b!==!1;tinymce.triggerSave(),c=this.formdataForId(this.model.get("mid")),this.model.set("moduleData",c),this.LoadingAnimation.show(.5),this.model.sync(e,this).done(function(a,b,c){d.moduleUpdated(a,b,c,e,f)})},moduleUpdated:function(a,b,c,d,e){var f,g,h=this;f=jQuery(".kb-module-controls",h.ModuleView.$el),f.length>0&&f.detach(),g=h.ModuleView.$el.height(),h.ModuleView.model.trigger("modal.serialize.before"),h.updateViewClassTo!==!1&&h.updateContainerClass(h.updateViewClassTo),h.ModuleView.$el.html(a.data.html),h.ModuleView.model.set("moduleData",a.data.newModuleData),d&&(h.model.trigger("saved"),h.model.trigger("module.model.updated",h.model),KB.Events.trigger("modal.saved")),jQuery(document).trigger("kb:module-update-"+h.model.get("settings").id,h.ModuleView),h.ModuleView.delegateEvents(),h.ModuleView.trigger("kb:frontend::viewUpdated"),KB.Events.trigger("KB::ajax-update"),KB.trigger("kb:frontendModalUpdated"),setTimeout(function(){jQuery(".editable",h.ModuleView.$el).each(function(a,b){KB.IEdit.Text(b)}),h.ModuleView.render(),h.ModuleView.setControlsPosition(),h.ModuleView.model.trigger("modal.serialize")},400),d?(e&&j.notice(KB.i18n.jsFrontend.frontendModal.noticeDataSaved,"success"),h.$el.removeClass("isDirty"),h.ModuleView.getClean(),h.trigger("kb:frontend-save")):(e&&j.notice(KB.i18n.jsFrontend.frontendModal.noticePreviewUpdated,"success"),h.$el.addClass("isDirty")),f.length>0&&h.ModuleView.$el.append(f),h.ModuleView.trigger("kb.view.module.HTMLChanged"),h.LoadingAnimation.hide()},viewfileChange:function(a){this.updateViewClassTo={current:this.ModuleView.model.get("viewfile"),target:a.currentTarget.value},this.model.set("viewfile",a.currentTarget.value)},updateContainerClass:function(a){a&&a.current&&a.target||_K.error("updateContainerClass | frontendModal | parameter exception"),this.ModuleView.$el.removeClass(this._classifyView(a.current)),this.ModuleView.$el.addClass(this._classifyView(a.target)),this.updateViewClassTo=!1},delayInput:function(){var a=this;this.timerId&&clearTimeout(this.timerId),this.timerId=setTimeout(function(){a.timerId=null,a.serialize(!1,!1)},750)},attachEditorEvents:function(a){var b=this;a.onKeyUp.add(function(){b.delayInput()})},applyControlsSettings:function(a){var b=this.model.get("settings"),c=b.controls&&b.controls.width;c&&a.css("width",b.controls.width+"px"),"sidebar"===this.mode&&c&&KB.Sidebar.$el.width(c),b.controls&&b.controls.fullscreen?a.width("100%").height("100%").addClass("fullscreen"):a.height("").removeClass("fullscreen")},_classifyView:function(a){return"view-"+a.replace(".twig","")},switchDraftOff:function(){var a=this.model.toJSON(),b=this;this.model.get("state").draft&&k.send({action:"undraftModule",mid:a.mid,postId:this.model.get("parentObjectId"),_ajax_nonce:g.getNonce("update")},function(a){a.success&&b.$draft.hide(150)},this)},formdataForId:function(a){var b;return a?(b=this.$form.serializeJSON(),b[a]?b[a]:null):null}})},{"common/Ajax":8,"common/Config":10,"common/Logger":11,"common/Notice":12,"common/TinyMCE":15,"common/UI":16,"frontend/Collections/ModalFieldCollection":20,"frontend/Views/LoadingAnimation":36,"templates/frontend/module-edit-form.hbs":73}],36:[function(a,b,c){b.exports=Backbone.View.extend({$overlay:jQuery('<div class="kb-loading-overlay" style="display: none;"><span class="kb-loading-loader"><span class="kb-loading-loader-inner"></span></span></div>'),initialize:function(){this.$el.css("position","relative").append(this.$overlay)},show:function(a){a?this.$overlay.fadeTo(150,a):this.$overlay.show()},hide:function(){this.$overlay.fadeOut(350)}})},{}],37:[function(a,b,c){var d=a("./modulecontrols/EditControl"),e=a("./modulecontrols/UpdateControl"),f=a("./modulecontrols/DeleteControl"),g=a("./modulecontrols/MoveControl"),h=a("templates/frontend/module-controls.hbs");b.exports=Backbone.View.extend({ModuleView:null,$menuList:null,initialize:function(a){this.ModuleView=a.ModuleView,this.renderControls(),this.EditControl=this.addItem(new d({model:this.ModuleView.model,parent:this.ModuleView})),this.UpdateControl=this.addItem(new e({model:this.ModuleView.model,parent:this.ModuleView})),this.DeleteControl=this.addItem(new f({model:this.ModuleView.model,parent:this.ModuleView})),this.MoveControl=this.addItem(new g({model:this.ModuleView.model,parent:this.ModuleView}))},renderControls:function(){this.ModuleView.$el.append(h({model:this.ModuleView.model.toJSON(),i18n:KB.i18n.jsFrontend})),this.$el=jQuery(".kb-module-controls",this.ModuleView.$el),this.$menuList=jQuery('<div class="controls-wrap"></div>').appendTo(this.$el)},addItem:function(a){if(a.isValid&&a.isValid()===!0){var b=jQuery('<div class="controls-wrap-item"></div>').appendTo(this.$menuList),c=b.append(a.render());return this.$menuList.append(c),a}}})},{"./modulecontrols/DeleteControl":39,"./modulecontrols/EditControl":40,"./modulecontrols/MoveControl":41,"./modulecontrols/UpdateControl":42,"templates/frontend/module-controls.hbs":72}],38:[function(a,b,c){b.exports=Backbone.View.extend({tagName:"a",isValid:function(){return!0},render:function(){return this.el}})},{}],39:[function(a,b,c){var d=a("frontend/Views/ModuleControls/modulecontrols/ControlsBaseView"),e=a("common/Checks"),f=a("common/Config"),g=a("common/Notice"),h=a("common/Ajax");b.exports=d.extend({initialize:function(a){this.options=a||{},this.Parent=a.parent,this.$el.append('<span class="dashicons dashicons-trash"></span><span class="os-action">'+KB.i18n.jsFrontend.moduleControls.controlsDelete+"</span>")},className:"kb-module-inline-delete kb-nbt kb-nbb kb-js-inline-delete",events:{click:"confirmRemoval"},confirmRemoval:function(){g.confirm("Remove",KB.i18n.EditScreen.notices.confirmDeleteMsg,this.removeModule,this.cancelRemoval,this)},removeModule:function(){var a=this;h.send({action:"removeModules",_ajax_nonce:f.getNonce("delete"),module:a.model.get("mid"),postId:a.model.get("post_id")},this.afterRemoval,this)},afterRemoval:function(){this.Parent.$el.parent(".kb-wrap").remove(),this.trigger("remove"),KB.Modules.remove(this.model)},cancelRemoval:function(){return!1},isValid:function(){return e.userCan("delete_kontentblocks")}})},{"common/Ajax":8,"common/Checks":9,"common/Config":10,"common/Notice":12,"frontend/Views/ModuleControls/modulecontrols/ControlsBaseView":38}],40:[function(a,b,c){var d=a("frontend/Views/ModuleControls/modulecontrols/ControlsBaseView"),e=a("common/Checks");b.exports=d.extend({initialize:function(a){this.options=a||{},this.Parent=a.parent,this.$el.append('<span class="dashicons dashicons-edit"></span>')},className:"os-edit-block kb-module-edit",events:{click:"openForm"},openForm:function(){return KB.EditModalModules.openView(this.Parent),KB.focusedModule=this.model,this},isValid:function(){return e.userCan("edit_kontentblocks")},success:function(){}})},{"common/Checks":9,"frontend/Views/ModuleControls/modulecontrols/ControlsBaseView":38}],41:[function(a,b,c){var d=a("frontend/Views/ModuleControls/modulecontrols/ControlsBaseView"),e=a("common/Checks");b.exports=d.extend({initialize:function(a){this.options=a||{},this.Parent=a.parent,this.$el.append('<span class="genericon genericon-draggable"></span><span class="os-action"></span>')},className:"kb-module-inline-move kb-nbt kb-nbb",isValid:function(){return this.Parent.model.Area?e.userCan("edit_kontentblocks")&&this.Parent.model.Area.get("sortable"):!1}})},{"common/Checks":9,"frontend/Views/ModuleControls/modulecontrols/ControlsBaseView":38}],42:[function(a,b,c){var d=a("frontend/Views/ModuleControls/modulecontrols/ControlsBaseView"),e=a("common/Checks"),f=a("common/Config"),g=a("common/Notice");b.exports=d.extend({initialize:function(a){this.options=a||{},this.Parent=a.parent,this.$el.append('<span class="dashicons dashicons-update"></span>')},className:"kb-module-inline-update kb-nbt kb-nbb kb-js-inline-update",events:{click:"update"},update:function(){var a=this,b=!1;jQuery.ajax({url:ajaxurl,data:{action:"updateModule",data:a.model.get("moduleData"),module:a.model.toJSON(),editmode:"update",refresh:b,_ajax_nonce:f.getNonce("update")},type:"POST",dataType:"json",success:function(c){b&&a.$el.html(c.html),tinymce.triggerSave(),a.model.set("moduleData",c.data.newModuleData),a.Parent.render(),a.Parent.trigger("kb.frontend.module.inline.saved"),a.model.trigger("saved"),a.model.trigger("module.model.updated",a.model),KB.Events.trigger("KB::ajax-update"),g.notice("Module saved successfully","success"),a.Parent.$el.removeClass("isDirty")},error:function(){g.notice("There went something wrong","error")}})},isValid:function(){return e.userCan("edit_kontentblocks")}})},{"common/Checks":9,"common/Config":10,"common/Notice":12,"frontend/Views/ModuleControls/modulecontrols/ControlsBaseView":38}],43:[function(a,b,c){var d=a("frontend/Views/ModuleControls/ModuleControls"),e=a("common/Checks"),f=a("templates/frontend/module-placeholder.hbs");b.exports=Backbone.View.extend({focus:!1,$dropZone:jQuery('<div class="kb-module__dropzone"><span class="dashicons dashicons-plus"></span> add </div>'),attachedFields:{},initialize:function(){e.userCan("edit_kontentblocks")&&(this.model.View=this,this.model.trigger("module.model.view.attached",this),this.listenTo(this.model,"change",this.getDirty),this.listenTo(this.model,"module.model.updated",this.getClean),this.$el.data("ModuleView",this),this.render(),this.setControlsPosition(),this.Controls=new d({ModuleView:this}))},events:{"click .kb-module__placeholder":"openOptions","click .kb-module__dropzone":"setDropZone","click .kb-js-inline-delete":"confirmDelete","click .editable":"reloadModal","mouseenter.first":"setActive","mouseenter.second":"setControlsPosition"},openOptions:function(){this.Controls.EditControl.openForm()},setActive:function(){KB.currentModule=this},render:function(){var a;this.$el.hasClass("draft")&&""===this.model.get("moduleData")&&this.renderPlaceholder(),this.$el.attr("rel",this.model.get("mid")+"_"+_.uniqueId()),a=this.model.get("settings"),a.controls&&a.controls.hide||jQuery(".os-controls",this.$el).length>0},setControlsPosition:function(){var a,b,c,d,e,f;a=0,b=0,c=this.model.get("settings"),d=jQuery(".os-controls",this.$el),e=this.$el.offset(),f=this.$el.height(),c.controls&&c.controls.toolbar&&(e.top=c.controls.toolbar.top,e.left=c.controls.toolbar.left),"hidden"!==this.$el.css("overflow")&&e.top>60&&119>f&&(a=-25),"hidden"!==this.$el.css("overflow")&&e.left>100&&f>120&&this.$el["class"]&&(a=0,b=-30,d.addClass("kb-module-nav__vertical")),e.top<20&&(a=10),d.css({top:a+"px",left:b})},reloadModal:function(a){return KB.EditModalModules&&KB.EditModalModules.reload(this,a),KB.CurrentModel=this.model,KB.focusedModule=this.model,this},insertDropZone:function(){this.focus=!0,this.$el.append(this.$dropZone)},removeDropZone:function(){this.focus=!1,this.$el.find(".kb-module__dropzone").remove()},setDropZone:function(){var a;a=this.Area.openModuleBrowser(),a.dropZone=this},renderPlaceholder:function(){this.$el.append(f({model:this.model.toJSON()}))},addField:function(a){this.attachedFields[a.cid]=a},hasField:function(a,b){return _.isEmpty(b)?a in this.attachedFields:(this.attachedFields[b]||(this.attachedFields[b]={}),a in this.attachedFields[b])},getField:function(a,b){return _.isEmpty(b)?this.attachedFields[a]:this.attachedFields[b][a]},clearFields:function(){this.attachedFields={}},getDirty:function(){this.$el.addClass("isDirty")},getClean:function(){this.$el.removeClass("isDirty")},modelChange:function(){this.getDirty()},save:function(){},dispose:function(){delete this.model.View,this.stopListening(),this.remove()}})},{"common/Checks":9,"frontend/Views/ModuleControls/ModuleControls":37,"templates/frontend/module-placeholder.hbs":74}],44:[function(a,b,c){var d=a("frontend/Views/Sidebar/AreaOverview/AreaOverviewController"),e=a("frontend/Views/Sidebar/AreaDetails/CategoryFilter"),f=a("frontend/Views/Sidebar/SidebarHeader"),g=a("common/Utilities"),h=a("templates/frontend/sidebar/sidebar-nav.hbs");b.exports=Backbone.View.extend({currentView:null,viewStack:[],timer:0,initialize:function(){this.render(),this.states={};var a=h({});this.$navControls=jQuery(a),this.bindHandlers(),this.states.AreaList=new d({controller:this}),this.CategoryFilter=new e,this.setView(this.states.AreaList),this.$el.addClass("ui-widget-content"),this.$el.resizable({maxWidth:900,minWidth:340,handles:"e"})},events:{"click .kb-js-sidebar-nav-back":"rootView","click [data-kb-action]":"actionHandler",mouseleave:"detectActivity",mouseenter:"clearTimer"},detectActivity:function(){var a=this;this.timer=setTimeout(function(){a.$el.addClass("kb-opaque")},15e3)},clearTimer:function(){var a=this;this.timer&&(clearTimeout(this.timer),a.$el.removeClass("kb-opaque"))},render:function(){this.$el=jQuery('<div class="kb-sidebar-wrap" style="display: none;"></div>').appendTo("body"),this.$toggle=jQuery('<div class="kb-sidebar-wrap--toggle cbutton cbutto-effect--boris"></div>').appendTo("body"),this.Header=new f({}),this.$el.append(this.Header.render()),this.$container=jQuery('<div class="kb-sidebar-wrap__container"></div>').appendTo(this.$el),this.$extension=jQuery('<div class="kb-sidebar-extension" style="display: none;"></div>').appendTo(this.$el),this.setLayout();var a=g.stex.get("kb-sidebar-visible");a&&(this.toggleSidebar(),this.detectActivity())},bindHandlers:function(){var a=this;jQuery(window).resize(function(){a.setLayout()}),this.$toggle.on("click",function(){a.toggleSidebar()})},setLayout:function(){var a=jQuery(window).height();this.$el.width();this.$el.height(a),this.$extension.height(a)},setExtendedView:function(a){this.currentExtendedView&&this.currentExtendedView.$el.detach(),this.currentExtendedView=a,this.$extension.html(a.render()),this.$extension.show()},closeExtendedView:function(){this.currentExtendedView.$el.detach(),this.currentExtendedView=null,this.$extension.html(""),this.$extension.hide()},setView:function(a){this.currentView&&this.currentView.$el.detach(),this.currentView=a,this.viewStack.push(a),this.$container.html(a.render()),this.handleNavigationControls()},prevView:function(){var a=this.viewStack.shift();a&&this.setView(a)},rootView:function(){this.viewStack=[],this.setView(this.states.AreaList)},handleNavigationControls:function(){this.viewStack.length>=2?this.$navControls.prependTo(this.$container):this.$navControls.detach()},toggleSidebar:function(){this.visible=!this.visible,this.$el.fadeToggle(),jQuery("body").toggleClass("kb-sidebar-visible"),g.stex.set("kb-sidebar-visible",this.visible,36e5),this.visible?this.trigger("sidebar.open"):this.trigger("sidebar.close")},actionHandler:function(a){var b=jQuery(a.currentTarget).data("kb-action");b&&this.states[b]&&this.setView(this.states[b])}})},{"common/Utilities":17,"frontend/Views/Sidebar/AreaDetails/CategoryFilter":48,"frontend/Views/Sidebar/AreaOverview/AreaOverviewController":51,"frontend/Views/Sidebar/SidebarHeader":53,"templates/frontend/sidebar/sidebar-nav.hbs":83}],45:[function(a,b,c){var d=a("frontend/Views/Sidebar/AreaDetails/CategoryController"),e=a("frontend/Views/Sidebar/AreaDetails/AreaSettingsController"),f=a("common/Config"),g=a("common/Notice"),h=a("common/Ajax"),i=a("templates/frontend/sidebar/area-details-header.hbs");b.exports=Backbone.View.extend({tagName:"div",className:"kb-sidebar__module-list",initialize:function(a){this.currentLayout=this.model.get("layout"),this.controller=a.controller,this.sidebarController=a.sidebarController,this.categories=this.sidebarController.CategoryFilter.filter(this.model),this.Settings=new e({model:this.model,controller:this,sidebarController:this.sidebarController}),this.renderHeader(),this.bindHandlers(),this.$settingsContainer.append(this.Settings.render()),this.renderCategories()},events:{"click .kb-sidebar-action--cog":"toggle","click .kb-sidebar-action--update":"updateAreaSettings"},bindHandlers:function(){this.listenTo(this.model,"change:layout",this.handleLayoutChange)},render:function(){return this.$el},renderHeader:function(){this.$el.append(i(this.model.toJSON())),this.$settingsContainer=this.$el.find(".kb-sidebar-area-details__settings"),this.$updateHandle=this.$el.find(".kb-sidebar-action--update").hide()},renderCategories:function(){var a=this;_.each(this.categories.toJSON(),function(b,c){var e=new d({model:new Backbone.Model(b),controller:a});a.$el.append(e.render())})},toggle:function(){this.$settingsContainer.slideToggle()},handleLayoutChange:function(){this.model.get("layout")!==this.currentLayout?this.$updateHandle.show():this.$updateHandle.hide()},updateAreaSettings:function(){h.send({action:"saveAreaLayout",area:this.model.toJSON(),layout:this.model.get("layout"),_ajax_nonce:f.getNonce("update")},this.updateSuccess,this)},updateSuccess:function(a){a.success?(g.notice(a.message,"success"),
this.currentLayout=a.data.layout,this.model.set("layout",a.data.layout),this.handleLayoutChange()):g.notice(a.message,"error")}})},{"common/Ajax":8,"common/Config":10,"common/Notice":12,"frontend/Views/Sidebar/AreaDetails/AreaSettingsController":46,"frontend/Views/Sidebar/AreaDetails/CategoryController":47,"templates/frontend/sidebar/area-details-header.hbs":75}],46:[function(a,b,c){var d=a("common/Payload"),e=a("templates/frontend/area-layout-item.hbs");b.exports=Backbone.View.extend({tagName:"ul",className:"kb-sidebar-area-details__templates",LayoutDefs:d.getPayload("AreaTemplates")||{},events:{"click li":"layoutSelect"},initialize:function(a){this.controller=a.controller,this.sidebarController=a.SidebarController,this.setOptions()},render:function(){return this.$el},layoutSelect:function(a){var b=jQuery(a.currentTarget);this.$el.find(".kb-active-area-layout").removeClass(),b.addClass("kb-active-area-layout"),this.model.View.changeLayout(b.data("item")),this.model.set("layout",b.data("item"))},setOptions:function(){var a="",b=this.model.get("layouts");b&&b.length>0&&(this.$el.prepend('<div class="kb-sidebar__subheader">Layouts</div>'),_.each(this.prepareLayouts(b),function(b){a+=e({item:b})}),this.$el.append(a))},prepareLayouts:function(a){var b=this,c=this.model.get("layout");return _.map(a,function(a){if(b.LayoutDefs[a]){var d=b.LayoutDefs[a];return d.id===c?d.currentClass="kb-active-area-layout":d.currentClass="",d}})}})},{"common/Payload":13,"templates/frontend/area-layout-item.hbs":70}],47:[function(a,b,c){var d=a("frontend/Views/Sidebar/AreaDetails/ModuleDragItem"),e=a("templates/frontend/sidebar/category-list.hbs");b.exports=Backbone.View.extend({tagName:"div",className:"kb-sidebar__module-category",initialize:function(a){this.controller=a.controller,this.$el.append(e(this.model.toJSON())),this.$list=this.$el.find("ul"),this.setupModuleItems()},render:function(){return this.$el},setupModuleItems:function(){var a=this;_.each(this.model.get("modules"),function(b){var c=new d({model:new Backbone.Model(b),listController:a.controller,controller:a});a.$list.append(c.render())})}})},{"frontend/Views/Sidebar/AreaDetails/ModuleDragItem":49,"templates/frontend/sidebar/category-list.hbs":76}],48:[function(a,b,c){var d=a("common/Payload");b.exports=Backbone.View.extend({categories:d.getPayload("ModuleCategories"),definitions:d.getPayload("ModuleDefinitions"),initialize:function(){this.setupSortTable()},filter:function(a){var b=this.setupSortTable(),c=a.get("assignedModules");return _.each(this.definitions,function(a,d){-1!==_.indexOf(c,d)&&(b[a.settings.category].modules[d]=a)}),new Backbone.Model(this.removeEmptyCats(b))},setupSortTable:function(){var a={};return _.each(this.categories,function(b,c){a[c]={name:b,id:c,modules:{}}}),a},removeEmptyCats:function(a){return _.each(a,function(b,c){_.isEmpty(b.modules)&&delete a[c]}),a.core&&delete a.core,a}})},{"common/Payload":13}],49:[function(a,b,c){var d=a("common/Payload"),e=a("common/Notice"),f=a("common/Config"),g=a("common/Checks"),h=(a("frontend/Models/ModuleModel"),a("frontend/Views/AreaView")),i=a("common/Ajax"),j=a("templates/frontend/sidebar/category-module-item.hbs");b.exports=Backbone.View.extend({tagName:"li",className:"kb-sidebar-module",initialize:function(a){var b=this;this.controller=a.controller,this.listController=a.listController,this.$el.append(j(this.model.toJSON())),this.$dropHelper=jQuery("<div class='kb-sidebar-drop-helper ui-sortable-helper'></div>"),this.model.set("area",this.listController.model),this.$el.draggable({appendTo:b.listController.model.View.$el.selector,revert:"invalid",refreshPositions:!0,cursorAt:{top:5,left:5},stop:function(){b.listController.model.View.$el.css("overflow","")},helper:function(){return b.listController.model.View.$el.css("overflow","hidden"),b.$dropHelper},drag:function(){b.$dropHelper.css("zIndex","10000")},connectToSortable:this.listController.model.View.$el.selector}).data("module",this)},render:function(){return this.$el},create:function(a){var b,c,d;return g.userCan("create_kontentblocks")||e.notice("You're not allowed to do this","error"),b=KB.Areas.get(this.model.get("area").get("id")),g.blockLimit(b)?(d=this.model,c={action:"createNewModule","class":d.get("settings")["class"],globalModule:d.get("globalModule"),parentObject:d.get("parentObject"),areaContext:b.get("context"),area:b.get("id"),_ajax_nonce:f.getNonce("create"),frontend:KB.appData.config.frontend},this.model.get("area").get("parent_id")&&(c.postId=this.model.get("area").get("parent_id")),void i.send(c,this.success,this,{ui:a})):(e.notice("Limit for this area reached","error"),!1)},success:function(a,b){var c;b.ui.helper.replaceWith(a.data.html),c=KB.ObjectProxy.add(KB.Modules.add(a.data.module)),c.Area.View.Layout.applyClasses(),h.prototype.resort(this.model.get("area")),setTimeout(function(){d.parseAdditionalJSON(a.data.json)},250)}})},{"common/Ajax":8,"common/Checks":9,"common/Config":10,"common/Notice":12,"common/Payload":13,"frontend/Models/ModuleModel":30,"frontend/Views/AreaView":33,"templates/frontend/sidebar/category-module-item.hbs":77}],50:[function(a,b,c){var d=a("frontend/Views/Sidebar/AreaOverview/ModuleListItem"),e=a("frontend/Views/Sidebar/AreaDetails/AreaDetailsController"),f=a("templates/frontend/sidebar/empty-area.hbs");b.exports=Backbone.View.extend({tagName:"ul",className:"kb-sidebar-areaview__modules-list",ModuleViews:{},initialize:function(a){this.Modules=new Backbone.Collection,this.$parent=a.$el,this.controller=a.controller,this.sidebarController=a.sidebarController,this.$toggleHandle=this.$parent.find(".kb-sidebar-areaview__title"),this.ModuleList=new e({controller:a.controller,sidebarController:a.sidebarController,model:this.model}),this.render(),this.bindHandlers()},render:function(){this.$el.appendTo(this.$parent).hide()},bindHandlers:function(){var a=this;this.listenTo(this.Modules,"add",this.renderModuleItem),this.listenTo(this.model,"area.resorted",this.resortViews),this.$toggleHandle.on("click",function(){a.controller.setActiveList(a)}),this.$parent.on("click",".kb-js-sidebar-add-module",function(){a.sidebarController.setView(a.ModuleList)}),this.listenToOnce(KB.Events,"KB.frontend.init",this.afterInit)},activate:function(){this.$parent.removeClass("kb-sidebar-areaview--inactive"),this.model.View.$el.addClass("kb-in-sidebar-active")},deactivate:function(){this.$parent.addClass("kb-sidebar-areaview--inactive"),this.model.View.$el.removeClass("kb-in-sidebar-active")},renderModuleItem:function(a){this.ModuleViews[a.id]=View=new d({$parent:this.$el,model:a}),View.$el.appendTo(this.$el)},attachModuleView:function(a){this.Modules.add(a.model),this.listenToOnce(a.model,"remove",this.removeModuleView)},removeModuleView:function(a){var b=this.ModuleViews[a.id];this.Modules.remove(a),delete this.ModuleViews[a.id],b.dispose()},afterInit:function(){0===this.Modules.models.length&&this.model.View.$el.is(":visible")&&this.$el.append(f({}))},moduleOrder:function(){var a=this.model.View.$el,b=jQuery("[id^=module]",a);return _.pluck(b,"id")},resortViews:function(){var a=this,b=this.moduleOrder().reverse();_.each(b,function(b){var c=a.ModuleViews[b];c.$el.detach(),c.$el.prependTo(a.$el)})}})},{"frontend/Views/Sidebar/AreaDetails/AreaDetailsController":45,"frontend/Views/Sidebar/AreaOverview/ModuleListItem":52,"templates/frontend/sidebar/empty-area.hbs":78}],51:[function(a,b,c){var d=a("frontend/Views/Sidebar/AreaOverview/AreaListItem"),e=a("templates/frontend/sidebar/sidebar-area-view.hbs"),f=a("templates/frontend/sidebar/root-item.hbs");b.exports=Backbone.View.extend({tagName:"div",className:"kb-sidebar-main-panel",Areas:new Backbone.Collection,AreaViews:{},activeList:null,events:{"click .kb-sidebar-areaview__title":"toggleList"},initialize:function(a){this.sidebarController=a.controller,this.render(),this.bindHandlers()},render:function(){return this.$el},bindHandlers:function(){this.listenTo(KB.Views.Areas,"view:add",this.attachAreaView),this.listenTo(KB.Views.Modules,"view:add",this.attachModuleView),this.listenTo(this.Areas,"add",this.createAreaItem)},attachAreaView:function(a){a.el&&this.Areas.add(a.model)},attachModuleView:function(a){var b=this.AreaViews[a.model.get("area")];b&&b.attachModuleView(a)},createAreaItem:function(a){if(!a.get("internal")){var b=jQuery(e(a.toJSON())).appendTo(this.$el);this.AreaViews[a.get("id")]=new d({$el:b,controller:this,sidebarController:this.sidebarController,model:a})}},setActiveList:function(a){return this.activeList&&this.activeList.cid?this.activeList.cid===a.cid?!1:(this.activeList.$el.slideUp(),this.activeList.deactivate(),this.activeList=null,this.setActiveList(a),void 0):(this.activeList=a,a.$el.slideDown(),a.activate(),!0)},renderRootItem:function(){return this.sidebarController.$container.append(f({text:"Areas",id:"AreaList"}))}})},{"frontend/Views/Sidebar/AreaOverview/AreaListItem":50,"templates/frontend/sidebar/root-item.hbs":80,"templates/frontend/sidebar/sidebar-area-view.hbs":81}],52:[function(a,b,c){var d=a("templates/frontend/sidebar/module-view-item.hbs");b.exports=Backbone.View.extend({tagName:"li",initialize:function(a){this.$parent=a.$parent,this.parentView=this.model.View,this.bindHandlers(),this.render()},events:{mouseenter:"over",mouseleave:"out",click:"scrollTo","click .kb-sidebar-item__edit":"openControls","click .kb-js-inline-update":"inlineUpdate","click .kb-js-inline-delete":"inlineDelete"},bindHandlers:function(){this.listenTo(this.model,"change",this.getDirty),this.listenTo(this.model,"module.model.updated",this.getClean)},getDirty:function(){this.$el.addClass("kb-module-dirty")},getClean:function(){this.$el.removeClass("kb-module-dirty")},over:function(){this.parentView.$el.addClass("kb-in-sidebar-active")},out:function(){this.parentView.$el.removeClass("kb-in-sidebar-active")},openControls:function(a){a.stopPropagation(),this.parentView.openOptions()},inlineUpdate:function(a){a.stopPropagation(),this.parentView.Controls.UpdateControl.update(),this.parentView.getClean()},inlineDelete:function(a){a.stopPropagation(),this.parentView.Controls.DeleteControl.confirmRemoval()},scrollTo:function(){var a=this;jQuery("html, body").animate({scrollTop:a.parentView.$el.offset().top-100},750)},render:function(){this.$el.append(d({view:this.model.toJSON()}))},dispose:function(){this.stopListening(),this.remove(),delete this.model,delete this.parentView}})},{"templates/frontend/sidebar/module-view-item.hbs":79}],53:[function(a,b,c){var d=a("templates/frontend/sidebar/sidebar-header.hbs");b.exports=Backbone.View.extend({tagName:"div",className:"kb-sidebar__header",initialize:function(){this.$el.append(d({}))},render:function(){return this.$el}})},{"templates/frontend/sidebar/sidebar-header.hbs":82}],54:[function(a,b,c){var d=a("shared/ModuleBrowser/ModuleBrowserDefinitions"),e=a("shared/ModuleBrowser/ModuleDefinitionModel"),f=a("shared/ModuleBrowser/ModuleBrowserDescriptions"),g=a("shared/ModuleBrowser/ModuleBrowserNavigation"),h=a("shared/ModuleBrowser/ModuleBrowserList"),i=a("common/Checks"),j=a("common/Notice"),k=a("common/Payload"),l=a("common/Ajax"),m=a("common/TinyMCE"),n=a("common/Config"),o=a("templates/backend/modulebrowser/module-browser.hbs");b.exports=Backbone.View.extend({initialize:function(a){this.options=a||{},this.isOpen=!1,this.area=this.options.area,this.viewMode=this.getViewMode(),this.modulesDefinitions=new d(this.prepareAssignedModules(),{model:e,area:this.options.area}).setup(),this.$el.append(o({viewMode:this.getViewModeClass()})),this.$backdrop=jQuery('<div class="kb-module-browser--backdrop"></div>'),this.subviews.ModulesList=new h({el:jQuery(".modules-list",this.$el),browser:this}),this.subviews.ModuleDescription=new f({el:jQuery(".module-description",this.$el),browser:this}),this.subviews.Navigation=new g({el:jQuery(".module-categories",this.$el),cats:this.modulesDefinitions.categories,browser:this}),this.listenTo(this.subviews.Navigation,"browser:change",this.update),this.bindHandlers()},tagName:"div",id:"module-browser",className:"kb-overlay",events:{"click .close-browser":"close","click .module-browser--switch__list-view":"toggleViewMode","click .module-browser--switch__excerpt-view":"toggleViewMode"},subviews:{},toggleViewMode:function(){jQuery(".module-browser-wrapper",this.$el).toggleClass("module-browser--list-view module-browser--excerpt-view");var a="mdb_"+this.area.model.get("id")+"_state",b=store.get(a);"list"==b?(this.viewMode="excerpt",store.set(a,"excerpt")):(this.viewMode="list",store.set(a,"list"))},render:function(){this.open()},getViewMode:function(){var a="mdb_"+this.area.model.get("id")+"_state";return store.get(a)?store.get(a):(store.set(a,"list"),"list")},getViewModeClass:function(){return"list"===this.viewMode?"module-browser--list-view":"module-browser--excerpt-view"},bindHandlers:function(){var a=this;jQuery("body").on("click",function(b){a.isOpen&&jQuery(b.target).is(".kb-module-browser--backdrop")&&a.close()}),jQuery(document).keydown(function(b){if(a.isOpen){switch(b.which){case 27:a.close();break;default:return}b.preventDefault()}})},open:function(){this.$el.appendTo("body"),this.$backdrop.appendTo("body"),jQuery("#wpwrap").addClass("module-browser-open"),jQuery(".kb-nano").nanoScroller({flash:!0,contentClass:"kb-nano-content"}),this.isOpen=!0},close:function(){jQuery("#wpwrap").removeClass("module-browser-open"),this.trigger("browser:close"),this.$backdrop.detach(),this.$el.detach(),this.isOpen=!1},update:function(a){var b=a.get("id"),c=this.modulesDefinitions.getModules(b);this.subviews.ModulesList.setModules(c).update()},loadDetails:function(a){this.subviews.ModuleDescription.model=a,this.subviews.ModuleDescription.update()},createModule:function(a){var b,c;return i.userCan("create_kontentblocks")||j.notice("You're not allowed to do this","error"),b=KB.Areas.get(this.options.area.model.get("id")),i.blockLimit(b)?(c={action:"createNewModule","class":a.get("settings")["class"],globalModule:a.get("globalModule"),parentObject:a.get("parentObject"),parentObjectId:a.get("parentObjectId"),areaContext:this.options.area.model.get("context"),area:this.options.area.model.get("id"),_ajax_nonce:n.getNonce("create"),frontend:KB.appData.config.frontend},this.options.area.model.get("parent_id")&&(c.postId=this.options.area.model.get("parent_id")),this.close(),void l.send(c,this.success,this)):(j.notice("Limit for this area reached","error"),!1)},success:function(a){var b,c;c=a.data,this.options.area.modulesList.append(c.html),b=KB.ObjectProxy.add(KB.Modules.add(c.module)),this.options.area.attachModuleView(b),this.parseAdditionalJSON(c.json),b.View.$el.addClass("kb-open"),setTimeout(function(){KB.Fields.trigger("newModule",b.View),m.addEditor(b.View.$el)},150)},parseAdditionalJSON:function(a){KB.payload.Fields||(KB.payload.Fields={}),_.extend(KB.payload.Fields,a.Fields),k.parseAdditionalJSON(a)},prepareAssignedModules:function(){var a=this.area.model.get("assignedModules"),b=[];return _.each(k.getPayload("ModuleDefinitions"),function(c){-1!==_.indexOf(a,c.settings["class"])&&b.push(c)}),b}})},{"common/Ajax":8,"common/Checks":9,"common/Config":10,"common/Notice":12,"common/Payload":13,"common/TinyMCE":15,"shared/ModuleBrowser/ModuleBrowserDefinitions":55,"shared/ModuleBrowser/ModuleBrowserDescriptions":56,"shared/ModuleBrowser/ModuleBrowserList":57,"shared/ModuleBrowser/ModuleBrowserNavigation":59,"shared/ModuleBrowser/ModuleDefinitionModel":60,"templates/backend/modulebrowser/module-browser.hbs":64}],55:[function(a,b,c){var d=a("common/Payload");b.exports=Backbone.Collection.extend({initialize:function(a,b){this.area=b.area},setup:function(){return this.categories=this.prepareCategories(),this.sortToCategories(),this},getModules:function(a){return this.categories[a].modules},sortToCategories:function(){var a=this;_.each(this.models,function(b){if(a.validateVisibility(b)){var c=_.isUndefined(b.get("settings").category)?"standard":b.get("settings").category;a.categories[c].modules.push(b)}})},validateVisibility:function(a){return a.get("settings").hidden?!1:a.get("settings").disabled?!1:!(!a.get("settings").globalModule&&this.area.model.get("dynamic"))},prepareCategories:function(){var a={};return _.each(d.getPayload("ModuleCategories"),function(b,c){a[c]={id:c,name:b,modules:[]}}),a}})},{"common/Payload":13}],56:[function(a,b,c){var d=a("common/Templates"),e=a("templates/backend/modulebrowser/module-template-description.hbs"),f=a("templates/backend/modulebrowser/module-description.hbs"),g=a("templates/backend/modulebrowser/poster.hbs");b.exports=Backbone.View.extend({initialize:function(a){this.options=a||{},this.Browser=a.browser,this.Browser.on("browser:close",this.close,this)},events:{"click .kb-js-create-module":"createModule"},update:function(){this.$el.empty(),this.model.get("template")?this.$el.html(e({module:this.model.toJSON()})):this.$el.html(f({module:this.model.toJSON()})),this.model.get("settings").poster!==!1&&this.$el.append(g({module:this.model.toJSON()})),this.model.get("settings").helpfile!==!1&&this.$el.append(d.render(this.model.get("settings").helpfile,{module:this.model.toJSON()}))},close:function(){},createModule:function(){this.Browser.createModule(this.model)}})},{"common/Templates":14,"templates/backend/modulebrowser/module-description.hbs":65,"templates/backend/modulebrowser/module-template-description.hbs":67,"templates/backend/modulebrowser/poster.hbs":69}],57:[function(a,b,c){var d=a("shared/ModuleBrowser/ModuleBrowserListItem");b.exports=Backbone.View.extend({initialize:function(a){this.options=a||{}},modules:{},subviews:{},setModules:function(a){return this.modules=a,this},update:function(){var a=this,b=!1;this.$el.empty(),_.each(this.modules,function(c){a.subviews[c.cid]=new d({model:c,parent:a,browser:a.options.browser}),b===!1&&(a.options.browser.loadDetails(c),b=!b),a.$el.append(a.subviews[c.cid].render(a.$el))})}})},{"shared/ModuleBrowser/ModuleBrowserListItem":58}],58:[function(a,b,c){var d=a("templates/backend/modulebrowser/module-template-list-item.hbs"),e=a("templates/backend/modulebrowser/module-list-item.hbs");b.exports=Backbone.View.extend({tagName:"li",className:"modules-list-item",initialize:function(a){this.options=a||{},this.Browser=a.browser,this.area=a.browser.area},render:function(a){this.model.get("globalModule")?this.$el.html(d({module:this.model.toJSON()})):this.$el.html(e({module:this.model.toJSON()})),a.append(this.$el)},events:{click:"handleClick","click .kb-js-create-module":"handlePlusClick"},handleClick:function(){"list"===this.Browser.viewMode?this.createModule():this.Browser.loadDetails(this.model)},handlePlusClick:function(){return"list"===this.Browser.viewMode?!1:void this.createModule()},createModule:function(){this.Browser.createModule(this.model)},close:function(){this.remove()}})},{"templates/backend/modulebrowser/module-list-item.hbs":66,"templates/backend/modulebrowser/module-template-list-item.hbs":68}],59:[function(a,b,c){b.exports=Backbone.View.extend({item:Backbone.View.extend({initialize:function(a){this.options=a||{}},tagName:"li",className:"cat-item",events:{click:"change"},change:function(){this.options.parent.trigger("browser:change",this.model),this.$el.addClass("active"),jQuery("li").not(this.$el).removeClass("active")},render:function(){var a=_.keys(this.model.get("modules")).length,b="("+a+")";return 0===a?!1:(this.options.parent.catSet===!1&&(this.options.parent.catSet=!0,this.options.browser.update(this.model),this.$el.addClass("active")),void this.options.parent.$list.append(this.$el.html(this.model.get("name")+'<span class="module-count">'+b+"</span>")))}}),catSet:!1,initialize:function(a){var b=this;this.options=a||{},this.$list=jQuery("<ul></ul>").appendTo(this.$el),_.each(this.options.cats,function(a){var c=new Backbone.Model(a);new b.item({parent:b,model:c,browser:b.options.browser}).render()})}})},{}],60:[function(a,b,c){b.exports=Backbone.Model.extend({initialize:function(){var a=this;this.id=function(){return"template"===a.get("settings").category?a.get("mid"):a.get("settings")["class"]}()}})},{}],61:[function(a,b,c){KB.ViewsCollection=function(){this.views={},this.lastViewAdded=null,this.add=function(a,b){return this.views[a]||(this.views[a]=b,KB.trigger("kb:"+b.model.get("class")+":added",b),this.trigger("view:add",b),this.lastViewAdded=b),b},this.ready=function(){_.each(this.views,function(a){a.trigger("kb:"+a.model.get("class"),a),KB.trigger("kb:"+a.model.get("class")+":loaded",a)}),KB.trigger("kb:ready")},this.readyOnFront=function(){_.each(this.views,function(a){a.trigger("kb:"+a.model.get("class"),a),KB.trigger("kb:"+a.model.get("class")+":loadedOnFront",a)}),KB.trigger("kb:ready")},this.remove=function(a){var b=this.get(a);b.model.Area.View.trigger("kb.module.deleted",b),this.trigger("kb.modules.view.deleted",b),delete this.views[a],b.dispose()},this.get=function(a){return this.views[a]?this.views[a]:void 0},this.filterByModelAttr=function(a,b){return _.filter(this.views,function(c){return c.model.get(a)===b})}},_.extend(KB.ViewsCollection.prototype,Backbone.Events),b.exports=KB.ViewsCollection},{}],62:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){return'<div class="kb-context-bar grid__col grid__col--12-of-12">\n    <ul class="kb-context-bar--actions">\n\n    </ul>\n</div>'},useData:!0})},{"hbsfy/runtime":92}],63:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){return"<ul class='module-actions'></ul>"},useData:!0})},{"hbsfy/runtime":92}],64:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'<div class="module-browser-wrapper '+this.escapeExpression((e=null!=(e=b.viewMode||(null!=a?a.viewMode:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"viewMode",hash:{},data:d}):e))+'">\n\n    <div class="module-browser-header module-categories">\n        <a class="genericon genericon-close-alt close-browser kb-button"></a>\n        <a class="dashicons dashicons-list-view module-browser--switch__list-view "></a>\n        <a class="dashicons dashicons-exerpt-view module-browser--switch__excerpt-view "></a>\n    </div>\n\n    <div class="module-browser__left-column kb-nano">\n        <ul class="modules-list kb-nano-content">\n\n        </ul>\n    </div>\n\n    <div class="module-browser__right-column kb-nano">\n        <div class="module-description kb-nano-content">\n\n        </div>\n    </div>\n</div>'},useData:!0})},{"hbsfy/runtime":92}],65:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return"<h3>"+this.escapeExpression(this.lambda(null!=(e=null!=(e=null!=a?a.module:a)?e.settings:e)?e.publicName:e,a))+' <div class="kb-button-small kb-js-create-module">Add module</div>\n</h3>\n'},useData:!0})},{"hbsfy/runtime":92}],66:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f=this.lambda,g=this.escapeExpression;return'<div class="dashicons dashicons-plus kb-js-create-module"></div>\n<h4>'+g(f(null!=(e=null!=(e=null!=a?a.module:a)?e.settings:e)?e.publicName:e,a))+'</h4>\n<p class="description">'+g(f(null!=(e=null!=(e=null!=a?a.module:a)?e.settings:e)?e.description:e,a))+"</p>"},useData:!0})},{"hbsfy/runtime":92}],67:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return"<h3>"+this.escapeExpression(this.lambda(null!=(e=null!=(e=null!=a?a.module:a)?e.parentObject:e)?e.post_title:e,a))+"</h3>"},useData:!0})},{"hbsfy/runtime":92}],68:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'<div class="dashicons dashicons-plus kb-js-create-module"></div>\n<h4>'+this.escapeExpression(this.lambda(null!=(e=null!=(e=null!=a?a.module:a)?e.parentObject:e)?e.post_title:e,a))+"</h4>"},useData:!0})},{"hbsfy/runtime":92}],69:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'<div class="module-browser--poster-wrap">\n    <img src="'+this.escapeExpression(this.lambda(null!=(e=null!=(e=null!=a?a.module:a)?e.settings:e)?e.poster:e,a))+'" >\n</div>'},useData:!0})},{"hbsfy/runtime":92}],70:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({1:function(a,b,c,d){var e;return"            <img src='"+this.escapeExpression(this.lambda(null!=(e=null!=a?a.item:a)?e.thumbnail:e,a))+"'>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f=this.lambda,g=this.escapeExpression;return'<li class="'+g(f(null!=(e=null!=a?a.item:a)?e.currentClass:e,a))+"\" data-item='"+g(f(null!=(e=null!=a?a.item:a)?e.id:e,a))+"'>\n    <div class='kb-area-layout-thumbnail'>\n"+(null!=(e=b["if"].call(a,null!=(e=null!=a?a.item:a)?e.thumbnail:e,{name:"if",hash:{},fn:this.program(1,d,0),inverse:this.noop,data:d}))?e:"")+"    </div>\n    "+g(f(null!=(e=null!=a?a.item:a)?e.label:e,a))+"\n</li>"},useData:!0})},{"hbsfy/runtime":92}],71:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){return'<p>You have unsaved changes. <span class="kb-button">Save now.</span></p>'},useData:!0})},{"hbsfy/runtime":92}],72:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({1:function(a,b,c,d){return" dynamic-module "},3:function(a,b,c,d){return" master-module "},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return"<div class='kb-module-controls os-controls "+(null!=(e=b["if"].call(a,null!=(e=null!=a?a.model:a)?e.inDynamic:e,{name:"if",hash:{},fn:this.program(1,d,0),inverse:this.noop,data:d}))?e:"")+" "+(null!=(e=b["if"].call(a,null!=(e=null!=a?a.model:a)?e.globalModule:e,{name:"if",hash:{},fn:this.program(3,d,0),inverse:this.noop,data:d}))?e:"")+"'>\n\n</div>"},useData:!0})},{"hbsfy/runtime":92}],73:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f=this.lambda,g=this.escapeExpression;return'<h2 class="controls-title">Module: <span> '+g(f(null!=(e=null!=(e=null!=a?a.model:a)?e.settings:e)?e.name:e,a))+'</span></h2>\n<div class="kb-modal__draft-notice" style="display: none;">Draft Message</div>\n<a class="dashicons dashicons-no close-controls kb-button"></a>\n<div class="kb-controls--buttons-wrap">\n    <a class="kb-save-form kb-button kb-button-primary" title="'+g(f(null!=(e=null!=(e=null!=a?a.i18n:a)?e.frontendModal:e)?e.modalSave:e,a))+'">\n        <div class="dashicons dashicons-update"></div>'+g(f(null!=(e=null!=(e=null!=a?a.i18n:a)?e.frontendModal:e)?e.modalSave:e,a))+'<span\n            class="kb-dirty-notice">*</span></a>\n    <a class="kb-preview-form kb-button kb-button-secondary">'+g(f(null!=(e=null!=(e=null!=a?a.i18n:a)?e.frontendModal:e)?e.modalPreview:e,a))+'</a>\n</div>\n<form id="onsite-form" class="wp-core-ui wp-admin kb-nano">\n    <div class="kb-nano-content" id="onsite-content">\n\n        <div class="os-content-inner kb-module">\n\n        </div>\n    </div>\n</form>'},useData:!0})},{"hbsfy/runtime":92}],74:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'<div class="kb-module__placeholder">\n    <p>'+this.escapeExpression(this.lambda(null!=(e=null!=(e=null!=a?a.model:a)?e.settings:e)?e.name:e,a))+"\n    <span>Start here.</span>\n    </p>\n</div>"},useData:!0})},{"hbsfy/runtime":92}],75:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'<div class="kb-sidebar__subheader">\n    <span>You are editing area:</span> '+this.escapeExpression((e=null!=(e=b.name||(null!=a?a.name:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"name",hash:{},data:d}):e))+'\n    <div class="kb-sidebar-action--update kb-fx-button kb-fx-button--effect-boris"><span class="dashicons dashicons-update"></span></div>\n    <div class="kb-sidebar-action--cog kb-fx-button kb-fx-button--effect-boris"><span class="dashicons dashicons-admin-generic"></span></div>\n</div>\n<div class="kb-sidebar-area-details__settings" style="display: none">\n\n</div>\n<!--<div class="kb-sidebar-area-details__subheader">Categories</div>-->'},useData:!0})},{"hbsfy/runtime":92}],76:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'<div class="kb-sidebar__category-item">\n    <div class="kb-sidebar__category-item__title">\n        Category: '+this.escapeExpression((e=null!=(e=b.name||(null!=a?a.name:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"name",hash:{},data:d}):e))+'\n    </div>\n    <ul class="kb-sidebar__category-item__module-list">\n    </ul>\n</div>'},useData:!0})},{"hbsfy/runtime":92}],77:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'<div class="kb-sidebar__cat-module-item">\n    '+this.escapeExpression(this.lambda(null!=(e=null!=a?a.settings:a)?e.name:e,a))+'\n    <div class="kb-sidebar__cat-module-item__actions">\n    </div>\n</div>\n'},useData:!0})},{"hbsfy/runtime":92}],78:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){return'<li class="kb-sidebar__no-modules">No Modules attached yet</li>'},useData:!0})},{"hbsfy/runtime":92}],79:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f=this.lambda,g=this.escapeExpression;return'<div class="kb-sidebar-item__wrapper">\n    <div class="kb-sidebar-item__name">'+(null!=(e=f(null!=(e=null!=(e=null!=a?a.view:a)?e.settings:e)?e.name:e,a))?e:"")+'</div>\n    <div class="kb-sidebar-item__id">'+(null!=(e=f(null!=(e=null!=(e=null!=a?a.view:a)?e.settings:e)?e.id:e,a))?e:"")+"</div>\n</div>\n<div class=\"kb-sidebar-item__actions\">\n    <a class='kb-sidebar-item__edit' title='edit'\n       data='"+g(f(null!=(e=null!=a?a.view:a)?e.mid:e,a))+"' data-url='"+g(f(null!=(e=null!=a?a.view:a)?e.editURL:e,a))+'\'>\n        <span class="dashicons dashicons-edit"></span>\n        <span class="os-action">'+g(f(null!=(e=null!=(e=null!=a?a.i18n:a)?e.moduleControls:e)?e.controlsEdit:e,a))+"</span></a>\n    <a class='kb-sidebar__module-delete kb-js-inline-delete'><span\n            class=\"dashicons dashicons-trash\"></span></a>\n    <a class='kb-sidebar__module-update kb-js-inline-update'><span\n            class=\"dashicons dashicons-update\"></span></a>\n\n</div>"},useData:!0})},{"hbsfy/runtime":92}],80:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f=b.helperMissing,g="function",h=this.escapeExpression;return'<div class="kb-sidebar__item kb-sidebar__item--root" data-kb-action="'+h((e=null!=(e=b.id||(null!=a?a.id:a))?e:f,typeof e===g?e.call(a,{name:"id",hash:{},data:d}):e))+'">\n    '+h((e=null!=(e=b.text||(null!=a?a.text:a))?e:f,typeof e===g?e.call(a,{name:"text",hash:{},data:d}):e))+'\n    <span class="dashicons dashicons-arrow-right-alt2 kb-sidebar__add-module kb-js-sidebar-add-module"></span>\n\n</div>'},useData:!0})},{"hbsfy/runtime":92}],81:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'<div class="kb-sidebar-areaview kb-sidebar-areaview--inactive">\n    <div class="kb-sidebar-areaview__title"> '+this.escapeExpression((e=null!=(e=b.name||(null!=a?a.name:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"name",hash:{},data:d}):e))+'</div>\n    <span class="dashicons dashicons-arrow-right-alt2 kb-sidebar__add-module kb-js-sidebar-add-module"></span>\n</div>'},useData:!0})},{"hbsfy/runtime":92}],82:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({
compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){return'<div class="kb-sidebar__header-wrap">\n    <div class="kb-sidebar__subheader">\n        Kontentblocks\n    </div>\n</div>'},useData:!0})},{"hbsfy/runtime":92}],83:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){return'<div class="kb-sidebar__nav-controls">\n    <div class="kb-sidebar__nav-button kb-js-sidebar-nav-back">\n        <span class="dashicons dashicons-arrow-left-alt2 cbutton cbutton--effect-boris"></span>\n    </div>\n</div>'},useData:!0})},{"hbsfy/runtime":92}],84:[function(a,b,c){"use strict";function d(){var a=new g.HandlebarsEnvironment;return m.extend(a,g),a.SafeString=i["default"],a.Exception=k["default"],a.Utils=m,a.escapeExpression=m.escapeExpression,a.VM=o,a.template=function(b){return o.template(b,a)},a}var e=function(a){return a&&a.__esModule?a:{"default":a}};c.__esModule=!0;var f=a("./handlebars/base"),g=e(f),h=a("./handlebars/safe-string"),i=e(h),j=a("./handlebars/exception"),k=e(j),l=a("./handlebars/utils"),m=e(l),n=a("./handlebars/runtime"),o=e(n),p=a("./handlebars/no-conflict"),q=e(p),r=d();r.create=d,q["default"](r),r["default"]=r,c["default"]=r,b.exports=c["default"]},{"./handlebars/base":85,"./handlebars/exception":86,"./handlebars/no-conflict":87,"./handlebars/runtime":88,"./handlebars/safe-string":89,"./handlebars/utils":90}],85:[function(a,b,c){"use strict";function d(a,b){this.helpers=a||{},this.partials=b||{},e(this)}function e(a){a.registerHelper("helperMissing",function(){if(1===arguments.length)return void 0;throw new k["default"]('Missing helper: "'+arguments[arguments.length-1].name+'"')}),a.registerHelper("blockHelperMissing",function(b,c){var d=c.inverse,e=c.fn;if(b===!0)return e(this);if(b===!1||null==b)return d(this);if(o(b))return b.length>0?(c.ids&&(c.ids=[c.name]),a.helpers.each(b,c)):d(this);if(c.data&&c.ids){var g=f(c.data);g.contextPath=i.appendContextPath(c.data.contextPath,c.name),c={data:g}}return e(b,c)}),a.registerHelper("each",function(a,b){function c(b,c,e){j&&(j.key=b,j.index=c,j.first=0===c,j.last=!!e,l&&(j.contextPath=l+b)),h+=d(a[b],{data:j,blockParams:i.blockParams([a[b],b],[l+b,null])})}if(!b)throw new k["default"]("Must pass iterator to #each");var d=b.fn,e=b.inverse,g=0,h="",j=void 0,l=void 0;if(b.data&&b.ids&&(l=i.appendContextPath(b.data.contextPath,b.ids[0])+"."),p(a)&&(a=a.call(this)),b.data&&(j=f(b.data)),a&&"object"==typeof a)if(o(a))for(var m=a.length;m>g;g++)c(g,g,g===a.length-1);else{var n=void 0;for(var q in a)a.hasOwnProperty(q)&&(n&&c(n,g-1),n=q,g++);n&&c(n,g-1,!0)}return 0===g&&(h=e(this)),h}),a.registerHelper("if",function(a,b){return p(a)&&(a=a.call(this)),!b.hash.includeZero&&!a||i.isEmpty(a)?b.inverse(this):b.fn(this)}),a.registerHelper("unless",function(b,c){return a.helpers["if"].call(this,b,{fn:c.inverse,inverse:c.fn,hash:c.hash})}),a.registerHelper("with",function(a,b){p(a)&&(a=a.call(this));var c=b.fn;if(i.isEmpty(a))return b.inverse(this);if(b.data&&b.ids){var d=f(b.data);d.contextPath=i.appendContextPath(b.data.contextPath,b.ids[0]),b={data:d}}return c(a,b)}),a.registerHelper("log",function(b,c){var d=c.data&&null!=c.data.level?parseInt(c.data.level,10):1;a.log(d,b)}),a.registerHelper("lookup",function(a,b){return a&&a[b]})}function f(a){var b=i.extend({},a);return b._parent=a,b}var g=function(a){return a&&a.__esModule?a:{"default":a}};c.__esModule=!0,c.HandlebarsEnvironment=d,c.createFrame=f;var h=a("./utils"),i=g(h),j=a("./exception"),k=g(j),l="3.0.1";c.VERSION=l;var m=6;c.COMPILER_REVISION=m;var n={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1"};c.REVISION_CHANGES=n;var o=i.isArray,p=i.isFunction,q=i.toString,r="[object Object]";d.prototype={constructor:d,logger:s,log:t,registerHelper:function(a,b){if(q.call(a)===r){if(b)throw new k["default"]("Arg not supported with multiple helpers");i.extend(this.helpers,a)}else this.helpers[a]=b},unregisterHelper:function(a){delete this.helpers[a]},registerPartial:function(a,b){if(q.call(a)===r)i.extend(this.partials,a);else{if("undefined"==typeof b)throw new k["default"]("Attempting to register a partial as undefined");this.partials[a]=b}},unregisterPartial:function(a){delete this.partials[a]}};var s={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:1,log:function(a,b){if("undefined"!=typeof console&&s.level<=a){var c=s.methodMap[a];(console[c]||console.log).call(console,b)}}};c.logger=s;var t=s.log;c.log=t},{"./exception":86,"./utils":90}],86:[function(a,b,c){"use strict";function d(a,b){var c=b&&b.loc,f=void 0,g=void 0;c&&(f=c.start.line,g=c.start.column,a+=" - "+f+":"+g);for(var h=Error.prototype.constructor.call(this,a),i=0;i<e.length;i++)this[e[i]]=h[e[i]];Error.captureStackTrace&&Error.captureStackTrace(this,d),c&&(this.lineNumber=f,this.column=g)}c.__esModule=!0;var e=["description","fileName","lineNumber","message","name","number","stack"];d.prototype=new Error,c["default"]=d,b.exports=c["default"]},{}],87:[function(a,b,c){"use strict";c.__esModule=!0,c["default"]=function(a){var b="undefined"!=typeof global?global:window,c=b.Handlebars;a.noConflict=function(){b.Handlebars===a&&(b.Handlebars=c)}},b.exports=c["default"]},{}],88:[function(a,b,c){"use strict";function d(a){var b=a&&a[0]||1,c=p.COMPILER_REVISION;if(b!==c){if(c>b){var d=p.REVISION_CHANGES[c],e=p.REVISION_CHANGES[b];throw new o["default"]("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+d+") or downgrade your runtime to an older version ("+e+").")}throw new o["default"]("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+a[1]+").")}}function e(a,b){function c(c,d,e){e.hash&&(d=m.extend({},d,e.hash)),c=b.VM.resolvePartial.call(this,c,d,e);var f=b.VM.invokePartial.call(this,c,d,e);if(null==f&&b.compile&&(e.partials[e.name]=b.compile(c,a.compilerOptions,b),f=e.partials[e.name](d,e)),null!=f){if(e.indent){for(var g=f.split("\n"),h=0,i=g.length;i>h&&(g[h]||h+1!==i);h++)g[h]=e.indent+g[h];f=g.join("\n")}return f}throw new o["default"]("The partial "+e.name+" could not be compiled when running in runtime-only mode")}function d(b){var c=void 0===arguments[1]?{}:arguments[1],f=c.data;d._setup(c),!c.partial&&a.useData&&(f=j(b,f));var g=void 0,h=a.useBlockParams?[]:void 0;return a.useDepths&&(g=c.depths?[b].concat(c.depths):[b]),a.main.call(e,b,e.helpers,e.partials,f,h,g)}if(!b)throw new o["default"]("No environment passed to template");if(!a||!a.main)throw new o["default"]("Unknown template object: "+typeof a);b.VM.checkRevision(a.compiler);var e={strict:function(a,b){if(!(b in a))throw new o["default"]('"'+b+'" not defined in '+a);return a[b]},lookup:function(a,b){for(var c=a.length,d=0;c>d;d++)if(a[d]&&null!=a[d][b])return a[d][b]},lambda:function(a,b){return"function"==typeof a?a.call(b):a},escapeExpression:m.escapeExpression,invokePartial:c,fn:function(b){return a[b]},programs:[],program:function(a,b,c,d,e){var g=this.programs[a],h=this.fn(a);return b||e||d||c?g=f(this,a,h,b,c,d,e):g||(g=this.programs[a]=f(this,a,h)),g},data:function(a,b){for(;a&&b--;)a=a._parent;return a},merge:function(a,b){var c=a||b;return a&&b&&a!==b&&(c=m.extend({},b,a)),c},noop:b.VM.noop,compilerInfo:a.compiler};return d.isTop=!0,d._setup=function(c){c.partial?(e.helpers=c.helpers,e.partials=c.partials):(e.helpers=e.merge(c.helpers,b.helpers),a.usePartial&&(e.partials=e.merge(c.partials,b.partials)))},d._child=function(b,c,d,g){if(a.useBlockParams&&!d)throw new o["default"]("must pass block params");if(a.useDepths&&!g)throw new o["default"]("must pass parent depths");return f(e,b,a[b],c,0,d,g)},d}function f(a,b,c,d,e,f,g){function h(b){var e=void 0===arguments[1]?{}:arguments[1];return c.call(a,b,a.helpers,a.partials,e.data||d,f&&[e.blockParams].concat(f),g&&[b].concat(g))}return h.program=b,h.depth=g?g.length:0,h.blockParams=e||0,h}function g(a,b,c){return a?a.call||c.name||(c.name=a,a=c.partials[a]):a=c.partials[c.name],a}function h(a,b,c){if(c.partial=!0,void 0===a)throw new o["default"]("The partial "+c.name+" could not be found");return a instanceof Function?a(b,c):void 0}function i(){return""}function j(a,b){return b&&"root"in b||(b=b?p.createFrame(b):{},b.root=a),b}var k=function(a){return a&&a.__esModule?a:{"default":a}};c.__esModule=!0,c.checkRevision=d,c.template=e,c.wrapProgram=f,c.resolvePartial=g,c.invokePartial=h,c.noop=i;var l=a("./utils"),m=k(l),n=a("./exception"),o=k(n),p=a("./base")},{"./base":85,"./exception":86,"./utils":90}],89:[function(a,b,c){"use strict";function d(a){this.string=a}c.__esModule=!0,d.prototype.toString=d.prototype.toHTML=function(){return""+this.string},c["default"]=d,b.exports=c["default"]},{}],90:[function(a,b,c){"use strict";function d(a){return k[a]}function e(a){for(var b=1;b<arguments.length;b++)for(var c in arguments[b])Object.prototype.hasOwnProperty.call(arguments[b],c)&&(a[c]=arguments[b][c]);return a}function f(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1}function g(a){if("string"!=typeof a){if(a&&a.toHTML)return a.toHTML();if(null==a)return"";if(!a)return a+"";a=""+a}return m.test(a)?a.replace(l,d):a}function h(a){return a||0===a?p(a)&&0===a.length?!0:!1:!0}function i(a,b){return a.path=b,a}function j(a,b){return(a?a+".":"")+b}c.__esModule=!0,c.extend=e,c.indexOf=f,c.escapeExpression=g,c.isEmpty=h,c.blockParams=i,c.appendContextPath=j;var k={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},l=/[&<>"'`]/g,m=/[&<>"'`]/,n=Object.prototype.toString;c.toString=n;var o=function(a){return"function"==typeof a};o(/x/)&&(c.isFunction=o=function(a){return"function"==typeof a&&"[object Function]"===n.call(a)});var o;c.isFunction=o;var p=Array.isArray||function(a){return a&&"object"==typeof a?"[object Array]"===n.call(a):!1};c.isArray=p},{}],91:[function(a,b,c){b.exports=a("./dist/cjs/handlebars.runtime")["default"]},{"./dist/cjs/handlebars.runtime":84}],92:[function(a,b,c){b.exports=a("handlebars/runtime")["default"]},{"handlebars/runtime":91}]},{},[21]);