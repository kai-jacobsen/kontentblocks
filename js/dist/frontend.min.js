/*! Kontentblocks ProdVersion 2016-07-10 01:07 */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){b.exports=Backbone.View.extend({tagName:"div",className:"",isValid:function(){return!0}})},{}],2:[function(a,b,c){b.exports=Backbone.View.extend({initialize:function(a){this.Controller=a.Controller,this.ContextsViews=this.setupContextsViews(),this.isVisible=!0,this.listenTo(this.Controller,"columns.rendered",this.columnActivated),this.listenTo(this.Controller,"columns.reset",this.reset)},setupContextsViews:function(){var a={},b=this,c=this.$(".kb-context-container");return _.each(c,function(c,d){var e=c.dataset.kbcontext,f=KB.Contexts.get(e);a[f.View.cid]=f.View,f.View.isVisible=!0,f.View.ColumnView=b,b.listenTo(f.View,"context.activated",b.activateColumn)}),a},activateColumn:function(){this.trigger("column.activate",this)},columnActivated:function(a){a.cid!==this.cid?_.each(this.ContextsViews,function(a){a.renderProxy()}):_.each(this.ContextsViews,function(a){a.removeProxy()})},reset:function(){_.each(this.ContextsViews,function(a){a.removeProxy()})}})},{}],3:[function(a,b,c){var d=a("templates/backend/context-bar.hbs"),e=a("backend/Views/ContextUi/ContextUiView"),f=a("backend/Views/ContextUi/ContextColumnView"),g=a("backend/Views/ContextUi/controls/ResetControl"),h=a("backend/Views/ContextUi/controls/ColumnControl");b.exports=Backbone.View.extend({initialize:function(){var a=this;this.columns=this.setupColumns(),this.layoutBackup=this.createLayoutBackup(),this.cols=_.toArray(this.columns).length,this.render(),jQuery(window).resize(function(){a.resetLayout()})},setupColumns:function(){var a=this,b=this.$(".kb-context-col");return _.map(b,function(b){var c=new f({el:b,Controller:a});return a.listenTo(c,"column.activate",a.evalLayout),c})},render:function(){var a=jQuery(d({}));this.$el.before(a),this.BarView=new e({el:a}),this.setupMenuItems()},setupMenuItems:function(){var a=this;this.BarView.addItem(new g({model:this.model,parent:this})),_.each(this.columns,function(b){a.BarView.addItem(new h({model:a.model,parent:a,ColumnView:b}))})},createLayoutBackup:function(){var a={};return _.each(this.columns,function(b,c){a[c]=b.$el.attr("class")}),a},resetLayout:function(){var a=this;_.each(this.columns,function(b){b.isVisible||b.Control["switch"](),b.$el.attr("class",a.layoutBackup[b.cid]),b.$el.width("")}),this.trigger("columns.reset")},evalLayout:function(a){var b=this.$el.width()-20*this.cols,c=this.findProportion(this.cols);return 1100>b?!1:(_.each(this.columns,function(d){d.cid===a.cid?d.$el.width(Math.floor(b*c.large)):d.$el.width(Math.floor(b*c.small))}),void this.trigger("columns.rendered",a))},renderLayout:function(){var a=_.filter(this.columns,function(a){return a.isVisible}),b=a.length,c=this.$el.width()-20*b;_.each(a,function(a){a.$el.width(Math.floor(c*(100/b/100)))})},findProportion:function(a){switch(a){case 3:return{small:.1,large:.8};case 2:return{small:.3333,large:.6666};default:return{small:1,large:1}}}})},{"backend/Views/ContextUi/ContextColumnView":2,"backend/Views/ContextUi/ContextUiView":4,"backend/Views/ContextUi/controls/ColumnControl":5,"backend/Views/ContextUi/controls/ResetControl":6,"templates/backend/context-bar.hbs":129}],4:[function(a,b,c){var d=a("backend/Views/ModuleControls/ControlsView");b.exports=d.extend({initialize:function(){this.$menuList=jQuery(".kb-context-bar--actions",this.$el)}})},{"backend/Views/ModuleControls/ControlsView":8}],5:[function(a,b,c){var d=a("backend/Views/BaseControlView");b.exports=d.extend({initialize:function(a){this.options=a||{},this.Controller=a.parent,this.ColumnView=a.ColumnView,this.ColumnView.Control=this},className:"context-visibility",events:{click:"switch"},render:function(){this.$el.append('<span class="kb-button-small">'+this.ColumnView.$el.data("kbcolname")+"</span>")},isValid:function(){return!0},"switch":function(){this.$el.toggleClass("kb-context-hidden"),this.ColumnView.$el.toggle(),this.ColumnView.isVisible=!this.ColumnView.isVisible,this.Controller.renderLayout()}})},{"backend/Views/BaseControlView":1}],6:[function(a,b,c){var d=a("backend/Views/BaseControlView");b.exports=d.extend({initialize:function(a){this.options=a||{},this.Controller=a.parent},className:"context-reset-layout",events:{click:"resetLayout"},render:function(){this.$el.append('<span class="kb-button-small">Reset</span>')},isValid:function(){return!0},resetLayout:function(){this.Controller.resetLayout()}})},{"backend/Views/BaseControlView":1}],7:[function(a,b,c){var d=a("templates/backend/fullscreen-inner.hbs"),e=a("common/TinyMCE"),f=a("common/UI");b.exports=Backbone.View.extend({className:"kb-fullscreen--holder",initialize:function(){return this.$parent=this.model.View.$el,this.$body=jQuery(".kb-module__body",this.$parent),this},events:{"click .kb-fullscreen-js-close":"close","change .kb-template-select":"viewfileChange"},viewfileChange:function(a){var b=this;this.model.View.viewfileChange(a),this.listenToOnce(this.model.View,"kb:backend::viewUpdated",function(){f.repaint(b.$body)})},open:function(){var a=this;e.removeEditors(),this.$backdrop=jQuery('<div class="kb-fullscreen-backdrop"></div>').appendTo("body"),this.$fswrap=jQuery(d()).appendTo(this.$el),this.$el.width(.7*jQuery(window).width()),jQuery("#wpwrap").addClass("module-browser-open"),this.$body.detach().appendTo(this.$fswrap.find(".kb-fullscreen--inner")).show().addClass("kb-module--fullscreen"),jQuery(window).resize(function(){a.$fswrap.width(.7*jQuery(window).width())}),this.$el.appendTo("body"),e.restoreEditors(),this.trigger("open"),this.reposition()},reposition:function(){var a=jQuery(window).scrollTop();this.$el.css("top",a+30+"px")},close:function(){e.removeEditors(),jQuery("#wpwrap").removeClass("module-browser-open"),this.$body.detach().appendTo(this.$parent),this.$backdrop.remove(),this.$fswrap.remove(),this.$el.detach(),jQuery(window).off("scroll",jQuery.proxy(this.reposition,this)),setTimeout(function(){e.restoreEditors()},250),this.trigger("close")}})},{"common/TinyMCE":18,"common/UI":19,"templates/backend/fullscreen-inner.hbs":130}],8:[function(a,b,c){var d=a("templates/backend/module-menu.hbs");b.exports=Backbone.View.extend({id:"",$menuWrap:{},$menuList:{},initialize:function(){this.$menuWrap=jQuery(".menu-wrap",this.$el),this.$menuWrap.append(d({})),this.$menuList=jQuery(".module-actions",this.$menuWrap)},addItem:function(a){if(this.controls=this.controls||{},a.isValid&&a.isValid()===!0){var b=jQuery("<li></li>").appendTo(this.$menuList),c=b.append(a.el);this.$menuList.append(c),a.render.call(a),this.controls[a.id]=a}},getView:function(a){return this.controls[a]?this.controls[a]:!1}})},{"templates/backend/module-menu.hbs":131}],9:[function(a,b,c){var d=a("common/Notice");b.exports={send:function(a,b,c,e){var f,g=e||{};f=a.postId?a.postId:KB.Environment&&KB.Environment.postId?KB.Environment.postId:!1;var h=_.extend({supplemental:a.supplemental||{},nonce:jQuery("#_kontentblocks_ajax_nonce").val(),post_id:f,postId:f,kbajax:!0},a);return jQuery("#publish").attr("disabled","disabled"),jQuery.ajax({url:ajaxurl,data:h,type:"POST",dataType:"json",success:function(a){a&&(c&&b?b.call(c,a,g):b&&b(a,g))},error:function(){d.notice("<p>Generic Ajax Error</p>","error")},complete:function(){jQuery("#publish").removeAttr("disabled")}})}}},{"common/Notice":14}],10:[function(a,b,c){var d=a("common/Config");b.exports={blockLimit:function(a){var b=a.get("limit"),c=jQuery("#"+a.get("id")+" li.kb-module").length;return!(0!==b&&c===b)},userCan:function(a){var b=jQuery.inArray(a,d.get("caps"));return-1!==b}}},{"common/Config":11}],11:[function(a,b,c){var d=function(a){var b=KB.appData.config||{};return{get:function(a){return a?b[a]?b[a]:null:b},getNonce:function(a){var c=["update","create","delete","read"];return-1!==_.indexOf(c,a)?b.nonces[a]:(console.error("Invalid nonce requested in kb.cm.Config.js"),null)},isAdmin:function(){return!b.frontend},inDevMode:function(){return b.env.dev},getRootURL:function(){return b.env.rootUrl},getFieldJsUrl:function(){return b.env.fieldJsUrl},getHash:function(){return b.env.hash},getLayoutMode:function(){return b.layoutMode||"default-boxes"}}}(jQuery);b.exports=d},{}],12:[function(a,b,c){var d=a("common/Utilities");b.exports={getString:function(a){return a&&KB&&KB.i18n?d.getIndex(KB.i18n,a):null}}},{"common/Utilities":20}],13:[function(a,b,c){var d=a("common/Config");Function.prototype.bind&&window.console&&"object"==typeof console.log&&["log","info","warn","error","assert","dir","clear","profile","profileEnd"].forEach(function(a){console[a]=this.bind(console[a],console)},Function.prototype.call),Logger.useDefaults();var e=Logger.get("_K"),f=Logger.get("_KS");e.setLevel(e.INFO),f.setLevel(f.INFO),d.inDevMode()||e.setLevel(Logger.OFF),Logger.setHandler(function(a,b){if(KB.Menubar&&2===b.level.value&&"_KS"===b.name)a[0]&&KB.Menubar.StatusBar.setMsg(a[0]);else{var c=window.console,d=c.log;b.name&&(a[0]="["+b.name+"] "+a[0]),b.level===Logger.WARN&&c.warn?d=c.warn:b.level===Logger.ERROR&&c.error?d=c.error:b.level===Logger.INFO&&c.info&&(d=c.info),d.apply(c,a)}}),b.exports={Debug:e,User:f}},{"common/Config":11}],14:[function(a,b,c){"use strict";b.exports={notice:function(a,b,c){var d=c||3;window.alertify.notify(a,b,d)},confirm:function(a,b,c,d,e){var f=a||"Title";window.alertify.confirm(f,b,function(){c.call(e)},function(){d.call(e)})},prompt:function(a,b,c,d,e,f){var g=a||"Title";window.alertify.prompt(g,b,c,function(){d.call(f)},function(){e.call(f)})}}},{}],15:[function(a,b,c){b.exports={getFieldData:function(a,b,c,d){var e;return this._typeExists(a)?(e=KB.payload.fieldData[a],e[b]?_.isEmpty(d)?e[b][c]?e[b][c]:[]:e[b][d]&&e[b][d][c]?e[b][d][c]:[]:[]):[]},_typeExists:function(a){return!_.isUndefined(KB.payload.fieldData[a])},getFieldArgs:function(a,b){return KB.payload.Fields&&KB.payload.Fields[a]?b&&KB.payload.Fields[a][b]?KB.payload.Fields[a][b]:KB.payload.Fields[a]:null},parseAdditionalJSON:function(a){var b;return b={Fields:[]},a&&a.Fields&&(b.Fields=KB.FieldControls.add(_.toArray(a.Fields))),b},getPayload:function(a){return KB&&KB.payload&&KB.payload[a]?KB.payload[a]:{}}}},{}],16:[function(a,b,c){function d(){this.items=[]}d.prototype.append=function(a){this.items.push(a)},d.prototype.prepend=function(a){this.items.unshift(a)},d.prototype.reset=function(){this.items=[]},d.prototype.length=function(){return this.items.length},d.prototype.hasItems=function(){return this.items.length>0},d.prototype.first=function(){return this.items.length>0?this.items.shift():null},d.prototype.last=function(){return this.items.length>0?this.items.pop():null},b.exports=d},{}],17:[function(a,b,c){var d=a("common/Config"),e=a("common/Utilities"),f=a("hbsfy/runtime"),g=function(){function a(a,b,g,h){var i,j;if(b=b||{},h=h||this,i=g||null,!c[a]){var k=d.getRootURL()+"js/templates",l=k+"/"+a+".hbs?"+d.getHash(),m=/^https?:\/\//i;m.test(a)&&(l=a),e.stex.get(l)?(j=e.stex.get(l),i&&i.call(h)):jQuery.ajax({url:l,method:"GET",async:!1,success:function(a){j=a,e.stex.set(l,j,12e4),i&&i.call(h)}}),c[a]=f.compile(j)}return c[a](b)}function b(a){if(!g[a]){var b;jQuery.ajax({url:a,method:"GET",async:!1,dataType:"html",success:function(a){b=a}}),g[a]=a}return g[a]}var c={},g={};return{render:a,helpfile:b}}();b.exports=g},{"common/Config":11,"common/Utilities":20,"hbsfy/runtime":199}],18:[function(a,b,c){var d=a("common/Ajax"),e=a("common/Logger"),f=a("common/Config");b.exports={removeEditors:function(a){a||(a=jQuery("body")),jQuery(".wp-editor-area",a).each(function(){if("wp-content-wrap"===jQuery(this).attr("id")||"ghosteditor"===jQuery(this).attr("id"));else{var a=this.id;tinyMCE.execCommand("mceRemoveEditor",!0,a)}})},restoreEditors:function(a){a||(a=jQuery("body")),jQuery(".wp-editor-wrap",a).each(function(){var a=jQuery(this).find("textarea").attr("id"),b=jQuery(this).find("textarea");"ghosteditor"!==a&&(b.val(switchEditors.wpautop(b.val())),tinyMCE.execCommand("mceAddEditor",!0,a),switchEditors.go(a,"tmce"))})},addEditor:function(a,b,c,d){if(!a)return e.Debug.error("No scope element ($el) provided"),!1;if(_.isUndefined(tinyMCEPreInit))return!1;var f=c||350,g=_.isUndefined(d)?!0:!1;jQuery(".wp-editor-area",a).each(function(){var a=this.id,b=window.tinyMCE.get(a);b&&tinyMCE.execCommand("mceRemoveEditor",null,a);var c=tinyMCEPreInit&&tinyMCEPreInit.mceInit&&tinyMCEPreInit.mceInit.ghosteditor?"ghosteditor":"content",d=_.clone(tinyMCEPreInit.mceInit[c]);d.elements=a,d.selector="#"+a,d.id=a,d.kblive=g,d.height=f,d.remove_linebreaks=!1,d.setup=function(a){a.on("init",function(){KB.Events.trigger("KB::tinymce.new-editor",a)}),a.on("change",function(){})},tinymce.init(d),tinyMCEPreInit.mceInit[a]||(tinyMCEPreInit.mceInit[a]=d);var e={buttons:"",disabled_buttons:"",id:a};window.quicktags(e)}),setTimeout(function(){jQuery(".wp-editor-wrap",a).removeClass("html-active").addClass("tmce-active"),window.QTags._buttonsInit()},1500)},remoteGetEditor:function(a,b,c,g,h,i,j){var k=h||KB.appData.config.post.ID,c=c||a.attr("id");if(!i)var i=!1;var l=g||"";return d.send({action:"getRemoteEditor",editorId:c+"_ed",editorName:b,post_id:k,postId:k,editorContent:l,_ajax_nonce:f.getNonce("read"),args:{media_buttons:i}},function(b){b.success?(a.empty().append(b.data.html),this.addEditor(a,null,250,j)):e.Debug.info("Editor markup could not be retrieved from the server")},this)}}},{"common/Ajax":9,"common/Config":11,"common/Logger":13}],19:[function(a,b,c){var d=jQuery,e=a("common/Config"),f=a("common/Ajax"),g=a("common/TinyMCE"),h=a("common/Notice"),i=a("backend/Views/ContextUi/ContextRowGrid"),j={isSorting:!1,init:function(){var a=this,b=d("body");this.initTabs(),this.initSortable(),this.initSortableAreas(),this.initToggleBoxes(),this.flexContext(),this.flushLocalStorage(),this.initTipsy(),b.on("mousedown",".kb-field",function(a){activeField=this}),b.on("mousedown",".kb-module",function(a){activeBlock=this.id}),b.on("mouseenter","[data-kbfield]",function(){KB.currentFieldId=this.id}),b.on("mouseenter",".kb-area__list-item li",function(){KB.currentModuleId=this.id}),jQuery(document).ajaxComplete(function(b,c,d){a.metaBoxReorder(b,c,d,"restore")}),jQuery(document).ajaxSend(function(b,c,d){a.metaBoxReorder(b,c,d,"remove")})},flexContext:function(){jQuery(".kb-context-row").each(function(a,b){var c=jQuery(b);c.data("KB.ContextRow",new i({el:b}))})},repaint:function(a){this.initTabs(a),this.initToggleBoxes(),g.addEditor(a)},initTabs:function(a){var b=a||jQuery("body"),c=d(".kb-field--tabs",b);c.tabs({activate:function(a,b){d(".kb-nano").nanoScroller({contentClass:"kb-nano-content"}),KB.Events.trigger("modal.recalibrate")}}),c.each(function(){var a=d(".ui-tabs-nav li",d(this)).length;1===a&&d(this).find(".ui-tabs-nav").css("display","none")})},initToggleBoxes:function(){d(".kb-togglebox-header").on("click",function(){d(this).next("div").slideToggle()}),d(".kb_fieldtoggles div:first-child").trigger("click")},initSortable:function(a){function b(){var a=i.get("limit"),b=c(i.get("id"));return-1===_.indexOf(i.get("assignedModules"),f.get("settings")["class"])?!1:0!==a&&b-1>=a?(h.notice("Not allowed here","error"),!1):!0}function c(a){return d("#"+a+" li.kb-module").length}var f,i,j=a||jQuery("body"),k=this,l="parent";"default-tabs"===e.getLayoutMode()&&(l="#kb-contexts-tabs"),d(".kb-module-ui__sortable",j).sortable({placeholder:"ui-state-highlight",ghost:!0,connectWith:".kb-module-ui__sortable--connect",helper:"clone",handle:".kb-move",cancel:"li.disabled, li.cantsort",tolerance:"pointer",delay:150,revert:350,appendTo:l,start:function(a,b){k.isSorting=!0,d("body").addClass("kb-is-sorting"),f=KB.Modules.get(b.item.attr("id")),i=KB.currentArea,d(KB).trigger("kb:sortable::start"),d(".kb-open").toggleClass("kb-open"),d(".kb-module__body").hide(),g.removeEditors(),d(document).trigger("kb_sortable_start",[a,b])},stop:function(a,b){k.isSorting=!1,d("body").removeClass("kb-is-sorting"),g.restoreEditors(),d(document).trigger("kb_sortable_stop",[a,b]),f.get("open")&&f.View.toggleBody(155)},over:function(a,b){i=KB.Areas.get(this.id)},receive:function(a,c){b()||(h.notice("Module not allowed in this area","error"),d(c.sender).sortable("cancel"))},update:function(a,c){if(!b())return!1;if(this!==c.item.parent("ul")[0]||c.sender){if(c.sender){if(c.item.parent("ul")[0].id===c.sender.attr("id"))return!1;d.when(k.changeArea(i,f)).then(function(a){return a.success?void k.resort(c.sender):!1}).done(function(){k.triggerAreaChange(i,f),d(KB).trigger("kb:sortable::update"),f.View.clearFields(),h.notice("Area change and order were updated successfully","success")})}}else d.when(k.resort(c.sender)).done(function(a){return a.success?(d(KB).trigger("kb:sortable::update"),void h.notice(a.message,"success")):(h.notice(a.message,"error"),!1)})}}).disableSelection()},flushLocalStorage:function(){var a=e.get("env").hash;store.get("kbhash")!==a&&(store.clear(),store.set("kbhash",a))},resort:function(a){var b={};return d(".kb-module-ui__sortable").each(function(){b[this.id]=d("#"+this.id).sortable("serialize",{attribute:"rel"})}),f.send({action:"resortModules",data:b,_ajax_nonce:e.getNonce("update")})},changeArea:function(a,b){return f.send({action:"changeArea",_ajax_nonce:e.getNonce("update"),mid:b.get("mid"),area_id:a.get("id"),context:a.get("context")})},triggerAreaChange:function(a,b){b.unsubscribeFromArea(),b.setArea(a)},toggleModule:function(){d("body").on("click",".kb-toggle",function(){KB.isLocked()&&!KB.userCan("lock_kontentblocks")?h.notice(kontentblocks.l18n.gen_no_permission,"alert"):(d(this).parent().nextAll(".kb-module__body:first").slideToggle("fast",function(){d("body").trigger("module::opened")}),d("#"+activeBlock).toggleClass("kb-open",1e3))})},initSortableAreas:function(){jQuery(".kb-context__inner").sortable({items:".kb-area__wrap",handle:".kb-area-move-handle",start:function(a,b){g.removeEditors()},stop:function(a,b){var c=jQuery("#post").serializeJSON(),d=c.kbcontext;d&&f.send({action:"updateContextAreaOrder",_ajax_nonce:e.getNonce("update"),data:d},function(a){a.success?h.notice(a.message,"success"):h.notice(a.message,"error"),g.restoreEditors()},this)}})},initTipsy:function(){jQuery("body").on("mouseenter","[data-kbtooltip]",function(a){jQuery(this).qtip({content:{attr:"data-kbtooltip"},style:"qtip-dark qtip-shadow",show:{event:a.type,effect:!0,delay:180,solo:!0,ready:!0}})})},metaBoxReorder:function(a,b,c,e){if(c.data){var f=c.data,h=f.split("&"),i={};d.each(h,function(a,b){var c=b.split("=");i[c[0]]=c[1]}),"meta-box-order"===i.action&&("restore"===e?g.restoreEditors():"remove"===e&&g.removeEditors())}}};b.exports=j},{"backend/Views/ContextUi/ContextRowGrid":3,"common/Ajax":9,"common/Config":11,"common/Notice":14,"common/TinyMCE":18}],20:[function(a,b,c){var d=function(a){return{stex:{set:function(a,b,c){store.set(a,{val:b,exp:c,time:(new Date).getTime()})},get:function(a){var b=store.get(a);return b?(new Date).getTime()-b.time>b.exp?null:b.val:null}},store:{set:function(a,b){store.set(a,b)},get:function(a){return store.get(a)}},setIndex:function(a,b,c){return _.isObject(a)||(a={}),"string"==typeof b?this.setIndex(a,b.split("."),c):1==b.length&&void 0!==c?a[b[0]]=c:0==b.length?a:this.setIndex(a[b[0]],b.slice(1),c)},getIndex:function(a,b){b=b.replace(/\[(\w+)\]/g,".$1"),b=b.replace(/^\./,"");for(var c=b.split(".");c.length;){var d=c.shift();if(!(_.isObject(a)&&d in a))return{};a=a[d]}return a},hashString:function(a){var b,c,d,e=0;if(0==a)return e;for(b=0,d=a.length;d>b;b++)c=a.charCodeAt(b),e=(e<<5)-e+c,e|=0;return Math.abs(e)},sleep:function(a){for(var b=(new Date).getTime(),c=0;1e7>c&&!((new Date).getTime()-b>a);c++);}}}(jQuery);b.exports=d},{}],21:[function(a,b,c){b.exports=Backbone.View.extend({rerender:function(){this.render()},gone:function(){this.trigger("field.view.gone",this),this.derender()},toString:function(){return""}})},{}],22:[function(a,b,c){var d=a("common/Checks"),e=a("common/Utilities"),f=a("common/Payload"),g=a("common/Config"),h=a("common/Logger");b.exports=Backbone.Model.extend({idAttribute:"uid",initialize:function(){this.cleanUp();var a=this.get("fieldId");a&&(this.ModuleModel=KB.ObjectProxy.get(a))&&this.getType()&&(this.set("ModuleModel",this.ModuleModel),this.setData(),this.bindHandlers(),this.setupType(),this.ModuleModel.attachField(this))},cleanUp:function(){var a=this.get("linkedFields")||{};a.hasOwnProperty(this.get("uid"))&&delete a[this.get("uid")]},bindHandlers:function(){this.listenTo(this,"field.model.settings",this.updateLinkedFields),this.listenToOnce(this.ModuleModel,"remove",this.remove),this.listenTo(this.ModuleModel,"change:entityData",this.setData),this.listenTo(this.ModuleModel,"module.model.updated",this.getClean),this.listenTo(this,"change:value",this.upstreamData),this.listenTo(this.ModuleModel,"modal.serialize.before",this.unbind),this.listenTo(this.ModuleModel,"modal.serialize",this.rebind),this.listenTo(this.ModuleModel,"change:area",this.unbind),this.listenTo(this.ModuleModel,"after.change.area",this.rebind)},setupType:function(){var a;(a=this.getType())&&(this.FieldControlView=new a({el:this.getElement(),model:this}))},updateLinkedFields:function(a){a.linkedFields&&(this.set("linkedFields",a.linkedFields),this.cleanUp())},getElement:function(){return jQuery('*[data-kbfuid="'+this.get("uid")+'"]')[0]},getType:function(){var a=this.get("type");if(!d.userCan("edit_kontentblocks"))return!1;var b=KB.Fields.get(a);return b&&b.prototype.hasOwnProperty("initialize")?b:!1},getClean:function(){this.trigger("field.model.clean",this)},setData:function(a){var b,c,d,g,h,i={};b=a||this.get("ModuleModel"),c=f.getPayload("fieldData"),c[this.get("type")]&&(d=c[this.get("type")],d[this.get("fieldId")]&&(g=d[this.get("fieldId")],i=e.getIndex(g,this.get("kpath")))),h=e.getIndex(b.get("entityData"),this.get("kpath")),this.set("value",_.extend(h,i))},upstreamData:function(){var a;if(a=this.get("ModuleModel")){var b=_.clone(this.get("ModuleModel").get("entityData"));e.setIndex(b,this.get("kpath"),this.get("value")),a.set("entityData",b,{silent:!1}),a.View.getDirty()}},externalUpdate:function(a){this.FieldControlView.synchronize(a)},remove:function(){this.stopListening(),KB.FieldControls.remove(this)},rebind:function(){var a=this;_.defer(function(){_.isUndefined(a.getElement())?_.defer(_.bind(a.FieldControlView.gone,a.FieldControlView)):a.FieldControlView&&(a.FieldControlView.setElement(a.getElement()),_.defer(_.bind(a.FieldControlView.rerender,a.FieldControlView)))},!0)},unbind:function(){this.FieldControlView&&this.FieldControlView.derender&&this.FieldControlView.derender()},sync:function(a){var b=this;KB.Events.trigger("field.before.sync",this.model);var c=b.toJSON(),d=c.ModuleModel.type,e=c.ModuleModel.toJSON();return delete c.ModuleModel,delete c.linkedFields,jQuery.ajax({url:ajaxurl,data:{action:"updateFieldModel",data:b.get("value"),field:c,module:e,type:d,_ajax_nonce:g.getNonce("update")},context:a?a:b,type:"POST",dataType:"json",success:function(a){b.trigger("field.model.updated",b)},error:function(){h.Debug.error("serialize | FrontendModal | Ajax error")}})}})},{"common/Checks":10,"common/Config":11,"common/Logger":13,"common/Payload":15,"common/Utilities":20}],23:[function(a,b,c){var d=a("./FieldControlModel");b.exports=d.extend({bindHandlers:function(){this.listenToOnce(this.ModuleModel,"remove",this.remove),this.listenTo(this.ModuleModel,"change:entityData",this.setData),this.listenTo(KB.Events,"modal.reload",this.rebind),this.listenTo(KB.Events,"modal.close",this.remove)},rebind:function(){this.FieldControlView&&(this.FieldControlView.setElement(this.getElement()),this.FieldControlView.rerender())},getElement:function(){return jQuery('*[data-kbfuid="'+this.get("uid")+'"]')}})},{"./FieldControlModel":22}],24:[function(a,b,c){var d=a("./FieldControlModel");b.exports=Backbone.Collection.extend({initialize:function(){this._byModule={},this._byArea={},this._linkedFields=[],this.listenTo(this,"add",this.addToModules),this.listenTo(this,"add",this.bindLinkedFields)},model:d,addToModules:function(a){if(a.ModuleModel){var b=a.ModuleModel.id;if(this._byModule[b]||(this._byModule[b]={}),a.ModuleModel.Area){var c=a.ModuleModel.Area.id;this._byArea[c]||(this._byArea[c]={}),this._byArea[c][a.id]=a}this._byModule[b][a.id]=a}},getFieldsforModule:function(a){return this._byModule[a]?this._byModule[a]:{}},bindLinkedFields:function(a){var b=a.get("linkedFields");_.each(b,function(c,d){if(_.isNull(c)){var e=this.get(d);e&&(b[d]=e,a.listenTo(e,"external.change",a.externalUpdate),this.bindLinkedFields(e))}},this)},updateModels:function(a){a&&_.each(a,function(a){var b=this.get(a.uid);b?b.trigger("field.model.settings",a):this.add(a)},this)}})},{"./FieldControlModel":22}],25:[function(a,b,c){var d={};a("common/Logger");_.extend(d,Backbone.Events),_.extend(d,{fields:{},registerObject:function(a,b){_.extend(b,Backbone.Events),this.fields[a]=b},get:function(a){return this.fields[a]?this.fields[a]:null}}),b.exports=d},{"common/Logger":13}],26:[function(a,b,c){var d=a("./Fields");window.KB.Fields=d,d.registerObject("color",a("./controls/color")),d.registerObject("datetime",a("./controls/datetime")),d.registerObject("file",a("./controls/file")),d.registerObject("flexfields",a("./controls/flexfields")),d.registerObject("gallery",a("./controls/gallery")),d.registerObject("gallery2",a("./controls/gallery2")),d.registerObject("image",a("./controls/image")),d.registerObject("cropimage",a("./controls/cropimage")),d.registerObject("link",a("./controls/link")),d.registerObject("textarea",a("./controls/textarea")),d.registerObject("text",a("./controls/text")),d.registerObject("text-multiple",a("./controls/text-multiple")),d.registerObject("tagsinput",a("./controls/tagsinput")),d.registerObject("multiselect",a("./controls/multiselect")),d.registerObject("select",a("./controls/select")),d.registerObject("editor",a("./controls/editor")),d.registerObject("otimes",a("./controls/otimes")),d.registerObject("oembed",a("./controls/oembed")),d.registerObject("mlayout",a("./controls/mlayout")),d.registerObject("medium",a("./controls/medium")),d.registerObject("imageselect",a("./controls/imageselect"))},{"./Fields":25,"./controls/color":27,"./controls/cropimage":28,"./controls/datetime":29,"./controls/editor":30,"./controls/file":31,"./controls/flexfields":32,"./controls/gallery":38,"./controls/gallery2":41,"./controls/image":44,"./controls/imageselect":45,"./controls/link":46,"./controls/medium":47,"./controls/mlayout":48,"./controls/multiselect":55,"./controls/oembed":56,"./controls/otimes":57,"./controls/select":58,"./controls/tagsinput":59,"./controls/text":62,"./controls/text-multiple":60,"./controls/textarea":63}],27:[function(a,b,c){var d=a("../FieldControlBaseView");b.exports=d.extend({initialize:function(){this.render()},events:{"mouseup .kb-field--color":"recalibrate"},render:function(){this.$(".kb-color-picker").wpColorPicker({}),jQuery("body").on("click.wpcolorpicker",this.update)},derender:function(){jQuery("body").off("click.wpcolorpicker",this.update)},update:function(){},recalibrate:function(){_.delay(function(){KB.Events.trigger("modal.recalibrate")},150)}})},{"../FieldControlBaseView":21}],28:[function(a,b,c){var d=a("../FieldControlBaseView"),e=a("common/Utilities"),f=a("common/Config");b.exports=d.extend({initialize:function(){this.render()},events:{"click .kb-js-add-image":"openFrame","click .kb-js-reset-image":"resetImage"},render:function(){this.$reset=this.$(".kb-js-reset-image"),this.$container=this.$(".kb-field-image-container"),this.$saveId=this.$(".kb-js-image-id"),this.$description=this.$(".kb-js-image-description"),this.$title=this.$(".kb-js-image-title")},editImage:function(){this.openFrame(!0)},derender:function(){this.frame&&this.frame.dispose()},openFrame:function(a){var b,c,d=this;this.frame&&this.frame.dispose();var e={};""!==this.model.get("value").id&&(e.post__in=[this.model.get("value").id]),wp.media.query(e).more().done(function(){var a=this.first();d.attachment=a,a?(a.set("attachment_id",a.get("id")),b=d.attachment.toJSON()):b={},c={cropOptions:{maxWidth:d.model.get("width")||300,maxHeight:d.model.get("height")||300},croppedCallback:d.handleAttachment,parentController:d,library:{type:"image",cache:!1}},d.model.get("uploadedTo")===!0&&(c.library.uploadedTo=KB.Environment.postId||0),d.frame=new wp.media.view.KBCropperFrame(c).on("update",function(a){d.update(a)}).on("close",function(a){d.frame.image&&d.frame.image.attachment&&(d.$description.val(d.frame.image.attachment.get("caption")),d.$title.val(d.frame.image.attachment.get("title")))}).on("ready",function(){d.ready()}).on("replace",function(){}).on("select",function(a){}).on("cropped",function(a){}).open()})},ready:function(){jQuery(".media-modal").addClass("smaller kb-image-frame")},replace:function(a){this.attachment=a,this.handleAttachment(a)},update:function(a){this.attachment.set(a),this.attachment.sync("update",this.attachment)},prepareArgs:function(){var a=this;return{width:a.model.get("previewWidth")||null,height:a.model.get("previewHeight")||null,crop:!0,upscale:a.model.get("upscale")||!1}},handleAttachment:function(a){var b=this,c=a.get("id"),d=this.prepareValue(a),f=_.clone(this.model.get("ModuleModel").get("entityData")),g=this.model.get("kpath");e.setIndex(f,g,d),this.model.get("ModuleModel").set("entityData",f);var h=this.model.get("previewWidth"),i=this.model.get("previewHeight");if(h&&i){var j=b.prepareArgs();b.retrieveImage(j,c)}else{var k=a.get("sizes").full.url;b.$container.html('<img src="'+k+' " >')}this.$saveId.val(a.get("id")),this.$description.val(a.get("caption")),this.$title.val(a.get("title")),this.model.get("ModuleModel").trigger("data.updated")},retrieveImage:function(a,b){var c=this;jQuery.ajax({url:ajaxurl,data:{action:"fieldGetImage",args:a,id:b,_ajax_nonce:f.getNonce("read")},type:"POST",dataType:"json",success:function(a){c.$container.html('<img src="'+a.data.src+'" >')},error:function(){}})},prepareValue:function(a){var b={id:a.get("id"),title:a.get("title"),caption:a.get("caption"),alt:a.get("alt")},c=this.model.get("value");return _.defaults(c,b)},resetImage:function(){this.$container.html(""),this.$saveId.val(""),this.model.set("value",{id:null,caption:"",title:""}),this.$description.val(""),this.$title.val("")},toString:function(){if(this.attachment){var a=this.attachment.get("sizes").thumbnail?this.attachment.get("sizes").thumbnail:this.attachment.get("sizes").full;return"<img src='"+a.url+"'>"}return""}})},{"../FieldControlBaseView":21,"common/Config":11,"common/Utilities":20}],29:[function(a,b,c){var d=a("../FieldControlBaseView");b.exports=d.extend({initialize:function(){var a=this;this.defaults={format:"d.m.Y H:i",inline:!1,mask:!0,lang:"de",allowBlank:!0,onChangeDateTime:function(b,c){a.$unixIn.val(b.dateFormat("unixtime")),a.$sqlIn.val(b.dateFormat("Y-m-d H:i:s"))}},this.settings=this.model.get("settings")||{},this.render()},render:function(){this.$unixIn=this.$(".kb-datetimepicker--js-unix"),this.$sqlIn=this.$(".kb-datetimepicker--js-sql"),this.$(".kb-datetimepicker").datetimepicker(_.extend(this.defaults,this.settings))},derender:function(){this.$(".kb-datetimepicker").datetimepicker("destroy")}})},{"../FieldControlBaseView":21}],30:[function(a,b,c){var d=a("../FieldControlBaseView");a("common/TinyMCE");b.exports=d.extend({initialize:function(){this.render()},render:function(){var a=this;this.$textarea=this.$("textarea"),tinymce.on("AddEditor",function(b){var c=b.editor;c&&c.id===a.$textarea.attr("id")&&!a.editor&&(a.editor=c,c.on("change",function(){a.update(c.getContent())}))})},derender:function(){this.stopListening(),this.editor=null},update:function(a){this.model.set("value",a)},toString:function(){return this.editor?this.editor.getContent():"";
}})},{"../FieldControlBaseView":21,"common/TinyMCE":18}],31:[function(a,b,c){var d=a("../FieldControlBaseView");b.exports=d.extend({initialize:function(){this.render()},events:{"click .kb-js-add-file":"openFrame","click .kb-js-reset-file":"reset"},render:function(){this.$container=this.$(".kb-field-file-wrapper"),this.$IdIn=this.$(".kb-file-attachment-id"),this.$resetIn=this.$(".kb-js-reset-file")},derender:function(){this.frame&&(this.frame.dispose(),this.frame=null)},openFrame:function(){var a=this;return this.frame?this.frame.open():(this.frame=wp.media({title:KB.i18n.Refields.file.modalTitle,button:{text:KB.i18n.Refields.common.select},multiple:!1,library:{type:""}}),this.frame.on("ready",function(){a.ready(this)}),this.frame.state("library").on("select",function(){a.select(this)}),this.frame.open())},ready:function(a){this.$(".media-modal").addClass(" smaller no-sidebar")},select:function(a){var b=a.get("selection").first();this.handleAttachment(b)},handleAttachment:function(a){this.$(".kb-file-filename",this.$container).html(a.get("filename")),this.$(".kb-file-attachment-id",this.$container).val(a.get("id")),this.$(".kb-file-title",this.$container).html(a.get("title")),this.$(".kb-file-id",this.$container).html(a.get("id")),this.$(".kb-file-editLink",this.$container).attr("href",a.get("editLink")),this.$resetIn.show(),this.$container.show(450,function(){KB.Events.trigger("modal.recalibrate")})},reset:function(){this.$IdIn.val(""),this.$container.hide(450),this.$resetIn.hide()}})},{"../FieldControlBaseView":21}],32:[function(a,b,c){var d=a("../FieldControlBaseView"),e=a("fields/controls/flexfields/FlexfieldsController");b.exports=d.extend({initialize:function(){this.createController(),this.render()},render:function(){var a=this;this.$stage=this.$(".flexible-fields--stage"),this.FlexFieldsController.setElement(this.$stage.get(0)),_.defer(function(){a.FlexFieldsController.render()})},derender:function(){this.FlexFieldsController.derender()},rerender:function(){this.render()},createController:function(){return this.FlexFieldsController?void 0:this.FlexFieldsController=new e({el:this.$(".flexible-fields2--stage"),model:this.model,parentView:this})}})},{"../FieldControlBaseView":21,"fields/controls/flexfields/FlexfieldsController":35}],33:[function(a,b,c){var d=a("fields/FieldControlModelModal");b.exports=Backbone.Collection.extend({model:d})},{"fields/FieldControlModelModal":23}],34:[function(a,b,c){b.exports=Backbone.View.extend({initialize:function(a){this.controller=a.controller,this.sections=this.model.get("fields")},factorNewItem:function(a,b,c){var d=b||_.uniqueId("ff2"),e=this.model.get("newitemtext")||"Enter a title : ";c=c||prompt(e,"");var f=_.clone(this.sections);return _.each(f,function(b){_.each(b.fields,function(b){var c=a&&a[b.key]?a[b.key]:b.std,e=_.extend(b,{value:c||"",arrayKey:this.model.get("arrayKey"),fieldkey:this.model.get("fieldkey"),primeKey:b.key,fieldId:this.model.get("fieldId"),index:d,type:b.type});b.view=KB.FieldsAPI.getRefByType(b.type,e)},this)},this),{itemId:d,title:c,sections:f}}})},{}],35:[function(a,b,c){var d=a("fields/controls/flexfields/ToggleBoxItem"),e=a("fields/controls/flexfields/SectionBoxItem"),f=a("fields/controls/flexfields/FlexFieldsFactory"),g=a("common/TinyMCE"),h=a("common/UI"),i=a("common/Logger"),j=a("fields/controls/flexfields/FlexFieldsCollection"),k=a("templates/fields/FlexibleFields/skeleton.hbs"),l=a("common/I18n");b.exports=Backbone.View.extend({initialize:function(a){this.parentView=a.parentView,this.active=!1,this.Renderer="sections"==this.model.get("renderer")?e:d,this.Fields=new j,this.subviews=[],this.factory=new f({controller:this,model:this.model}),i.Debug.log("Fields: Flexfields2 instance created and initialized")},events:{"click .kb-flexible-fields--js-add-item":"addItem"},initialSetup:function(){var a;a=this.model.get("value"),_.isEmpty(a)||_.each(a,function(b,c){if(b){var d=this.factory.factorNewItem(a[b._meta.uid],b._meta.uid,b._meta.title),e=new this.Renderer({controller:this,model:new Backbone.Model(d)});this.subviews.push(e),this.$list.append(e.render()),h.initTabs(),KB.Events.trigger("modal.recalibrate")}},this),h.initTabs(),this.$list.sortable({handle:".flexible-fields--js-drag-handle",start:function(){g.removeEditors()},stop:function(){g.restoreEditors()}}),KB.Events.trigger("modal.recalibrate"),this._initialized=!0},render:function(){return this.active?null:(this.$el.append(k({i18n:l.getString("Refields.flexfields")})),this.setupElements(),this.initialSetup(),void(this.active=!0))},derender:function(){this.trigger("derender"),this.subviews=[],this.active=!1},setupElements:function(){this.$list=this.$(".flexible-fields--item-list"),this.$addButton=this.$(".kb-flexible-fields--js-add-item")},addItem:function(){var a=this.factory.factorNewItem(),b=new this.Renderer({controller:this,model:new Backbone.Model(a)});this.subviews.push(b),this.$list.append(b.render()),h.initTabs(),KB.Events.trigger("modal.recalibrate")}})},{"common/I18n":12,"common/Logger":13,"common/TinyMCE":18,"common/UI":19,"fields/controls/flexfields/FlexFieldsCollection":33,"fields/controls/flexfields/FlexFieldsFactory":34,"fields/controls/flexfields/SectionBoxItem":36,"fields/controls/flexfields/ToggleBoxItem":37,"templates/fields/FlexibleFields/skeleton.hbs":141}],36:[function(a,b,c){var d=a("fields/controls/flexfields/ToggleBoxItem"),e=a("templates/fields/FlexibleFields/single-section-box.hbs");b.exports=d.extend({render:function(){var a=this.createInputName(this.model.get("itemId")),b=this.model.toJSON(),c=this.$el.append(e({item:b,inputName:a,uid:this.model.get("itemId")}));return this.renderTabs(c),c}})},{"fields/controls/flexfields/ToggleBoxItem":37,"templates/fields/FlexibleFields/single-section-box.hbs":139}],37:[function(a,b,c){var d=a("common/Notice"),e=a("templates/fields/FlexibleFields/single-toggle-box.hbs"),f=a("handlebars"),g=a("common/TinyMCE");b.exports=Backbone.View.extend({tagName:"li",className:"kb-flexible-fields--item-wrapper",initialize:function(a){this.Controller=a.controller,this.listenTo(this.Controller,"derender",this.derender),this.FieldViews={}},events:{"click .flexible-fields--js-toggle":"toggleItem","click .flexible-fields--js-trash":"deleteItem"},toggleItem:function(){this.$(".flexible-fields--toggle-title").next().slideToggle(250,function(){jQuery(this).toggleClass("kb-togglebox-open"),jQuery(this).hasClass("kb-togglebox-open")&&(g.removeEditors(jQuery(this)),g.restoreEditors(jQuery(this))),KB.Events.trigger("modal.recalibrate")})},deleteItem:function(){this.$el.hide(250);var a=this.createInputName(this.model.get("itemId"));this.$el.append('<input type="hidden" name="'+a+'[_meta][delete]" value="'+this.model.get("itemId")+'" >'),d.notice("Please click update to save the changes","success")},render:function(){var a=this.createInputName(this.model.get("itemId")),b=this.model.toJSON(),c=this.$el.append(e({item:b,inputName:a,uid:this.model.get("itemId")}));return this.renderTabs(c),c},renderTabs:function(a){var b=this,c=f.compile("<li><a href='#tab-{{ uid }}-{{ index }}'>{{ section.label }}</a></li>"),d=f.compile("<div id='tab-{{ uid }}-{{ index }}'></div>");_.each(this.model.get("sections"),function(e,f){jQuery(".flexible-field--tab-nav",a).append(c({uid:b.model.get("itemId"),section:e,index:f}));var g=jQuery(".kb-field--tabs",a),h=jQuery(d({uid:b.model.get("itemId"),index:f})).appendTo(g);b.renderFields(e,h)})},renderFields:function(a,b){var c,d;_.each(a.fields,function(a){var e=f.compile("<div class='kb-field-wrapper' data-kbfuid='{{ kbfuid }}' id='{{ kbfuid }}'></div>");c=a.view,d=this.model.get("value"),c.listenTo(this,"derender",c.derender);var g=jQuery(e({kbfuid:c.model.get("uid")}));g.append(c.render()),b.append(g),this.setupFieldInstance(c,b)},this)},createInputName:function(a){return this.createBaseId()+"["+this.Controller.model.get("fieldkey")+"]["+a+"]"},createBaseId:function(){return _.isEmpty(this.Controller.model.get("arrayKey"))?this.Controller.model.get("fieldId"):this.Controller.model.get("fieldId")+"["+this.Controller.model.get("arrayKey")+"]"},derender:function(){this.stopListening(),this.remove()},setupFieldInstance:function(a,b){var c=this;_.defer(function(){a.setElement(b),a.postRender&&a.postRender.call(a),c.Controller.parentView&&_.defer(function(){var b=c.Controller.Fields.findWhere({uid:a.model.get("uid")});if(_.isUndefined(b)){var d=c.Controller.Fields.add(a.model.toJSON());a.fieldModel=d}else b.rebind()})})}})},{"common/Notice":14,"common/TinyMCE":18,handlebars:186,"templates/fields/FlexibleFields/single-toggle-box.hbs":140}],38:[function(a,b,c){var d=a("fields/FieldControlBaseView"),e=a("./gallery/GalleryController");b.exports=d.extend({initialize:function(){this.render()},render:function(){this.$stage=this.$(".kb-gallery--stage"),this.createController()},derender:function(){this.GalleryController.dispose()},rerender:function(){this.derender(),this.render()},createController:function(){return this.GalleryController?(this.GalleryController.setElement(this.$stage.get(0)),this.GalleryController.render()):this.GalleryController=new e({el:this.$stage.get(0),model:this.model})}})},{"./gallery/GalleryController":39,"fields/FieldControlBaseView":21}],39:[function(a,b,c){var d=a("common/Logger"),e=a("./ImageView");b.exports=Backbone.View.extend({initialize:function(a){this._frame=null,this.subviews=[],this.listenTo(KB.Events,"modal.saved",this.frontendSave),this.setupElements(),this.initialSetup(),d.Debug.log("Fields: Gallery instance created and initialized")},events:{"click .kb-gallery--js-add-images":"addImages"},setupElements:function(){this.$list=jQuery('<div class="kb-gallery--item-list"></div>').appendTo(this.$el),this.$list.sortable({revert:!0,delay:300}),this.$addButton=jQuery('<a class="button button-primary kb-gallery--js-add-images">'+KB.i18n.Refields.image.addButton+"</a>").appendTo(this.$el)},addImages:function(){this.openModal()},frame:function(){return this._frame?this._frame:void 0},openModal:function(){var a=this;return this._frame?void this._frame.open():(this._frame=wp.media({title:KB.i18n.Refields.image.modalHelpTitle,button:{text:KB.i18n.Refields.common.select},multiple:!0,library:{type:"image"}}),this._frame.state("library").on("select",function(){a.select(this)}),this._frame.open(),this._frame)},select:function(a){var b=a.get("selection");b.length>0&&this.handleModalSelection(b.models)},handleModalSelection:function(a){var b=this;_.each(a,function(a){var c={file:a.toJSON(),details:{title:"",alt:"",description:""},id:a.get("id")},d=new Backbone.Model(c),f=new e({model:d,Controller:b});b.subviews.push(f),b.$list.append(f.render()),setTimeout(function(){KB.Events.trigger("modal.recalibrate")},250)})},initialSetup:function(){var a=this,b=this.model.get("value").images||{};_.toArray(b).length>0&&_.each(b,function(b){var c=new Backbone.Model(b),d=new e({model:c,Controller:a});a.subviews.push(d),a.$list.append(d.render())})},frontendSave:function(){var a=this;this.subviews.length>0&&_.each(this.subviews,function(b,c){b._remove&&(delete a.subviews[c],b.remove())})}})},{"./ImageView":40,"common/Logger":13}],40:[function(a,b,c){var d=a("common/TinyMCE"),e=a("common/UI"),f=a("templates/fields/Gallery/single-image.hbs");b.exports=Backbone.View.extend({tagName:"div",className:"kb-gallery--image-wrapper",initialize:function(a){this.Controller=a.Controller,this.uid=this.model.get("uid")||_.uniqueId("kbg"),this.editorAdded=!1,this._remove=!1},events:{"click .kb-gallery--js-edit":"edit","click .kb-gallery--js-delete":"delete","click .kb-gallery--js-meta-close":"close"},edit:function(){this.$el.wrap('<div class="kb-gallery--item-placeholder kb-gallery--image-wrapper"></div>'),this._placeholder=this.$el.parent(),this.$el.addClass("kb-gallery--active-item kb-field").appendTo("body"),jQuery("#wpwrap").addClass("module-browser-open"),this.handleEditor(),e.initTabs()},handleEditor:function(){var a=this,b=jQuery(".kb-js--remote-editor",this.$el),c=this.createInputName(this.uid)+"[details][description]";if(this.editorAdded)d.addEditor(b,null,150);else{var f=d.remoteGetEditor(b,c,this.uid,this.model.get("details").description,null,!1,!1);f.done(function(b){a.editorAdded=b,e.initTabs()})}},"delete":function(){this._remove?(this.$el.fadeTo(450,1).css("borderColor","#ccc"),jQuery(".kb-gallery--image-remove",this.$el).val(""),this._remove=!1):(this.$el.fadeTo(450,.5).css("borderColor","red"),this._remove=!0,jQuery(".kb-gallery--image-remove",this.$el).val("true"))},remove:function(){this.$el.remove(),delete this.$el},close:function(){var a=tinymce.get(this.uid+"_ededitor"),b=this.model.get("details");b.description=this.getEditorContent(a),tinymce.remove(a),this.$el.appendTo(this._placeholder).unwrap(),this.$el.removeClass("kb-gallery--active-item").removeClass("kb-field"),jQuery("#wpwrap").removeClass("module-browser-open")},getEditorContent:function(a){var b=jQuery("#wp-"+this.uid+"_ededitor-wrap"),c=b.hasClass("tmce-active");if(c)return a.getContent();var d=document.getElementById(this.uid+"_ededitor").value;return d=d.replace(/<br\s*\/?>/gm,"\n"),a.setContent(d),d},render:function(){var a=this.createInputName(this.uid),b=this.model.toJSON();return this.$el.append(f({image:b,id:b.id,inputName:a,uid:this.uid}))},createInputName:function(a){return this.createBaseId()+"["+this.Controller.model.get("fieldkey")+"][images]["+a+"]"},createBaseId:function(){return _.isEmpty(this.Controller.model.get("arrayKey"))?this.Controller.model.get("baseId"):this.Controller.model.get("baseId")+"["+this.Controller.model.get("arrayKey")+"]"}})},{"common/TinyMCE":18,"common/UI":19,"templates/fields/Gallery/single-image.hbs":142}],41:[function(a,b,c){var d=a("fields/FieldControlBaseView"),e=a("./gallery2/Gallery2Controller");b.exports=d.extend({initialize:function(){this.selection=null,this.render()},render:function(){this.$stage=this.$(".kb-gallery2__stage"),this.createController(),this.$stage.append(this.GalleryController.render())},derender:function(){this.GalleryController&&this.GalleryController.$el.detach()},createController:function(){return this.GalleryController||(this.GalleryController=new e({el:this.$stage.get(0),model:this.model})),this.GalleryController}})},{"./gallery2/Gallery2Controller":42,"fields/FieldControlBaseView":21}],42:[function(a,b,c){var d=a("common/Logger"),e=a("./ImageView");b.exports=Backbone.View.extend({initialize:function(a){this._frame=null,this.subviews={},this.ids=[],d.Debug.log("Fields: Gallery instance created and initialized"),this.renderElements(),this.initialSetup()},render:function(){return this.trigger("render"),this.setupElements(),this.delegateEvents(),this.$el},events:{"click .kb-gallery2--js-add-images":"addImages"},derender:function(){},renderElements:function(){jQuery('<div class="kb-gallery2--item-list"></div>').appendTo(this.$el),jQuery('<a class="button button-primary kb-gallery2--js-add-images">'+KB.i18n.Refields.image.addButton+"</a>").appendTo(this.$el)},setupElements:function(){this.$list=this.$(".kb-gallery2--item-list"),this.$list.sortable({revert:!0,delay:300,stop:_.bind(this.resortSelection,this)})},addImages:function(){this.openModal()},frame:function(){return this._frame?this._frame:void 0},openModal:function(){var a=this;return this._frame?void this._frame.open():(this._frame=new wp.media.view.KBGallery({state:"gallery-edit",multiple:!0,selection:this.selection,editing:!0}),this._frame.state("gallery-edit").on("update",function(b){a.selection=b,a.resortToSelection(),setTimeout(function(){KB.Events.trigger("modal.recalibrate")},250)}),this._frame.options.selection.on("add",function(b){a.add(b)}),this._frame.options.selection.on("remove",function(b){a.remove(b)}),this._frame.open(),this._frame)},initialSetup:function(){var a=this,b=this.model.get("value").images||{};if(this.setIds(b),""!=this.ids){var c={post__in:this.ids},d=wp.media.query(c);this.selection||(this.selection=new wp.media.model.Selection(d.models,{props:d.props.toJSON(),multiple:!0}),this.selection.more().done(function(){a.selection.props.set({query:!1}),a.selection.unmirror(),a.selection.props.unset("orderby"),a.initImages(),a.resortSelection()}))}},initImages:function(){_.each(this.ids,function(a){this.add(this.selection.get(a))},this)},add:function(a){var b=new e({model:a,Controller:this});this.subviews[a.get("id")]=b;var c=b.render();this.ids.push(a.get("id")),this.$list.append(c)},setIds:function(a){var b=[];_.each(a,function(a){a=parseInt(a,10),_.isNumber(a)&&!isNaN(a)&&b.push(a)}),this.ids=b},resortSelection:function(){var a=[],b=this.getIdsFromInputs();_.each(b,function(b){a.push(this.selection.get(b))},this),this.selection.reset(a),this.setIds(b)},remove:function(a){var b=this.ids.indexOf(a.get("id"));-1!==b&&this.ids.splice(b,1);var c=this.subviews[a.get("id")];c.remove(),delete this.subviews[a.get("id")]},getIdsFromInputs:function(){return this.$(".kb-gallery--image-holder input").map(function(a,b){return jQuery(b).val()}).get()},resortToSelection:function(){var a=_.pluck(this.selection.models,"id");_.each(this.subviews,function(a){a.$el.detach()},this),_.each(a,function(a){var b=this.subviews[a];b.$el.appendTo(this.$list)},this)}})},{"./ImageView":43,"common/Logger":13}],43:[function(a,b,c){var d=a("templates/fields/Gallery2/single-image.hbs");b.exports=Backbone.View.extend({tagName:"div",className:"kb-gallery--image-wrapper",initialize:function(a){this.Controller=a.Controller},remove:function(){this.$el.remove(),delete this.$el},render:function(){var a=this.createInputName(this.uid),b=this.model.toJSON();b.previewUrl=b.sizes.thumbnail?b.sizes.thumbnail.url:b.url;jQuery(d({image:b,id:b.id,inputName:a})).appendTo(this.$el);return this.$el},createInputName:function(a){return this.createBaseId()+"["+this.Controller.model.get("fieldkey")+"][images][]"},createBaseId:function(){return this.Controller.model.get("baseId")}})},{"templates/fields/Gallery2/single-image.hbs":143}],44:[function(a,b,c){var d=a("../FieldControlBaseView"),e=a("common/Utilities"),f=a("common/Config");b.exports=d.extend({initialize:function(){this.defaultState="replace-image",this.defaultFrame="image",this.render()},events:{"click .kb-js-add-image":"openFrame","click .kb-js-reset-image":"resetImage","change [data-kbimage-crop]":"handleCropChange"},handleCropChange:function(){var a=this.$cropSelect.val(),b=this.model.get("value");b.crop=a,this.model.set("value",b);var c=this.prepareArgs();this.retrieveImage(c,b.id)},render:function(){this.$reset=this.$(".kb-js-reset-image"),this.$container=this.$(".kb-field-image-container"),this.$saveId=this.$(".kb-js-image-id"),this.$description=this.$(".kb-js-image-description"),this.$title=this.$(".kb-js-image-title"),this.$cropSelect=this.$("[data-kbimage-crop]")},editImage:function(){this.openFrame(!0)},derender:function(){this.frame&&this.frame.dispose()},openFrame:function(a){var b,c=this;this.frame&&this.frame.dispose();var d={};""!==this.model.get("value").id&&(d.post__in=[this.model.get("value").id]),wp.media.query(d).more().done(function(){var a=this.first();c.attachment=a,a?(a.set("attachment_id",a.get("id")),b=c.attachment.toJSON()):(b={},c.defaultFrame="select",c.defaultState="library"),c.frame=wp.media({frame:c.defaultFrame,state:c.defaultState,metadata:b,imageEditView:c,type:"image",library:{type:"image"}}).on("update",function(a){c.update(a)}).on("close",function(a){c.frame.image&&c.frame.image.attachment&&(c.$description.val(c.frame.image.attachment.get("caption")),c.$title.val(c.frame.image.attachment.get("title")))}).on("ready",function(){c.ready()}).on("replace",function(){c.replace(c.frame.image.attachment)}).on("select",function(a){var b=this.get("library").get("selection").first();c.replace(b)}).open()})},ready:function(){jQuery(".media-modal").addClass("smaller kb-image-frame")},replace:function(a){this.attachment=a,this.handleAttachment(a)},update:function(a){this.attachment.set(a),this.attachment.sync("update",this.attachment)},getCropValue:function(){var a=this.model.get("value");return a.crop&&""!==a.crop?a.crop:this.model.get("crop")},prepareArgs:function(){var a=this;return{width:a.model.get("width")||null,height:a.model.get("height")||null,crop:a.getCropValue()||!0,upscale:a.model.get("upscale")||!1}},handleAttachment:function(a){var b=this,c=a.get("id"),d=this.prepareValue(a);b.model.set("value",d);var f=_.clone(this.model.get("ModuleModel").get("entityData")),g=this.model.get("kpath");e.setIndex(f,g,d),this.model.get("ModuleModel").set("entityData",f);var h=b.prepareArgs();if(h.width&&h.height)b.retrieveImage(h,c);else{var i=a.get("sizes").thumbnail?a.get("sizes").thumbnail.url:a.get("sizes").full.url;this.$container.html('<img src="'+i+'" >')}this.$saveId.val(a.get("id")),this.$description.val(a.get("caption")),this.$title.val(a.get("title")),this.model.get("ModuleModel").trigger("data.updated")},retrieveImage:function(a,b){var c=this;jQuery.ajax({url:ajaxurl,data:{action:"fieldGetImage",args:a,id:b,_ajax_nonce:f.getNonce("read")},type:"POST",dataType:"json",success:function(a){c.$container.html('<img src="'+a.data.src+'" >')},error:function(){}})},prepareValue:function(a){var b={id:a.get("id"),title:a.get("title"),caption:a.get("caption"),alt:a.get("alt")},c=this.model.get("value");return _.isObject(c)||(c={}),_.extend(c,b)},resetImage:function(){this.$container.html(""),this.$saveId.val(""),this.model.set("value",{id:null,caption:"",title:""}),this.$description.val(""),this.$title.val("")},toString:function(){var a=this;if(!this.attachment&&!_.isEmpty(this.model.get("value").id)){var b=wp.media.query({post__in:[this.model.get("value").id]}),c=b.more();c.done(function(c){a.attachment=b.first()})}if(this.attachment){var d=this.attachment.get("sizes").thumbnail?this.attachment.get("sizes").thumbnail:this.attachment.get("sizes").full;return"<img src='"+d.url+"'>"}return""}})},{"../FieldControlBaseView":21,"common/Config":11,"common/Utilities":20}],45:[function(a,b,c){var d=a("../FieldControlBaseView");b.exports=d.extend({initialize:function(){this.defaults={filter:!0},this.settings=this.model.get("settings")||{},this.render()},render:function(){this.$("[data-kftype='imageselect']").imagepicker(_.extend(this.defaults,this.settings))},rerender:function(){this.$("[data-kftype='imageselect']").imagepicker("destroy"),this.render()}})},{"../FieldControlBaseView":21}],46:[function(a,b,c){var d=a("../FieldControlBaseView");b.exports=d.extend({initialize:function(){this.render()},events:{"click .kb-js-add-link":"openModal"},render:function(){this.$input=this.$("[data-kbf-link-url]"),this.$text=this.$("[data-kbf-link-linktext]")},derender:function(){},openModal:function(){window._kbLink=this,wpActiveEditor=this.$input.attr("id"),jQuery("#wp-link-wrap").addClass("kb-customized"),window.kb_restore_htmlUpdate=wpLink.htmlUpdate,window.kb_restore_isMce=wpLink.isMCE,wpLink.isMCE=this.isMCE,wpLink.htmlUpdate=this.htmlUpdate,wpLink.open(),jQuery("#wp-link-text").val(this.$text.val()),jQuery("#wp-link-url").val(this.$input.val())},htmlUpdate:function(){var a,b,c,d=wpLink.textarea;d&&(a=wpLink.getAttrs(),c=jQuery("#wp-link-text").val(),a.href&&"http://"!=a.href&&(b=a.href,window._kbLink.$input.empty(),window._kbLink.$input.val(b),window._kbLink.trigger("update",c,b),window._kbLink.$text.val(c),wpLink.close(),window._kbLink.close(),d.focus()))},isMCE:function(){return!1},close:function(){wpLink.isMCE=window.kb_restore_isMce,wpLink.htmlUpdate=window.kb_restore_htmlUpdate}})},{"../FieldControlBaseView":21}],47:[function(a,b,c){var d=a("../FieldControlBaseView");b.exports=d.extend({initialize:function(){this.render()},render:function(){this.editor=new MediumEditor(this.$(".kb-medium-editable"))},derender:function(){},update:function(a){},toString:function(){}})},{"../FieldControlBaseView":21}],48:[function(a,b,c){var d=a("../FieldControlBaseView"),e=a("fields/controls/mlayout/MLayoutController");b.exports=d.extend({initialize:function(){this.createController(),this.render()},render:function(){this.$stage=this.$(".kb-field--mlayout-stage"),this.MLayoutController.setElement(this.$stage.get(0)),this.MLayoutController.render()},derender:function(){this.MLayoutController.derender()},rerender:function(){console.log("rerender"),this.render()},createController:function(){return this.MLayoutController?void 0:this.MLayoutController=new e({el:this.$(".kb-field--mlayout-stage"),model:this.model,parentView:this,area:this.model.ModuleModel.Area})}})},{"../FieldControlBaseView":21,"fields/controls/mlayout/MLayoutController":49}],49:[function(a,b,c){var d=a("fields/controls/mlayout/SlotView");b.exports=Backbone.View.extend({initialize:function(a){this.area=a.area,this.parentView=a.parentView,this.listenTo(this.model.ModuleModel.View,"modal.before.nodeupdate",this.disposeSubviews),this.listenTo(this.model.ModuleModel.View,"modal.after.nodeupdate",this.updateSubviews)},setupViewConnections:function(){var a={};return _.each(this.slots,function(b){if(""!==b.model.get("mid")){var c=KB.Modules.get(b.model.get("mid"));c&&c.View&&(a[b.model.get("mid")]=c.View)}}),a},updateSubviews:function(){_.each(this.subViews,function(a){a.rerender()})},disposeSubviews:function(){_.each(this.subViews,function(a){a.derender()})},setupSlots:function(){this.$slots=this.$("[data-kbml-slot]")},derender:function(){},render:function(){this.slots={},this.setupSlots(),this.setupViews(),this.subViews=this.setupViewConnections()},setupViews:function(){_.each(this.$slots,function(a){var b=jQuery(a),c=b.data("kbml-slot"),e=this.createSlotId(c),f=new d({el:b,model:new Backbone.Model({}),controller:this,slotId:this.createSlotId(c)});this.slots[this.createSlotId(c)]=f,f.setModule(this.getSlotModule(e)),f.model.set(this.getSlotData(e)),this.listenTo(f,"module.created",this.updateParent),this.listenTo(f,"module.removed",this.updateParent)},this)},createSlotId:function(a){return"slot-"+a},getSlotModule:function(a){var b=this.model.get("value"),c=b[a];return c?c:null},getSlotData:function(a){var b=this.model.get("value");return _.isObject(b)||(b={}),b.slots||(b.slots=new Object),b.slots[a]?b.slots[a]:{mid:""}},updateParent:function(){this.model.ModuleModel.sync()}})},{"fields/controls/mlayout/SlotView":52}],50:[function(a,b,c){var d=a("shared/ModuleBrowser/ModuleBrowserController"),e=a("common/Checks"),f=a("common/Config"),g=a("common/Notice"),h=a("common/Ajax");b.exports=d.extend({createModule:function(a){var b;e.userCan("create_kontentblocks")||g.notice("You're not allowed to do this","error"),b={action:"createNewModule","class":a.get("settings")["class"],globalModule:a.get("globalModule"),parentObject:a.get("parentObject"),parentObjectId:a.get("parentObjectId"),areaContext:this.area.model.get("context"),area:this.area.model.get("id"),_ajax_nonce:f.getNonce("create"),frontend:KB.appData.config.frontend,submodule:!0},this.area.model.get("parent_id")&&(b.postId=this.area.model.get("parent_id")),this.close(),h.send(b,this.success,this)},success:function(a){this.trigger("browser.module.created",{res:a})}})},{"common/Ajax":9,"common/Checks":10,"common/Config":11,"common/Notice":14,"shared/ModuleBrowser/ModuleBrowserController":120}],51:[function(a,b,c){var d=a("fields/controls/mlayout/templates/module-view.hbs"),e=a("common/Ajax"),f=a("common/Config"),g=a("common/TinyMCE"),h=a("common/Payload"),i=a("backend/Views/FullscreenView"),j=a("common/UI");b.exports=Backbone.View.extend({events:{"click .kbms-action--open":"openForm","click .kbms-action--delete":"removeModule","click .kbms-action--update":"saveModule"},tagName:"div",className:"kb-submodule",initialize:function(a){this.formLoaded=!1,this.slotView=a.slotView,this.controller=a.slotView.controller,this.ModuleModel=a.ModuleModel,this.parentModel=a.parentModel},draft:function(){},render:function(){var a=this;this.$el.append(d({module:this.ModuleModel.toJSON()})),this.slotView.$el.prepend(this.$el),_.defer(function(){a.setupElements()})},setupElements:function(){this.$inner=this.$(".kbsm-inner")},openForm:function(){KB.EditModalModules?this.handleFrontend():this.handleBackend()},handleBackend:function(){this.formLoaded?this.open():(data={action:"getModuleBackendForm",_ajax_nonce:f.getNonce("read"),module:this.ModuleModel.toJSON()},e.send(data,this.success,this))},handleFrontend:function(){var a=KB.Modules.get(this.model.get("mid"));KB.EditModalModules.openView(a.View,!1,!0)},success:function(a){this.$inner.hide().append(a.data.html);var b=KB.ObjectProxy.add(KB.Modules.add(this.ModuleModel.toJSON()));_.defer(function(){h.parseAdditionalJSON(a.data.json)}),this.formLoaded=!0,g.addEditor(this.$el),this.ModuleModel=b,this.open()},open:function(){f.get("frontend")||(this.fsControl||(this.fsControl=new i({model:this.ModuleModel})),this.fsControl.open()),this.listenToOnce(this.fsControl,"close",this.getDirty),j.repaint(this.fsControl.$el)},saveModule:function(){this.ModuleModel.sync(),this.getClean()},getDirty:function(){this.$el.addClass("is-dirty")},getClean:function(){this.$el.removeClass("is-dirty")},removeModule:function(a){this.slotView.removeModuleView(a)}})},{"backend/Views/FullscreenView":7,"common/Ajax":9,"common/Config":11,"common/Payload":15,"common/TinyMCE":18,"common/UI":19,"fields/controls/mlayout/templates/module-view.hbs":54}],52:[function(a,b,c){var d=a("fields/controls/mlayout/ModuleBrowser"),e=a("fields/controls/mlayout/ModuleView"),f=a("common/Ajax"),g=a("common/Config"),h=a("fields/controls/mlayout/templates/empty.hbs");b.exports=Backbone.View.extend({hasModule:!1,events:{click:"click"},initialize:function(a){this.controller=a.controller,this.slotId=a.slotId,this.ModuleView=null,this.ModuleModel=null,this.setup(),this.render(),this.listenTo(this.model,"change",this.updateInput)},setModule:function(a){_.isNull(a)||(this.ModuleModel=new Backbone.Model(a))},updateInput:function(){this.ModuleModel&&this.ModuleModel.get("submodule")?(this.ModuleView=new e({slotView:this,model:this.model,ModuleModel:this.ModuleModel,parentModel:this.controller.model.ModuleModel}),this.ModuleView.render(),this.$(".kbsm-empty").remove()):this.$el.prepend(h({})),this.$input.val(this.model.get("mid"))},setup:function(){var a=this.controller.model;this.basename=a.get("baseId"),a.get("arrayKey")&&(this.basename=this.basename+"["+a.get("arrayKey")+"]"),this.basename=this.basename+"["+a.get("fieldkey")+"][slots]["+this.slotId+"][mid]",this.$input=jQuery("<input type='hidden' name='"+this.basename+"'>")},render:function(){this.$el.append(this.$input)},click:function(){this.ModuleBrowser||(this.ModuleBrowser=new d({area:this.controller.area.View}),this.listenTo(this.ModuleBrowser,"browser.module.created",this.moduleCreated)),this.ModuleView||this.ModuleBrowser.render()},dispose:function(){},moduleCreated:function(a){var b=this,c=a.res,d=c.data.module;this.setModule(d),this.model.set("mid",d.mid),_.defer(function(){b.trigger("module.created")})},removeModuleView:function(a){a.stopPropagation(),f.send({action:"removeModules",_ajax_nonce:g.getNonce("delete"),module:this.model.get("mid")},this.removeSuccess,this)},removeSuccess:function(a){a.success&&(this.ModuleView.stopListening(),this.ModuleView.remove(),this.ModuleView.model=null,this.ModuleView=null,this.model.clear(),this.ModuleModel=null,this.updateInput(),this.trigger("module.removed"))}})},{"common/Ajax":9,"common/Config":11,"fields/controls/mlayout/ModuleBrowser":50,"fields/controls/mlayout/ModuleView":51,"fields/controls/mlayout/templates/empty.hbs":53}],53:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){return'<div class="kbsm-empty">\n    add module\n</div>'},useData:!0})},{"hbsfy/runtime":199}],54:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'<div class="kbsm-details">\n    <div class="kbsm--name">'+this.escapeExpression(this.lambda(null!=(e=null!=(e=null!=a?a.module:a)?e.settings:e)?e.name:e,a))+'</div>\n</div>\n<div class="kbsm-actions">\n    <div class="kbsm-action kbms-action--open" data-kbtooltip="open form"><span\n            class="dashicons dashicons-admin-generic"></span></div>\n    <div class="kbsm-action kbms-action--delete" data-kbtooltip="delete"><span\n            class="dashicons dashicons-welcome-comments"></span></div>\n    <div class="kbsm-action kbms-action--update" data-kbtooltip="update"><span\n            class="dashicons dashicons-update"></span></div>\n</div>\n<div class="kbsm-inner">\n\n</div>';
},useData:!0})},{"hbsfy/runtime":199}],55:[function(a,b,c){var d=a("../FieldControlBaseView");b.exports=d.extend({initialize:function(){this.defaults={filter:!0},this.settings=this.model.get("settings")||{},this.render()},render:function(){this.$("[data-kftype='multiselect']").multipleSelect(_.extend(this.defaults,this.settings))},rerender:function(){this.$("[data-kftype='multiselect']").multipleSelect("refresh")}})},{"../FieldControlBaseView":21}],56:[function(a,b,c){var d=a("../FieldControlBaseView"),e=a("common/Ajax"),f=a("common/Config");b.exports=d.extend({initialize:function(){this.render()},render:function(){var a=this;this.$input=this.$(".kb-field--oembed input"),this.$preview=this.$("[data-kb-oembed-preview]"),this.$input.on("change",function(){a.update(a.$input.val())}),this.$input.trigger("change")},derender:function(){},update:function(a){var b=this;this.model.set("value",a);this.sendRequest(a).done(function(a){a&&a.data&&a.data.html&&b.$preview.html(a.data.html)})},toString:function(){return""},sendRequest:function(a){return e.send({action:"getOembed",embedUrl:a,_ajax_nonce:f.getNonce("read")})}})},{"../FieldControlBaseView":21,"common/Ajax":9,"common/Config":11}],57:[function(a,b,c){var d=a("../FieldControlBaseView");b.exports=d.extend({events:{"click .js-oday-activate-split":"split"},initialize:function(){this.render()},render:function(){this.$(".kb-ot-timepicker").datetimepicker({datepicker:!1,format:"H:i",validateOnBlur:!1,step:30})},derender:function(){this.$(".kb-ot-timepicker").datetimepicker("destroy")},split:function(){this.$("table").toggleClass("split")}})},{"../FieldControlBaseView":21}],58:[function(a,b,c){var d=a("../FieldControlBaseView");b.exports=d.extend({initialize:function(){this.defaults={},this.settings=this.model.get("settings")||{},this.render()},render:function(){this.$("[data-kbselect2='true']").select2(_.extend(this.defaults,this.settings))},rerender:function(){this.render()}})},{"../FieldControlBaseView":21}],59:[function(a,b,c){var d=a("../FieldControlBaseView");b.exports=d.extend({initialize:function(){this.render()},render:function(){jQuery(".kb-tags-input").length&&window.tagBox&&window.tagBox.init()},toString:function(){return""}})},{"../FieldControlBaseView":21}],60:[function(a,b,c){var d=a("../FieldControlBaseView"),e=a("fields/controls/text-multiple/TextMultipleController");b.exports=d.extend({initialize:function(){this.createController(),this.render()},render:function(){var a=this;this.$stage=this.$('[data-kftype="text-multiple"]'),this.TextMultipleController.setElement(this.$stage.get(0)),_.defer(function(){a.TextMultipleController.render()})},derender:function(){this.FlexFieldsController.derender()},rerender:function(){this.render()},createController:function(){return this.TextMultipleController?void 0:this.TextMultipleController=new e({el:this.$('[data-kftype="text-multiple"]'),model:this.model,parentView:this})}})},{"../FieldControlBaseView":21,"fields/controls/text-multiple/TextMultipleController":61}],61:[function(a,b,c){b.exports=Backbone.View.extend({initialize:function(){},render:function(){this.setupElements(),this.bindHandlers(),this.initialSetup()},initialSetup:function(){var a=this.model.get("value");_.isArray(a)?(_.each(a,function(a,b){var c=this.model.get("limit");c&&c>=b+1&&this.createElement(a)},this),this.handleLimit()):this.createElement()},createElement:function(a){var b=a||"",c=this,d=_.extend(this.model.toJSON(),{value:b,arrayKey:this.model.get("arrayKey"),fieldkey:this.model.get("fieldkey"),primeKey:this.model.get("fieldkey"),fieldId:this.model.get("fieldId"),type:"text-multiple"}),e=KB.FieldsAPI.getRefByType("text-multiple",d);this.$list.append(e.render()),e.$el.on("click",'[data-kbfaction="delete"]',function(){e.$el.off(),e.remove(),c.handleLimit()}),this.handleLimit()},setupElements:function(){this.$list=this.$('[data-kfel="list"]'),this.$button=this.$('[data-kfui="add-entry"]'),this.$list.sortable()},bindHandlers:function(){var a=this;this.$button.on("click",function(){a.createElement()})},handleLimit:function(){var a=this.model.get("limit");if(a){var b=jQuery(".kb-field--text-multiple-item",this.$list).length;b>=a?this.$button.hide():this.$button.show()}}})},{}],62:[function(a,b,c){var d=a("../FieldControlBaseView");b.exports=d.extend({initialize:function(){this.render()},render:function(){var a=this;this.$input=this.$(".kb-field--text input"),this.$input.on("change",function(){a.update(a.$input.val())})},derender:function(){},update:function(a){this.model.set("value",a)},toString:function(){return this.$input.val()}})},{"../FieldControlBaseView":21}],63:[function(a,b,c){var d=a("../FieldControlBaseView");b.exports=d.extend({initialize:function(){this.render()},render:function(){var a=this;this.$textarea=this.$("textarea"),this.$textarea.on("change",function(){a.update(a.$textarea.val())})},derender:function(){},update:function(a){this.model.set("value",a)},toString:function(){return this.$textarea.val()}})},{"../FieldControlBaseView":21}],64:[function(a,b,c){b.exports={fields:{},register:function(a){var b=a.prototype.type;this.fields[b]=a},get:function(a){return new(this.fields[a.model.get("type")])({model:new Backbone.Model(a.model.toJSON())})},getRefByType:function(a,b){return new this.fields[a]({model:new Backbone.Model(b)})}}},{}],65:[function(a,b,c){a("fieldsAPI/hbsHelpers");var d=a("fieldsAPI/FieldsAPICollection");KB.FieldsAPI=d,KB.FieldsAPI.register(a("fieldsAPI/definitions/editor")),KB.FieldsAPI.register(a("fieldsAPI/definitions/image")),KB.FieldsAPI.register(a("fieldsAPI/definitions/link")),KB.FieldsAPI.register(a("fieldsAPI/definitions/text")),KB.FieldsAPI.register(a("fieldsAPI/definitions/select")),KB.FieldsAPI.register(a("fieldsAPI/definitions/text-multiple")),KB.FieldsAPI.register(a("fieldsAPI/definitions/textarea"))},{"fieldsAPI/FieldsAPICollection":64,"fieldsAPI/definitions/editor":67,"fieldsAPI/definitions/image":68,"fieldsAPI/definitions/link":69,"fieldsAPI/definitions/select":70,"fieldsAPI/definitions/text":72,"fieldsAPI/definitions/text-multiple":71,"fieldsAPI/definitions/textarea":73,"fieldsAPI/hbsHelpers":74}],66:[function(a,b,c){b.exports=Backbone.View.extend({initialize:function(){this.defaults=this.defaults||{},this.extendModel()},setValue:function(a){this.model.set("value",a)},derender:function(){this.model.destroy(),this.stopListening(),this.remove()},prepareBaseId:function(){return _.isEmpty(this.model.get("arrayKey"))?this.model.get("fieldId")+"["+this.model.get("fieldkey")+"]":this.model.get("fieldId")+"["+this.model.get("arrayKey")+"]["+this.model.get("fieldkey")+"]"},extendModel:function(){this.model.set("baseId",this.prepareBaseId()),this.model.set("uid",this.kbfuid()),this.model.set("kpath",this.prepareKpath())},prepareKpath:function(){var a=[];return this.model.get("arrayKey")&&a.push(this.model.get("arrayKey")),this.model.get("fieldkey")&&a.push(this.model.get("fieldkey")),this.model.get("index")&&a.push(this.model.get("index")),this.model.get("primeKey")&&a.push(this.model.get("primeKey")),a.join(".")},kbfuid:function(){var a=this.model.get("index")||"";return a+this.model.get("fieldId")+this.model.get("primeKey")+this.model.get("type")}})},{}],67:[function(a,b,c){var d=a("common/TinyMCE"),e=a("fieldsAPI/definitions/baseView");b.exports=e.extend({$editorWrap:null,templatePath:"fields/Editor",template:a("templates/fields/Editor.hbs"),type:"editor",initialize:function(a){e.prototype.initialize.call(this,a)},setValue:function(a){this.model.set("value",a)},render:function(a){return this.index=a,this.template({config:this.config,baseId:this.baseId,index:a,model:this.model.toJSON()})},postRender:function(){var a=this.model.get("baseId")+"["+this.model.get("index")+"]["+this.model.get("primeKey")+"]",b=this.model.get("fieldId")+"_"+this.model.get("key")+"_editor_"+this.model.get("index");this.$editorWrap=jQuery(".kb-ff-editor-wrapper-"+this.model.get("index")+"-"+this.model.get("key"),this.$el),d.remoteGetEditor(this.$editorWrap,a,b,this.model.get("value"),null,!1)}})},{"common/TinyMCE":18,"fieldsAPI/definitions/baseView":66,"templates/fields/Editor.hbs":138}],68:[function(a,b,c){var d=a("fieldsAPI/definitions/baseView");a("common/Utilities"),a("common/Config");b.exports=d.extend({$currentWrapper:null,$currentFrame:null,templatePath:"fields/Image",template:a("templates/fields/Image.hbs"),type:"image",render:function(a){return this.template({model:this.model.toJSON(),i18n:_.extend(KB.i18n.Refields.image,KB.i18n.Refields.common)})},postRender:function(){var a=(this.model.get("value"),{}),b=this;_.isEmpty(this.model.get("value").id)||(a.post__in=[this.model.get("value").id],wp.media.query(a).more().done(function(){var a=this.first();a&&(a.set("attachment_id",a.get("id")),b.fieldModel&&b.fieldModel.FieldControlView&&b.fieldModel.FieldControlView.handleAttachment(a))}))}})},{"common/Config":11,"common/Utilities":20,"fieldsAPI/definitions/baseView":66,"templates/fields/Image.hbs":144}],69:[function(a,b,c){var d=a("fieldsAPI/definitions/baseView");b.exports=d.extend({templatePath:"fields/Link",template:a("templates/fields/Link.hbs"),type:"link",render:function(){return this.template({i18n:_.extend(KB.i18n.Refields.link,KB.i18n.Refields.common),model:this.model.toJSON()})}})},{"fieldsAPI/definitions/baseView":66,"templates/fields/Link.hbs":145}],70:[function(a,b,c){var d=a("fieldsAPI/definitions/baseView");b.exports=d.extend({templatePath:"fields/Text",template:a("templates/fields/Select.hbs"),type:"select",render:function(){return this.template({model:this.model.toJSON()})}})},{"fieldsAPI/definitions/baseView":66,"templates/fields/Select.hbs":146}],71:[function(a,b,c){var d=a("fieldsAPI/definitions/baseView");b.exports=d.extend({templatePath:"fields/TextMultiple",template:a("templates/fields/TextMultiple.hbs"),type:"text-multiple",render:function(){var a=this.template({model:this.model.toJSON()});return this.setElement(a),this.$el}})},{"fieldsAPI/definitions/baseView":66,"templates/fields/TextMultiple.hbs":148}],72:[function(a,b,c){var d=a("fieldsAPI/definitions/baseView");b.exports=d.extend({templatePath:"fields/Text",template:a("templates/fields/Text.hbs"),type:"text",render:function(){return this.template({model:this.model.toJSON()})}})},{"fieldsAPI/definitions/baseView":66,"templates/fields/Text.hbs":147}],73:[function(a,b,c){var d=a("fieldsAPI/definitions/baseView");b.exports=d.extend({type:"textarea",templatePath:"fields/Textarea",template:a("templates/fields/Textarea.hbs"),render:function(){return this.template({model:this.model.toJSON()})}})},{"fieldsAPI/definitions/baseView":66,"templates/fields/Textarea.hbs":149}],74:[function(a,b,c){var d=a("hbsfy/runtime");d.registerHelper("debug",function(a){console.log("Current Context"),console.log("===================="),console.log(this),a&&(console.log("Value"),console.log("===================="),console.log(a))}),d.registerHelper("fieldName",function(a,b,c){return a+"["+b+"]["+c+"]"}),d.registerHelper("ifCond",function(a,b,c,d){switch(b){case"==":return a==c?d.fn(this):d.inverse(this);case"===":return a===c?d.fn(this):d.inverse(this);case"<":return c>a?d.fn(this):d.inverse(this);case"<=":return c>=a?d.fn(this):d.inverse(this);case">":return a>c?d.fn(this):d.inverse(this);case">=":return a>=c?d.fn(this):d.inverse(this);case"&&":return a&&c?d.fn(this):d.inverse(this);case"||":return a||c?d.fn(this):d.inverse(this);default:return d.inverse(this)}}),d.registerHelper("trimString",function(a,b){b=b||50;var c=a.length>b,e=a.substring(0,b);return c&&(e+="…"),new d.SafeString(e)})},{"hbsfy/runtime":199}],75:[function(a,b,c){var d=a("common/Utilities"),e=a("common/Config");b.exports={_active:!1,init:function(){jQuery("#wpadminbar").on("click","li.kb-edit-switch a",function(a){a.preventDefault()});var a=d.stex.get("kb.showcontrols");if(a||e.get("editAlwaysOn")){var b=jQuery(".kb-edit-switch a");this.control(b)}jQuery(document).on("heartbeat-send",function(a,b){var c=KB.appData.config.post.ID;b.kbEditWatcher=c})},control:function(a){this._active=!this._active,jQuery(a).parent("li").toggleClass("kb-edit-on"),jQuery("body").toggleClass("kb-editcontrols-show"),d.stex.set("kb.showcontrols",this._active,144e4),KB.Events.trigger("reposition"),KB.Events.trigger("content.change"),this._active?KB.Events.trigger("editcontrols.show"):KB.Events.trigger("editcontrols.hide")},isActive:function(){return this._active}}},{"common/Config":11,"common/Utilities":20}],76:[function(a,b,c){var d=a("fields/FieldControlModelModal");b.exports=Backbone.Collection.extend({model:d})},{"fields/FieldControlModelModal":23}],77:[function(a,b,c){b.exports=Backbone.Collection.extend({filterByAttr:function(a,b){return this.filter(function(c){return c.get(a)===b},this)}})},{}],78:[function(a,b,c){b.exports=Backbone.Collection.extend({initialize:function(){this.listenTo(this,"add",this.attachHandler)},attachHandler:function(a){this.listenTo(a,"remove",this.removeModel)},removeModel:function(a){this.remove(a,{silent:!0})}})},{}],79:[function(a,b,c){var d=window.KB||{};d.Events={},_.extend(d,Backbone.Events),_.extend(d.Events,Backbone.Events),d.currentModule={},d.currentArea={};var e=a("shared/ViewsCollection"),f=a("frontend/Views/EditModalModules"),g=a("frontend/Views/Sidebar"),h=a("fields/FieldControlsCollection"),i=a("common/Payload"),j=a("frontend/Collections/ModuleCollection"),k=a("frontend/Collections/ObjectProxyCollection"),l=a("frontend/Models/ModuleModel"),m=a("./Views/ModuleView"),n=a("frontend/Models/AreaModel"),o=a("frontend/Models/PanelModel"),p=a("./Views/PanelView"),q=a("common/UI"),r=a("common/Logger"),s=a("shared/ChangeObserver"),t=a("tether"),u=a("frontend/AdminBar"),v=a("common/Checks"),w=a("common/Config");a("fields/RefieldsController"),a("fieldsAPI/FieldsAPIController");d.Views={Modules:new e,Areas:new e,Context:new e,Panels:new e},d.Modules=new j([],{model:l}),d.Areas=new Backbone.Collection([],{model:n}),d.Panels=new Backbone.Collection([],{model:o}),d.ObjectProxy=new k([]),d.App=function(){function b(){w.get("initFrontend")&&(jQuery("body").addClass("wordpress-"+w.get("wpVersion")),d.appData.config.useModuleNav&&v.userCan("edit_kontentblocks")&&(d.Sidebar=new g),window.Tether=t,a("./InlineSetup"),a("./GlobalEvents"),d.EditModalModules=new f({}),d.ChangeObserver=new s,d.Modules.on("add",e),d.Modules.on("remove",l),d.Areas.on("add",k),d.Panels.on("add",j),c(),d.FieldControls=new h,d.FieldControls.add(_.toArray(i.getPayload("Fields"))),q.init())}function c(){return d.appData.config.preview?!1:(_.each(i.getPayload("Areas"),function(a){d.ObjectProxy.add(d.Areas.add(a))}),_.each(i.getPayload("Modules"),function(a){d.ObjectProxy.add(d.Modules.add(a))}),_.each(i.getPayload("Panels"),function(a){d.ObjectProxy.add(d.Panels.add(a))}),void d.Events.trigger("frontend.init"))}function e(a){d.Views.Modules.add(a.get("mid"),new m({model:a,el:"#"+a.get("mid")})),q.initTabs()}function j(a){d.Views.Panels.add(a.get("settings").uid,new p({model:a,el:"body"}))}function k(b){var c=a("./Views/AreaView");d.Views.Areas.add(b.get("id"),new c({model:b,el:"#"+b.get("id")}))}function l(a){a.dispose(),d.Views.Modules.remove(a.get("mid")),d.Events.trigger("content.change")}return{init:b}}(jQuery),jQuery(document).ready(function(){d.App.init();var a=jQuery("body");d.appData&&d.appData.config.frontend&&(d.Views.Modules.readyOnFront(),r.User.info("Frontend welcomes you"),a.addClass("kontentblocks-ready"),d.Events.trigger("content.change")),jQuery(window).on("scroll resize",function(){d.Events.trigger("window.change")}),setUserSetting("editor","tinymce"),a.on("click",".kb-fx-button",function(a){jQuery(this).addClass("kb-fx-button--click"),jQuery(a.currentTarget).one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){a.currentTarget.classList.remove("kb-fx-button--click")})}),d.App.adminBar=u,d.App.adminBar.init()})},{"./GlobalEvents":80,"./InlineSetup":89,"./Views/AreaView":94,"./Views/ModuleView":104,"./Views/PanelView":105,"common/Checks":10,"common/Config":11,"common/Logger":13,"common/Payload":15,"common/UI":19,"fields/FieldControlsCollection":24,"fields/RefieldsController":26,"fieldsAPI/FieldsAPIController":65,"frontend/AdminBar":75,"frontend/Collections/ModuleCollection":77,"frontend/Collections/ObjectProxyCollection":78,"frontend/Models/AreaModel":90,"frontend/Models/ModuleModel":91,"frontend/Models/PanelModel":92,"frontend/Views/EditModalModules":96,"frontend/Views/Sidebar":106,"shared/ChangeObserver":119,"shared/ViewsCollection":128,tether:200}],80:[function(a,b,c){var d=a("common/Logger");KB.Events.on("module.before.sync panel.before.sync",function(a){window.tinymce&&(window.tinymce.triggerSave(),d.Debug.info("tinymce.triggerSave called"))});var e=_.debounce(window.Tether.position,25);KB.Events.on("content.change",function(){e()}),jQuery("body").on("webkitTransitionEnd moztransitionend transitionend oTransitionEnd",function(){KB.Events.trigger("content.change")})},{"common/Logger":13}],81:[function(a,b,c){var d=a("common/Config"),e=(a("common/Utilities"),a("frontend/Inline/controls/EditImage")),f=a("frontend/Inline/controls/InlineUpdate"),g=a("frontend/Inline/InlineToolbar"),h=Backbone.View.extend({initialize:function(){this.mode=this.model.get("mode"),this.defaultState=this.model.get("state")||"replace-image",this.parentView=this.model.get("ModuleModel").View,this.listenTo(this.model,"field.model.settings",this.setMode),this.listenToOnce(this.model.get("ModuleModel"),"module.create",this.showPlaceholder),this.listenTo(KB.Events,"editcontrols.show",this.showPlaceholder),this.listenTo(KB.Events,"editcontrols.hide",this.removePlaceholder),this.Toolbar=new g({FieldControlView:this,model:this.model,controls:[new e({model:this.model,parent:this}),new f({model:this.model,parent:this})]}),this.render()},showPlaceholder:function(){if(this.hasData())return!1;this.$el.on("load",function(){KB.Events.trigger("content.change reposition")});var a="https://unsplash.it/g/"+this.model.get("width")+"/"+this.model.get("height")+"?random";"simple"===this.mode?this.$el.attr("src",a):"background"===this.mode&&this.$el.css("backgroundImage","url('"+a+"')")},removePlaceholder:function(){return this.hasData()?!1:void("simple"===this.mode?this.$el.attr("src",""):"background"===this.mode&&this.$el.css("backgroundImage","url('')"))},hasData:function(){return _.isNumber(parseInt(this.model.get("value").id,10))},setMode:function(a){this.model.set("mode",a.mode),this.mode=a.mode},render:function(){this.delegateEvents(),this.$el.addClass("kb-inline-imageedit-attached"),this.$caption=jQuery("*[data-"+this.model.get("uid")+"-caption]"),this.$title=jQuery("*[data-"+this.model.get("uid")+"-title]")},rerender:function(){this.render(),this.trigger("field.view.rerender",this)},gone:function(){this.trigger("field.view.gone",this),this.Toolbar.hide()},derender:function(){this.frame&&(this.frame.dispose(),this.frame=null),this.$el.off(),this.trigger("field.view.derender",this)},openFrame:function(){var a=this;this.frame&&this.frame.dispose();var b={post__in:[this.model.get("value").id]};wp.media.query(b).more().done(function(){var b=a.attachment=this.first();a.attachment.set("attachment_id",b.get("id")),a.frame=wp.media({frame:"select",state:"library",metadata:b.toJSON(),imageEditView:a,library:{type:"image"}}).on("update",function(b){a.update(b)}).on("ready",function(){a.ready()}).on("replace",function(){a.replace(a.frame.image.attachment)}).on("select",function(){var b=this.get("library").get("selection").first();a.replace(b)}).open()})},ready:function(){jQuery(".media-modal").addClass("smaller kb-image-frame")},replace:function(a){this.attachment=a,this.handleAttachment(a)},update:function(a){this.attachment.set(a),this.attachment.sync("update",this.attachment),this.$caption.length>0&&this.$caption.html(this.attachment.get("caption"))},handleAttachment:function(a,b){var c=this,e=a.get("id"),f=this.prepareValue(a);this.model.attachment=a,this.model.set("value",f),KB.Events.trigger("modal.refresh"),c.model.trigger("field.model.dirty",c.model);var g={width:c.model.get("width"),height:c.model.get("height"),crop:c.model.get("crop"),upscale:c.model.get("upscale")};jQuery.ajax({url:ajaxurl,data:{action:"fieldGetImage",args:g,id:e,_ajax_nonce:d.getNonce("read")},type:"POST",dataType:"json",success:function(d){"simple"===c.mode?c.$el.attr("src",d.data.src):"background"===c.mode&&c.$el.css("backgroundImage","url('"+d.data.src+"')"),c.delegateEvents(),b||c.model.trigger("external.change",c.model),c.$caption.length>0&&c.$caption.html(a.get("caption")),c.$title.length>0&&c.$title.html(a.get("title")),KB.Events.trigger("content.change")},error:function(){}})},prepareValue:function(a){return{id:a.get("id"),title:a.get("title"),caption:a.get("caption")}},synchronize:function(a){this.handleAttachment(a.attachment,!0)}});KB.Fields.registerObject("EditableImage",h),b.exports=h},{"common/Config":11,"common/Utilities":20,"frontend/Inline/InlineToolbar":84,"frontend/Inline/controls/EditImage":85,"frontend/Inline/controls/InlineUpdate":88}],82:[function(a,b,c){var d=(a("common/Config"),a("common/Utilities"),a("frontend/Inline/controls/EditLink")),e=a("frontend/Inline/controls/InlineUpdate"),f=a("frontend/Inline/InlineToolbar"),g=Backbone.View.extend({initialize:function(){this.parentView=this.model.get("ModuleModel").View,this.setupDefaults(),this.Toolbar=new f({FieldControlView:this,model:this.model,controls:[new d({model:this.model,parent:this}),new e({model:this.model,parent:this})],tether:{offset:"0 -20px"}}),this.render()},render:function(){this.Toolbar.show(),this.delegateEvents(),this.$caption=jQuery("*[data-"+this.model.get("uid")+"-caption]")},rerender:function(){this.render(),this.trigger("field.view.rerender",this)},derender:function(){this.$el.off(),this.trigger("field.view.derender",this)},gone:function(){this.trigger("field.view.gone",this),this.Toolbar.hide()},openDialog:function(){var a=this;window.wpActiveEditor="ghosteditor",jQuery("#wp-link-wrap").addClass("kb-customized"),window.kb_restore_htmlUpdate=wpLink.htmlUpdate,window.kb_restore_isMce=wpLink.isMCE,wpLink.isMCE=function(){return!1},wpLink.htmlUpdate=function(){a.htmlUpdate.call(a)},wpLink.open(),jQuery("#wp-link-text").val(this.model.get("value").linktext),jQuery("#wp-link-url").val(this.model.get("value").link)},htmlUpdate:function(){var a,b,c,d=wpLink.textarea;if(d&&(a=wpLink.getAttrs(),c=jQuery("#wp-link-text").val(),a.href&&"http://"!=a.href)){b=a.href,this.$el.attr("href",b),this.$el.text(c);var e={link:b,linktext:c};this.model.set("value",e),this.model.trigger("field.model.dirty",this.model),this.model.trigger("external.change",this.model),wpLink.close(),this.close()}},close:function(){wpLink.isMCE=window.kb_restore_isMce,wpLink.htmlUpdate=window.kb_restore_htmlUpdate,KB.Events.trigger("content.change")},setupDefaults:function(){var a=this.model.get("value");a&&""!==a||(a={});var b=_.defaults(a,{link:"",linktext:""});this.model.set("value",b)},synchronize:function(a){this.$el.attr("href",a.get("value").link),this.$el.html(a.get("value").linktext),this.model.trigger("field.model.dirty",this.model),KB.Events.trigger("content.change")}});KB.Fields.registerObject("EditableLink",g),b.exports=g},{"common/Config":11,"common/Utilities":20,"frontend/Inline/InlineToolbar":84,"frontend/Inline/controls/EditLink":86,"frontend/Inline/controls/InlineUpdate":88}],83:[function(a,b,c){var d=a("common/Utilities"),e=a("common/Config"),f=a("frontend/Inline/controls/EditText"),g=a("frontend/Inline/controls/InlineUpdate"),h=a("frontend/Inline/InlineToolbar"),i=Backbone.View.extend({initialize:function(){this.settings=this.model.get("tinymce"),this.parentView=this.model.get("ModuleModel").View,this.setupDefaults(),this.listenToOnce(this.model.get("ModuleModel"),"remove",this.deactivate),this.listenToOnce(this.model.get("ModuleModel"),"module.create",this.showPlaceholder),this.listenTo(KB.Events,"editcontrols.show",this.showPlaceholder),this.listenTo(KB.Events,"editcontrols.hide",this.removePlaceholder),this.Toolbar=new h({FieldControlView:this,model:this.model,controls:[new f({model:this.model,parent:this}),new g({model:this.model,parent:this})]}),this.render()},showPlaceholder:function(){this.preValue=this.model.get("value");var a=_.isEmpty(this.cleanString(this.model.get("value")));a&&this.$el.html("<p>Start writing here</p>")},removePlaceholder:function(){var a=_.isEmpty(this.cleanString(this.model.get("value")));a&&this.$el.html(this.preValue)},render:function(){this.el.id&&(this.id=this.el.id),this.Toolbar.show()},derender:function(){this.deactivate(),this.trigger("field.view.derender",this),this.$el.off()},gone:function(){this.trigger("field.view.gone",this),this.Toolbar.hide()},rerender:function(){this.render(),this.trigger("field.view.rerender",this)},setupDefaults:function(){var a=this,b={theme:"modern",skin:!1,menubar:!1,add_unload_trigger:!1,entity_encoding:"raw",fixed_toolbar_container:null,schema:"html5",inline:!0,plugins:"textcolor, wptextpattern",statusbar:!1,preview_styles:!1,setup:function(b){b.on("init",function(){a.editor=b,b.module=a.model.get("ModuleModel"),b.kfilter=a.model.get("filter")&&"content"===a.model.get("filter")?!0:!1,KB.Events.trigger("KB::tinymce.new-inline-editor",b),b.focus(),jQuery(".mce-panel.mce-floatpanel").hide(),jQuery(window).on("scroll.kbmce resize.kbmce",function(){jQuery(".mce-panel.mce-floatpanel").hide()})}),b.on("selectionchange mouseup",function(c){a.getSelection(b,c)}),b.on("NodeChange",function(a){KB.Events.trigger("window.change")}),b.on("focus",function(){var c;window.wpActiveEditor=a.el.id,c=d.getIndex(b.module.get("entityData"),a.model.get("kpath")),b.kfilter&&b.setContent(switchEditors.wpautop(c)),b.previousContent=b.getContent(),a.$el.addClass("kb-inline-text--active")}),b.on("blur",function(c){var d;a.$el.removeClass("kb-inline-text--active"),d=b.getContent(),b.kfilter&&(d=switchEditors._wp_Nop(b.getContent())),b.isDirty()?b.kfilter?a.retrieveFilteredContent(b,d):(a.model.set("value",d),a.model.syncContent=b.getContent(),a.model.trigger("external.change",a.model),a.model.trigger("field.model.dirty",a.model),KB.Events.trigger("content.change")):b.setContent(b.previousContent)})}};this.defaults=_.extend(b,this.settings)},retrieveFilteredContent:function(a,b){var c=this;jQuery.ajax({url:ajaxurl,data:{action:"applyContentFilter",content:b,postId:a.module.toJSON().parentObjectId,_ajax_nonce:e.getNonce("read")},type:"POST",dataType:"json",success:function(d){a.setContent(d.data.content),c.model.set("value",b),c.model.syncContent=a.getContent(),c.model.trigger("field.model.dirty",c.model),c.model.trigger("external.change",c.model),KB.Events.trigger("content.change"),setTimeout(function(){window.twttr&&window.twttr.widgets.load(),jQuery(window).off("scroll.kbmce resize.kbmce"),a.off("nodeChange ResizeEditor ResizeWindow"),c.deactivate()},500)},error:function(){}})},activate:function(a){KB.EditModalModules&&KB.EditModalModules.destroy(),a.stopPropagation(),this.editor||tinymce.init(_.defaults(this.defaults,{selector:"#"+this.id}))},deactivate:function(){if(this.editor){var a=this.editor;this.editor=null,tinyMCE.execCommand("mceRemoveEditor",!0,a.id),KB.Events.trigger("kb.repaint")}},cleanString:function(a){return a.replace(/\s/g,"").replace(/&nbsp;/g,"").replace(/<br>/g,"").replace(/<[^\/>][^>]*><\/[^>]+>/g,"").replace(/<p><\/p>/g,"")},getSelection:function(a,b){var c=a.selection.getContent(),d=jQuery(".mce-panel.mce-floatpanel");if(""===c)d.hide();else{var e=j(),f=d.width();d.css({top:e.top-40+"px",left:e.left-f+"px"}),d.show()}},synchronize:function(a){this.editor?this.editor.setContent(a.syncContent):this.$el.html(a.syncContent),this.model.trigger("field.model.dirty",this.model)}}),j=function(){var a,b="\ufeff",c="&#xfeff;",d="sel_"+(new Date).getTime()+"_"+Math.random().toString().substr(2);return function(){var e,f;if(document.selection&&document.selection.createRange)f=document.selection.createRange().duplicate(),f.collapse(!1),f.pasteHTML('<span id="'+d+'" style="position: relative;">'+c+"</span>"),a=document.getElementById(d);else if(window.getSelection){e=window.getSelection(),e.getRangeAt?f=e.getRangeAt(0).cloneRange():(f.setStart(e.anchorNode,e.anchorOffset),f.setEnd(e.focusNode,e.focusOffset),f.collapsed!==e.isCollapsed&&(f.setStart(e.focusNode,e.focusOffset),f.setEnd(e.anchorNode,e.anchorOffset))),f.collapse(!1),a=document.createElement("span"),a.id=d;var g=jQuery(a);g.prepend(document.createTextNode(b)),f.insertNode(a)}if(a){var h=a,i=0,j=0;do i+=h.offsetLeft,j+=h.offsetTop;while(h=h.offsetParent);return a.parentNode.removeChild(a),g.remove(),{left:i,top:j}}}}();b.exports=i},{"common/Config":11,"common/Utilities":20,"frontend/Inline/InlineToolbar":84,"frontend/Inline/controls/EditText":87,"frontend/Inline/controls/InlineUpdate":88}],84:[function(a,b,c){var d=a("tether");b.exports=Backbone.View.extend({tagName:"div",className:"kb-inline-toolbar",attributes:function(){return{"data-kbelrel":this.model.get("baseId"),hidefocus:"1",tabindex:"-1"}},initialize:function(a){this.options=a,this.FieldControlView=a.FieldControlView,this.controls=a.controls||[],this.hidden=!1,this.listenTo(this.model,"field.model.dirty",this.getDirty),this.listenTo(this.model,"field.model.clean",this.getClean),this.listenTo(this.FieldControlView,"field.view.derender",this.derender),this.listenTo(this.FieldControlView,"field.view.rerender",this.rerender),this.listenTo(this.FieldControlView,"field.view.gone",this.derender),this.create()},create:function(){var a=this;_.each(this.controls,function(b){b.isValid()&&(b.render().appendTo(a.$el),b.Toolbar=a)}),this.$el.appendTo("body"),this.createPosition()},hide:function(){this.$el.hide(),this.hidden=!0},show:function(){this.hidden&&this.$el.show()},createPosition:function(){var a=this.options.tether||{},b={element:this.$el,target:this.FieldControlView.$el,attachment:"center right",targetAttachment:"center right"};this.Tether=new d(_.defaults(b,a))},getDirty:function(){this.$el.addClass("isDirty")},getClean:function(){this.$el.removeClass("isDirty")},derender:function(){this.Tether&&(this.Tether.destroy(),delete this.Tether)},rerender:function(){this.createPosition()},getTetherDefaults:function(){var a=this.el,b=this.FieldControlView.el;return _.defaults(tether,{element:a,target:b,attachment:"center right",targetAttachment:"center right"})}})},{tether:200}],85:[function(a,b,c){var d=a("common/Checks");b.exports=Backbone.View.extend({initialize:function(a){this.visible=!1,this.options=a||{},this.Parent=a.parent,this.listenTo(KB.Events,"window.change",this.reposition)},className:"kb-inline-control kb-inline--edit-image",events:{click:"openFrame",mouseenter:"mouseenter",mouseleave:"mouseleave"},openFrame:function(){this.Parent.openFrame()},render:function(){return this.$el},isValid:function(){return d.userCan("edit_kontentblocks")},mouseenter:function(){this.Parent.$el.addClass("kb-field--outline"),_.each(this.model.get("linkedFields"),function(a){a.FieldControlView.$el.addClass("kb-field--outline-link")})},mouseleave:function(){this.Parent.$el.removeClass("kb-field--outline"),_.each(this.model.get("linkedFields"),function(a){a.FieldControlView.$el.removeClass("kb-field--outline-link")})}})},{"common/Checks":10}],86:[function(a,b,c){var d=a("common/Checks");b.exports=Backbone.View.extend({initialize:function(a){this.visible=!1,this.options=a||{},this.Parent=a.parent,this.isValid()&&this.render()},className:"kb-inline-control kb-inline--edit-link",events:{click:"openDialog",mouseenter:"mouseenter",mouseleave:"mouseleave"},openDialog:function(){this.Parent.openDialog()},render:function(){return this.$el},isValid:function(){return d.userCan("edit_kontentblocks")},mouseenter:function(){this.Parent.$el.addClass("kb-field--outline"),_.each(this.model.get("linkedFields"),function(a){a.FieldControlView.$el.addClass("kb-field--outline-link")})},mouseleave:function(){this.Parent.$el.removeClass("kb-field--outline"),_.each(this.model.get("linkedFields"),function(a){a.FieldControlView.$el.removeClass("kb-field--outline-link");
})}})},{"common/Checks":10}],87:[function(a,b,c){var d=a("common/Checks");b.exports=Backbone.View.extend({initialize:function(a){this.visible=!1,this.options=a||{},this.Parent=a.parent},className:"kb-inline-control kb-inline--edit-text",events:{click:"focusEditor",mouseenter:"mouseenter",mouseleave:"mouseleave"},focusEditor:function(a){this.Parent.editor||this.Parent.activate(a)},render:function(){return this.$el},isValid:function(){return d.userCan("edit_kontentblocks")},mouseenter:function(){this.Parent.$el.addClass("kb-field--outline"),_.each(this.model.get("linkedFields"),function(a){a.FieldControlView.$el.addClass("kb-field--outline-link")})},mouseleave:function(){this.Parent.$el.removeClass("kb-field--outline"),_.each(this.model.get("linkedFields"),function(a){a.FieldControlView.$el.removeClass("kb-field--outline-link")})}})},{"common/Checks":10}],88:[function(a,b,c){var d=a("common/Checks");a("common/Config"),a("common/Logger");b.exports=Backbone.View.extend({initialize:function(a){this.visible=!1,this.options=a||{},this.Parent=a.parent},className:"kb-inline-control kb-inline--update",events:{click:"syncFieldModel",mouseenter:"mouseenter",mouseleave:"mouseleave"},render:function(){return this.$el},syncFieldModel:function(a){var b=this.model.sync(this);b.done(function(a){a.success&&(this.model.getClean(),_.each(this.model.get("linkedFields"),function(a,b){_.isNull(a)||a.getClean()}))})},syncModuleModel:function(){this.model.get("ModuleModel").sync(!0),this.Toolbar.getClean()},isValid:function(){return d.userCan("edit_kontentblocks")},mouseenter:function(){}})},{"common/Checks":10,"common/Config":11,"common/Logger":13}],89:[function(a,b,c){var d=a("frontend/Inline/EditableTextView"),e=a("frontend/Inline/EditableLinkView"),f=a("frontend/Inline/EditableImageView");KB.Fields.registerObject("EditableText",d),KB.Fields.registerObject("EditableImage",f),KB.Fields.registerObject("EditableLink",e)},{"frontend/Inline/EditableImageView":81,"frontend/Inline/EditableLinkView":82,"frontend/Inline/EditableTextView":83}],90:[function(a,b,c){b.exports=Backbone.Model.extend({defaults:{id:"generic"},idAttribute:"id"})},{}],91:[function(a,b,c){var d=a("common/Config"),e=(a("common/Notice"),a("common/Logger"));b.exports=Backbone.Model.extend({idAttribute:"mid",attachedFields:{},changedFields:{},linkedModules:{},initialize:function(){this.subscribeToArea(),this.type="module",this.get("globalModule")&&this.linkModules()},subscribeToArea:function(a){a||(a=KB.Areas.get(this.get("area"))),a.View.attachModuleView(this),this.Area=a},dispose:function(){this.stopListening()},attachField:function(a){this.attachedFields[a.id]=a,this.listenTo(a,"field.model.dirty",this.addChangedField),this.listenTo(a,"field.model.clean",this.removeChangedField),this.listenTo(a,"remove",this.removeAttachedField)},removeAttachedField:function(a){this.attachedFields[a.id]&&(this.stopListening(a),delete this.attachedFields[a.id]),this.changedFields[a.id]&&delete this.changedFields[a.id]},addChangedField:function(a){this.changedFields[a.id]=a},removeChangedField:function(a){this.changedFields[a.id]&&delete this.changedFields[a.id],_.isEmpty(this.changedFields)&&this.trigger("module.model.clean",this)},sync:function(a,b){var c=this;return KB.Events.trigger("module.before.sync",this),jQuery.ajax({url:ajaxurl,data:{action:"updateModule",data:c.toJSON().entityData,module:c.toJSON(),editmode:a?"update":"preview",_ajax_nonce:d.getNonce("update")},context:b?b:c,type:"POST",dataType:"json",success:function(b){c.set("entityData",b.data.newModuleData),a&&c.trigger("module.model.updated",c)},error:function(){e.Debug.error("serialize | FrontendModal | Ajax error")}})},getModuleView:function(){return this.View?this.View:!1},linkModules:function(){}})},{"common/Config":11,"common/Logger":13,"common/Notice":14}],92:[function(a,b,c){var d=a("common/Config"),e=a("common/Logger");b.exports=Backbone.Model.extend({idAttribute:"baseId",attachedFields:{},changedFields:{},initialize:function(){this.type="panel"},attachField:function(a){this.attachedFields[a.id]=a,this.listenTo(a,"field.model.dirty",this.addChangedField),this.listenTo(a,"field.model.clean",this.removeChangedField),this.listenTo(a,"remove",this.removeAttachedField)},removeAttachedField:function(a){this.attachedFields[a.id]&&delete this.attachedFields[a.id],this.changedFields[a.id]&&delete this.changedFields[a.id]},addChangedField:function(a){this.changedFields[a.id]=a},removeChangedField:function(a){this.changedFields[a.id]&&(this.stopListening(a),delete this.changedFields[a.id]),_.isEmpty(this.changedFields)&&this.trigger("module.model.updated",this)},sync:function(a,b){var c=this;return KB.Events.trigger("panel.before.sync"),jQuery.ajax({url:ajaxurl,data:{action:"updatePostPanel",data:c.toJSON().entityData,panel:c.toJSON(),editmode:a?"update":"preview",_ajax_nonce:d.getNonce("update")},context:b?b:c,type:"POST",dataType:"json",success:function(a){c.set("entityData",a.data.newModuleData),c.trigger("module.model.updated",c)},error:function(){e.Debug.error("sync | FrontendModal | Ajax error")}})}})},{"common/Config":11,"common/Logger":13}],93:[function(a,b,c){var d=a("shared/ModuleBrowser/ModuleBrowserController");a("frontend/Models/ModuleModel"),a("common/TinyMCE");b.exports=d.extend({success:function(a){var b;this.dropZone?(this.dropZone.$el.after(a.data.html),this.dropZone.removeDropZone()):this.options.area.$el.append(a.data.html).removeClass("kb-area__empty"),KB.ObjectProxy.add(b=KB.Modules.add(a.data.module)),this.parseAdditionalJSON(a.data.json),KB.Fields.trigger("newModule",KB.Views.Modules.lastViewAdded),this.options.area.trigger("kb.module.created"),KB.Events.trigger("content.change reposition"),b.trigger("module.created"),setTimeout(function(){b.View.openOptions()},300)},close:function(){delete this.dropZone,d.prototype.close.apply(this,arguments)}})},{"common/TinyMCE":18,"frontend/Models/ModuleModel":91,"shared/ModuleBrowser/ModuleBrowserController":120}],94:[function(a,b,c){var d=a("frontend/ModuleBrowser/ModuleBrowserExt"),e=a("common/Config"),f=a("common/Notice"),g=a("common/Ajax"),h=a("templates/frontend/area-empty-placeholder.hbs");b.exports=Backbone.View.extend({isSorting:!1,events:{"click .kb-area__empty-placeholder":"openModuleBrowser"},initialize:function(){this.attachedModuleViews={},this.renderSettings=this.model.get("renderSettings"),this.listenTo(KB.Events,"editcontrols.show",this.showPlaceholder),this.listenTo(KB.Events,"editcontrols.hide",this.removePlaceholder),this.listenToOnce(KB.Events,"frontend.init",this.setupUi),this.listenTo(this,"kb.module.deleted",this.removeModule),this.model.View=this},showPlaceholder:function(){0===_.size(this.attachedModuleViews)&&this.$el.append(h())},removePlaceholder:function(){this.$(".kb-area__empty-placeholder").remove()},setupUi:function(){this.model.get("sortable")&&this.setupSortables()},openModuleBrowser:function(){return this.ModuleBrowser||(this.ModuleBrowser=new d({area:this})),this.ModuleBrowser.render(),this.ModuleBrowser},attachModuleView:function(a){this.attachedModuleViews[a.get("mid")]=a,this.listenTo(a,"change:area",this.removeModule),this.getNumberOfModules()>0&&(this.removePlaceholder(),this.$el.removeClass("kb-area__empty")),this.trigger("kb.module.created",a)},getNumberOfModules:function(){return _.size(this.attachedModuleViews)},getAttachedModules:function(){return this.attachedModuleViews},setupSortables:function(){var a=this;this.$el.sortable({handle:".kb-module-control--move",items:".module",helper:"clone",cursorAt:{top:5,left:5},delay:150,forceHelperSize:!0,forcePlaceholderSize:!0,placeholder:"kb-front-sortable-placeholder",start:function(b,c){a.isSorting=!0},receive:function(b,c){var d=c.item.data("module");a.isSorting=!1,d.create(c)},stop:function(){a.isSorting&&(a.isSorting=!1,a.resort(a.model),KB.Events.trigger("content.change"))},change:function(){a.applyClasses()}})},removeModule:function(a){var b=a.model.get("mid");this.attachedModuleViews[b]&&delete this.attachedModuleViews[b],this.getNumberOfModules()<1&&(this.$el.addClass("kb-area__empty"),this.showPlaceholder())},resort:function(a){var b={};return b[a.get("id")]=a.View.$el.sortable("serialize",{attribute:"rel"}),g.send({action:"resortModules",postId:a.get("envVars").postId,data:b,_ajax_nonce:e.getNonce("update")},function(){f.notice("Order was updated successfully","success"),a.trigger("area.resorted")},null)},applyClasses:function(){var a,b,c=this.AreaView.$el.find(".module");c.removeClass("first-module last-module repeater");for(var d=0;d<c.length;d++){var e=jQuery(c[d]).data("ModuleView");_.isUndefined(e)||(0===d&&e.$el.addClass("first-module"),d===c.length-1&&e.$el.addClass("last-module"),b&&e.model.get("settings").id===b&&e.$el.addClass("repeater"),b=e.model.get("settings").id,a=e.$el.parent(),a.hasClass("kb-wrap")&&a.attr("rel",e.$el.attr("rel")))}}})},{"common/Ajax":9,"common/Config":11,"common/Notice":14,"frontend/ModuleBrowser/ModuleBrowserExt":93,"templates/frontend/area-empty-placeholder.hbs":150}],95:[function(a,b,c){var d=a("common/Stack");b.exports=Backbone.View.extend({events:{click:"goBack"},initialize:function(a){this.stack=new d,this.modal=a.modal,this.setElement(this.modal.$(".kb-modal-history-back")),this.render()},append:function(a){this.stack.append(a),this.render()},prepend:function(a){this.stack.prepend(a),this.render()},reset:function(){this.stack.reset(),this.render()},render:function(){this.stack.length()>0?this.$el.show():this.$el.hide()},goBack:function(){this.modal.openView(this.stack.first(),!1,!1),this.render()}})},{"common/Stack":16}],96:[function(a,b,c){var d=a("common/Logger"),e=a("frontend/Collections/ModalFieldCollection"),f=a("frontend/Views/LoadingAnimation"),g=a("common/Config"),h=a("common/UI"),i=a("common/TinyMCE"),j=a("common/Notice"),k=a("common/Ajax"),l=a("templates/frontend/module-edit-form.hbs"),m=a("frontend/Views/EditModalHistory");b.exports=Backbone.View.extend({tagName:"div",id:"onsite-modal",timerId:null,viewStack:{},initialize:function(){var a=this;return this.FieldModels=new e,this.$el.append(l({model:{},i18n:KB.i18n.jsFrontend})),this.history=new m({modal:this}),this.LoadingAnimation=new f({el:this.$form}),this.setupElements(),this.bindHandlers(),jQuery(document).on("change",".kb-observe",function(){a.serialize(!1,!0)}),this},bindHandlers:function(){var a=this;this.listenTo(KB.Events,"modal.recalibrate",this.recalibrate),this.listenTo(KB.Events,"modal.preview",this.preview),this.listenTo(KB.Events,"modal.update",this.update),jQuery(window).on("resize",function(){a.recalibrate()}),this.listenTo(KB.Events,"KB::tinymce.new-editor",function(b){b.settings&&b.settings.kblive&&a.attachEditorEvents(b)})},setupElements:function(){this.$form=jQuery("#onsite-form",this.$el),this.$formContent=jQuery("#onsite-content",this.$el),this.$inner=jQuery(".os-content-inner",this.$formContent),this.$title=jQuery(".controls-title",this.$el),this.$draft=jQuery(".kb-modal__draft-notice",this.$el)},events:{keyup:"delayInput","click .close-controls":"destroy","click .kb-save-form":"update","click .kb-preview-form":"preview","change .kb-template-select":"viewfileChange"},openView:function(a,b,c){return this.ModuleView&&this.ModuleView.cid===a.cid?this:(c&&this.history.prepend(this.ModuleView),this.listenTo(KB.Events,"modal.refresh",this.reload),this.ModuleView=a,this.model=a.model,this.realmid=this.setupModuleId(),this.setupWindow(),this.attach(),this.render(),void this.recalibrate())},setupModuleId:function(){var a=this.model.get("parentObject");return this.model.get("globalModule")&&a?a.post_name:this.model.get("mid")},attach:function(){var a=this;this.listenTo(this.ModuleView,"kb.frontend.module.inline.saved",this.frontendViewUpdated),this.listenTo(this.model,"change:viewfile",function(){a.serialize(!1,!0),a.reload()}),this.listenTo(this.model,"data.updated",this.preview),this.listenTo(this.model,"remove",this.destroy)},reload:function(){this.render(!0)},detach:function(){this.FieldModels.reset(),this.stopListening(),KB.Events.trigger("modal.close",this)},destroy:function(){var a=this;this.stopListening(KB.Events,"modal.refresh",this.reload),a.detach(),a.history.reset(),jQuery(".wp-editor-area",this.$el).each(function(a,b){tinymce.remove("#"+b.id)}),a.ModuleView=null,a.unbind(),a.initialized=!1,a.$el.detach(),KB.Sidebar.visible&&KB.Sidebar.$el.css("width","")},setupWindow:function(){var a=this;KB.Sidebar.visible?(this.$el.appendTo(KB.Sidebar.$el),this.mode="sidebar",this.listenToOnce(KB.Sidebar,"sidebar.close",function(){this.mode="body",this.$el.removeClass("kb-modal-sidebar"),this.destroy()}),KB.Sidebar.clearTimer()):(this.mode="body",this.$el.appendTo("body").show()),"body"===this.mode&&this.$el.css("position","fixed").draggable({handle:"h2",containment:"window",stop:function(b,c){a.recalibrate(c.position)}})},frontendViewUpdated:function(){this.$el.removeClass("isDirty"),this.reload()},preview:function(){this.serialize(!1,!1)},update:function(){this.serialize(!0,!0),this.switchDraftOff()},render:function(a){var b,c=this;d.User.info("Frontend modal retrieves data from the server"),b=this.model.toJSON(),this.applyControlsSettings(this.$el),jQuery.ajax({url:ajaxurl,data:{action:"getModuleForm",module:b,entityData:b.entityData,_ajax_nonce:g.getNonce("read")},type:"POST",dataType:"json",beforeSend:function(){c.LoadingAnimation.show()},success:function(b){c.$inner.empty(),c.ModuleView.clearFields(),c.$inner.attr("id",c.model.get("mid")),c.$inner.append(b.data.html),c.model.get("state").draft?c.$draft.show(150):c.$draft.hide();var e=window.tinymce,f=e.$;f(document).on("click",function(a){var b,c,d=f(a.target);d.hasClass("wp-switch-editor")&&(b=d.attr("data-wp-editor-id"),c=d.hasClass("switch-tmce")?"tmce":"html",window.switchEditors.go(b,c))}),b.data.json&&(KB.payload=_.extend(KB.payload,b.data.json),b.data.json.Fields&&(c.FieldModels.reset(),c.FieldModels.add(_.toArray(b.data.json.Fields)))),h.initTabs(),h.initToggleBoxes(),i.addEditor(c.$form),d.User.info("Frontend modal done."),c.$title.text(c.model.get("settings").name),a&&c.FieldModels.length>0&&KB.Events.trigger("modal.reload"),setTimeout(function(){c.$el.show(),c.recalibrate(),c.LoadingAnimation.hide()},550)},error:function(){j.notice("There went something wrong","error")}})},recalibrate:function(){var a,b,c,d;if(a=jQuery(window).height()-16,b=jQuery(".os-content-inner").height(),c=this.$el.position(),d=b+c.top-a,d>0?this.initScrollbars(b-(d+30)):b-c.top<a?this.initScrollbars(b):this.initScrollbars(a-c.top),c.top<32&&this.$el.css("top","32px"),"sidebar"===this.mode){var e=this.model.get("settings"),f=e.controls&&e.controls.width||600;KB.Sidebar.$el.width(f),this.$el.addClass("kb-modal-sidebar"),this.$el.width(f)}},initScrollbars:function(a){jQuery(".kb-nano",this.$el).height(a+20),jQuery(".kb-nano").nanoScroller({preventPageScrolling:!0,contentClass:"kb-nano-content"})},serialize:function(a,b){var c=this,d=a||!1,e=b!==!1;tinymce.triggerSave();var f=this.formdataForId(this.realmid);this.model.set("entityData",f),this.LoadingAnimation.show(.5),this.model.sync(d,this).done(function(a,b,f){c.moduleUpdated(a,b,f,d,e)})},moduleUpdated:function(a,b,c,d,e){var f=this;a.data.json&&a.data.json.Fields&&KB.FieldControls.updateModels(a.data.json.Fields),f.model.trigger("modal.serialize.before"),f.updateViewClassTo!==!1&&f.updateContainerClass(f.updateViewClassTo),f.ModuleView.trigger("modal.before.nodeupdate"),f.ModuleView.$el.html(a.data.html),f.ModuleView.trigger("modal.after.nodeupdate"),f.model.set("entityData",a.data.newModuleData),d&&(f.model.trigger("module.model.updated",f.model),KB.Events.trigger("modal.saved")),jQuery(document).trigger("kb.module-update",f.model.get("settings").id,f.ModuleView),jQuery(document).trigger("kb.refresh"),f.ModuleView.delegateEvents(),setTimeout(function(){f.ModuleView.render(),f.model.trigger("modal.serialize")},400),d?(e&&j.notice(KB.i18n.jsFrontend.frontendModal.noticeDataSaved,"success"),f.$el.removeClass("isDirty"),f.ModuleView.getClean()):(e&&j.notice(KB.i18n.jsFrontend.frontendModal.noticePreviewUpdated,"success"),f.$el.addClass("isDirty")),f.ModuleView.trigger("kb.view.module.HTMLChanged"),f.LoadingAnimation.hide()},viewfileChange:function(a){this.updateViewClassTo={current:this.ModuleView.model.get("viewfile"),target:a.currentTarget.value},this.model.set("viewfile",a.currentTarget.value)},updateContainerClass:function(a){return a&&a.current&&a.target?(this.ModuleView.$el.removeClass(this._classifyView(a.current)),this.ModuleView.$el.addClass(this._classifyView(a.target)),void(this.updateViewClassTo=!1)):!1},delayInput:function(){var a=this;this.timerId&&clearTimeout(this.timerId),this.timerId=setTimeout(function(){a.timerId=null,a.serialize(!1,!1)},750)},attachEditorEvents:function(a){var b=this;a.onKeyUp.add(function(){b.delayInput()})},applyControlsSettings:function(a){var b=this.model.get("settings"),c=b.controls&&b.controls.width;c&&a.css("width",b.controls.width+"px"),"sidebar"===this.mode&&c&&KB.Sidebar.$el.width(c),b.controls&&b.controls.fullscreen?a.width("100%").height("100%").addClass("fullscreen"):a.height("").removeClass("fullscreen")},_classifyView:function(a){return"view-"+a.replace(".twig","")},switchDraftOff:function(){var a=this.model.toJSON(),b=this;this.model.get("state").draft&&k.send({action:"undraftModule",module:a,postId:this.model.get("parentObjectId"),_ajax_nonce:g.getNonce("update")},function(a){a.success&&b.$draft.hide(150)},this)},formdataForId:function(a){if(!a)return null;var b=this.$form.serializeJSON();return b[a]?b[a]:null}})},{"common/Ajax":9,"common/Config":11,"common/Logger":13,"common/Notice":14,"common/TinyMCE":18,"common/UI":19,"frontend/Collections/ModalFieldCollection":76,"frontend/Views/EditModalHistory":95,"frontend/Views/LoadingAnimation":97,"templates/frontend/module-edit-form.hbs":153}],97:[function(a,b,c){b.exports=Backbone.View.extend({$overlay:jQuery('<div class="kb-loading-overlay" style="display: none;"><span class="kb-loading-loader"><span class="kb-loading-loader-inner"></span></span></div>'),initialize:function(){this.$el.css("position","relative").append(this.$overlay)},show:function(a){a?this.$overlay.fadeTo(150,a):this.$overlay.show()},hide:function(){this.$overlay.fadeOut(350)}})},{}],98:[function(a,b,c){var d=a("./modulecontrols/EditControl"),e=a("./modulecontrols/UpdateControl"),f=a("./modulecontrols/DeleteControl"),g=a("./modulecontrols/MoveControl"),h=a("templates/frontend/module-controls.hbs");b.exports=Backbone.View.extend({ModuleView:null,$menuList:null,initialize:function(a){this.ModuleView=a.ModuleView},derender:function(){this.$el.detach()},rerender:function(){var a=this;this.ModuleView.$el.append(this.$el),_.defer(function(){a.reposition()})},render:function(){this.ModuleView.$el.append(h({model:this.ModuleView.model.toJSON(),i18n:KB.i18n.jsFrontend})),this.$el=jQuery('[data-kb-mcontrols="'+this.model.get("mid")+'"]',this.ModuleView.$el),this.$menuList=this.$(".kb-controls-wrap"),this.EditControl=this.addItem(new d({model:this.ModuleView.model,parent:this.ModuleView})),this.UpdateControl=this.addItem(new e({model:this.ModuleView.model,parent:this.ModuleView})),this.DeleteControl=this.addItem(new f({model:this.ModuleView.model,parent:this.ModuleView})),this.MoveControl=this.addItem(new g({model:this.ModuleView.model,parent:this.ModuleView}))},addItem:function(a){return a.isValid&&a.isValid()===!0?(this.$menuList.append(a.render()),a.listenToOnce(this,"controls.remove",a.remove),a):void 0},dispose:function(){this.trigger("controls.remove"),this.remove()},reposition:function(){var a,b,c,d,e,f;a=0,b=0,c=this.model.get("settings"),d=this.model.get("submodule"),e=this.ModuleView.$el.offset(),f=this.ModuleView.$el.height(),c.controls&&c.controls.toolbar&&(e.top=c.controls.toolbar.top,e.left=c.controls.toolbar.left),"hidden"!==this.ModuleView.$el.css("overflow")&&e.top>60&&119>f&&(a=-25),"hidden"!==this.ModuleView.$el.css("overflow")&&e.left>100&&f>120&&this.ModuleView.$el["class"]&&(a=0,b=-30,this.ModuleView.$el.addClass("kb-module-nav__vertical")),e.top<20&&(a=10),0==a&&(a=20),0==b&&(b=20),d&&(a+=50),this.$el.css({top:a+"px",left:b})}})},{"./modulecontrols/DeleteControl":100,"./modulecontrols/EditControl":101,"./modulecontrols/MoveControl":102,"./modulecontrols/UpdateControl":103,"templates/frontend/module-controls.hbs":152}],99:[function(a,b,c){b.exports=Backbone.View.extend({tagName:"div",isValid:function(){return!0},render:function(){return this.el},dispose:function(){this.remove()}})},{}],100:[function(a,b,c){var d=a("frontend/Views/ModuleControls/modulecontrols/ControlsBaseView"),e=a("common/Checks"),f=a("common/Config"),g=a("common/Notice"),h=a("common/Ajax");b.exports=d.extend({initialize:function(a){this.options=a||{},this.Parent=a.parent},className:"kb-module-control kb-module-control--delete",events:{click:"confirmRemoval"},confirmRemoval:function(){g.confirm("Remove",KB.i18n.EditScreen.notices.confirmDeleteMsg,this.removeModule,this.cancelRemoval,this)},removeModule:function(){var a=this;h.send({action:"removeModules",_ajax_nonce:f.getNonce("delete"),module:a.model.get("mid"),postId:a.model.get("postId")},this.afterRemoval,this)},afterRemoval:function(){this.Parent.$el.parent(".kb-wrap").remove(),this.trigger("remove"),KB.Modules.remove(this.model)},cancelRemoval:function(){return!1},isValid:function(){return e.userCan("delete_kontentblocks")}})},{"common/Ajax":9,"common/Checks":10,"common/Config":11,"common/Notice":14,"frontend/Views/ModuleControls/modulecontrols/ControlsBaseView":99}],101:[function(a,b,c){var d=a("frontend/Views/ModuleControls/modulecontrols/ControlsBaseView"),e=a("common/Checks");b.exports=d.extend({initialize:function(a){this.options=a||{},this.Parent=a.parent},className:"kb-module-control kb-module-control--edit",events:{click:"openForm"},openForm:function(){return KB.EditModalModules.openView(this.Parent),KB.focusedModule=this.model,this},isValid:function(){return e.userCan("edit_kontentblocks")},success:function(){}})},{"common/Checks":10,"frontend/Views/ModuleControls/modulecontrols/ControlsBaseView":99}],102:[function(a,b,c){var d=a("frontend/Views/ModuleControls/modulecontrols/ControlsBaseView"),e=a("common/Checks");b.exports=d.extend({initialize:function(a){this.options=a||{},this.Parent=a.parent},className:"kb-module-control kb-module-control--move",isValid:function(){return this.Parent.model.Area?e.userCan("edit_kontentblocks")&&this.Parent.model.Area.get("sortable")&&!this.model.get("submodule"):!1}})},{"common/Checks":10,"frontend/Views/ModuleControls/modulecontrols/ControlsBaseView":99}],103:[function(a,b,c){var d=a("frontend/Views/ModuleControls/modulecontrols/ControlsBaseView"),e=a("common/Checks"),f=a("common/Config"),g=a("common/Notice");b.exports=d.extend({initialize:function(a){this.options=a||{},this.Parent=a.parent},className:"kb-module-control kb-module-control--update",events:{click:"update"},update:function(){var a=this,b=!1;jQuery.ajax({url:ajaxurl,data:{action:"updateModule",data:a.model.get("entityData"),module:a.model.toJSON(),editmode:"update",refresh:b,_ajax_nonce:f.getNonce("update")},type:"POST",dataType:"json",success:function(c){b&&a.$el.html(c.html),tinymce.triggerSave(),a.model.set("entityData",c.data.newModuleData),a.Parent.render(),a.Parent.trigger("kb.frontend.module.inline.saved"),a.model.trigger("module.model.updated",a.model),g.notice("Module saved successfully","success"),a.Parent.$el.removeClass("isDirty")},error:function(){g.notice("There went something wrong","error")}})},isValid:function(){return e.userCan("edit_kontentblocks")}})},{"common/Checks":10,"common/Config":11,"common/Notice":14,"frontend/Views/ModuleControls/modulecontrols/ControlsBaseView":99}],104:[function(a,b,c){var d=a("frontend/Views/ModuleControls/ModuleControls"),e=a("common/Checks"),f=a("templates/frontend/module-placeholder.hbs");b.exports=Backbone.View.extend({focus:!1,attachedFields:{},initialize:function(){this.Controls=new d({ModuleView:this,model:this.model}),e.userCan("edit_kontentblocks")&&(this.model.View=this,this.model.trigger("module.model.view.attached",this),this.bindHandlers(),this.render(),KB.Events.on("reposition",this.setControlsPosition,this))},bindHandlers:function(){this.listenTo(this.model,"change",this.getDirty),this.listenTo(this.model,"module.model.updated",this.getClean),this.listenTo(this.model,"module.model.clean",this.getClean)},events:{"click .kb-module__placeholder":"openOptions","click .editable":"reloadModal","mouseenter.first":"setActive"},openOptions:function(){this.Controls.EditControl.openForm()},setActive:function(){KB.currentModule=this},rerender:function(){var a=this;this.setElement(jQuery("#"+this.model.get("mid"))),_.defer(function(){a.Controls.rerender()})},derender:function(){this.Controls.derender(),this.$el.remove()},render:function(){var a;this.$el.hasClass("draft")&&""===this.model.get("entityData")&&this.renderPlaceholder(),this.$el.attr("rel",this.model.get("mid")+"_"+_.uniqueId()),a=this.model.get("settings"),a.controls&&a.controls.hide||(this.Controls.render(),this.setControlsPosition())},setControlsPosition:function(){this.Controls.reposition()},reloadModal:function(a){return KB.EditModalModules&&KB.EditModalModules.reload(this,a),KB.CurrentModel=this.model,KB.focusedModule=this.model,this},renderPlaceholder:function(){this.$el.append(f({model:this.model.toJSON()}))},addField:function(a){this.attachedFields[a.cid]=a},hasField:function(a,b){return _.isEmpty(b)?a in this.attachedFields:(this.attachedFields[b]||(this.attachedFields[b]={}),a in this.attachedFields[b])},getField:function(a,b){return _.isEmpty(b)?this.attachedFields[a]:this.attachedFields[b][a]},clearFields:function(){this.attachedFields={}},getDirty:function(){this.$el.addClass("isDirty"),this.trigger("view.became.dirty",this)},getClean:function(){this.$el.removeClass("isDirty"),this.trigger("view.became.clean",this)},modelChange:function(){this.getDirty()},dispose:function(){this.Controls.dispose(),delete this.model.View,this.stopListening(),this.remove()}})},{"common/Checks":10,"frontend/Views/ModuleControls/ModuleControls":98,"templates/frontend/module-placeholder.hbs":154}],105:[function(a,b,c){b.exports=Backbone.View.extend({initialize:function(){this.model.View=this},getDirty:function(){},getClean:function(){}})},{}],106:[function(a,b,c){var d=a("frontend/Views/Sidebar/AreaOverview/AreaOverviewController"),e=a("frontend/Views/Sidebar/AreaDetails/CategoryFilter"),f=a("frontend/Views/Sidebar/SidebarHeader"),g=a("common/Utilities"),h=a("frontend/Views/Sidebar/PanelOverview/PanelOverviewController"),i=a("templates/frontend/sidebar/sidebar-nav.hbs");b.exports=Backbone.View.extend({currentView:null,viewStack:[],timer:0,initialize:function(){this.render(),this.states={};var a=i({});this.$navControls=jQuery(a),this.bindHandlers(),this.states.AreaList=new d({controller:this}),this.states.PanelList=new h({controller:this}),this.CategoryFilter=new e,this.setView(this.states.AreaList),this.$el.addClass("ui-widget-content"),this.$el.resizable({maxWidth:900,minWidth:340,handles:"e"})},events:{"click .kb-js-sidebar-nav-back":"rootView","click [data-kb-action]":"actionHandler",mouseleave:"detectActivity",mouseenter:"clearTimer"},detectActivity:function(){var a=this;this.timer=setTimeout(function(){a.$el.addClass("kb-opaque")},15e3)},clearTimer:function(){var a=this;this.timer&&(clearTimeout(this.timer),a.$el.removeClass("kb-opaque"))},render:function(){this.$el=jQuery('<div class="kb-sidebar-wrap" style="display: none;"></div>').appendTo("body"),this.$toggle=jQuery('<div class="kb-sidebar-wrap--toggle cbutton cbutto-effect--boris"></div>').appendTo("body"),this.Header=new f({}),this.$el.append(this.Header.render()),this.$container=jQuery('<div class="kb-sidebar-wrap__container"></div>').appendTo(this.$el),this.$extension=jQuery('<div class="kb-sidebar-extension" style="display: none;"></div>').appendTo(this.$el),this.setLayout();var a=g.stex.get("kb-sidebar-visible");a&&(this.toggleSidebar(),this.detectActivity()),this.delegateEvents()},bindHandlers:function(){var a=this;jQuery(window).resize(function(){a.setLayout()}),this.$toggle.on("click",function(){a.toggleSidebar()})},setLayout:function(){var a=jQuery(window).height();this.$el.width();this.$el.height(a),this.$extension.height(a)},setExtendedView:function(a){this.currentExtendedView&&this.currentExtendedView.$el.detach(),this.currentExtendedView=a,this.$extension.html(a.render()),this.$extension.show()},closeExtendedView:function(){this.currentExtendedView.$el.detach(),this.currentExtendedView=null,this.$extension.html(""),this.$extension.hide()},setView:function(a){this.currentView&&this.currentView.$el.detach(),this.currentView=a,this.viewStack.push(a),this.$container.html(a.render()),this.handleNavigationControls()},prevView:function(){var a=this.viewStack.shift();a&&this.setView(a)},rootView:function(){this.viewStack=[],this.setView(this.states.AreaList)},handleNavigationControls:function(){this.viewStack.length>=2?this.$navControls.prependTo(this.$container):this.$navControls.detach()},toggleSidebar:function(){this.visible=!this.visible,this.$el.toggle(0),jQuery("body").toggleClass("kb-sidebar-visible"),g.stex.set("kb-sidebar-visible",this.visible,36e5),this.visible?this.trigger("sidebar.open"):this.trigger("sidebar.close")},actionHandler:function(a){var b=jQuery(a.currentTarget).data("kb-action");b&&this.states[b]&&this.setView(this.states[b])}})},{"common/Utilities":20,"frontend/Views/Sidebar/AreaDetails/CategoryFilter":109,"frontend/Views/Sidebar/AreaOverview/AreaOverviewController":112,"frontend/Views/Sidebar/PanelOverview/PanelOverviewController":116,"frontend/Views/Sidebar/SidebarHeader":118,"templates/frontend/sidebar/sidebar-nav.hbs":165}],107:[function(a,b,c){var d=a("frontend/Views/Sidebar/AreaDetails/CategoryController"),e=(a("common/Config"),a("common/Notice"),a("common/Ajax"),a("templates/frontend/sidebar/area-details-header.hbs"));b.exports=Backbone.View.extend({tagName:"div",className:"kb-sidebar__module-list",initialize:function(a){this.controller=a.controller,this.sidebarController=a.sidebarController,this.categories=this.sidebarController.CategoryFilter.filter(this.model),this.renderHeader(),this.renderCategories()},events:{"click .kb-sidebar-action--cog":"toggle","click .kb-sidebar-action--update":"updateAreaSettings"},render:function(){return this.$el},renderHeader:function(){this.$el.append(e(this.model.toJSON())),this.$settingsContainer=this.$el.find(".kb-sidebar-area-details__settings"),this.$updateHandle=this.$el.find(".kb-sidebar-action--update").hide()},renderCategories:function(){var a=this;_.each(this.categories.toJSON(),function(b,c){var e=new d({model:new Backbone.Model(b),controller:a});a.$el.append(e.render())})},toggle:function(){this.$settingsContainer.slideToggle()}})},{"common/Ajax":9,"common/Config":11,"common/Notice":14,"frontend/Views/Sidebar/AreaDetails/CategoryController":108,"templates/frontend/sidebar/area-details-header.hbs":155}],108:[function(a,b,c){var d=a("frontend/Views/Sidebar/AreaDetails/ModuleDragItem"),e=a("templates/frontend/sidebar/category-list.hbs");b.exports=Backbone.View.extend({tagName:"div",className:"kb-sidebar__module-category",initialize:function(a){this.controller=a.controller,this.$el.append(e(this.model.toJSON())),this.$list=this.$el.find("ul"),this.setupModuleItems()},render:function(){return this.$el},setupModuleItems:function(){var a=this;_.each(this.model.get("modules"),function(b){var c=new d({model:new Backbone.Model(b),listController:a.controller,controller:a});a.$list.append(c.render())})}})},{"frontend/Views/Sidebar/AreaDetails/ModuleDragItem":110,"templates/frontend/sidebar/category-list.hbs":156}],109:[function(a,b,c){var d=a("common/Payload");b.exports=Backbone.View.extend({categories:d.getPayload("ModuleCategories"),definitions:d.getPayload("ModuleDefinitions"),initialize:function(){this.setupSortTable()},filter:function(a){var b=this.setupSortTable(),c=a.get("assignedModules");
return _.each(this.definitions,function(a,d){-1!==_.indexOf(c,d)&&(b[a.settings.category].modules[d]=a)}),new Backbone.Model(this.removeEmptyCats(b))},setupSortTable:function(){var a={};return _.each(this.categories,function(b,c){a[c]={name:b,id:c,modules:{}}}),a},removeEmptyCats:function(a){return _.each(a,function(b,c){_.isEmpty(b.modules)&&delete a[c]}),a.core&&delete a.core,a}})},{"common/Payload":15}],110:[function(a,b,c){var d=a("common/Payload"),e=a("common/Notice"),f=a("common/Config"),g=a("common/Checks"),h=(a("frontend/Models/ModuleModel"),a("frontend/Views/AreaView")),i=a("common/Ajax"),j=a("templates/frontend/sidebar/category-module-item.hbs");b.exports=Backbone.View.extend({tagName:"li",className:"kb-sidebar-module",initialize:function(a){var b=this;this.controller=a.controller,this.listController=a.listController,this.$el.append(j(this.model.toJSON())),this.model.set("area",this.listController.model);var c=this.model.get("area").get("renderSettings").moduleElement||"div";this.$dropHelper=jQuery("<"+c+" class='kb-sidebar-drop-helper ui-sortable-helper'></"+c+">"),this.$el.draggable({appendTo:b.listController.model.View.$el.selector,revert:"invalid",refreshPositions:!0,cursorAt:{top:5,left:5},stop:function(){b.listController.model.View.$el.css("overflow","")},helper:function(){b.listController.model.View.$el.css("overflow","hidden");var a=b.findHelperSize(b.model.get("area").View);return b.$dropHelper.width(a.width).height(a.height),b.$dropHelper},drag:function(){b.$dropHelper.css("zIndex","10000")},connectToSortable:this.listController.model.View.$el.selector}).data("module",this)},render:function(){return this.$el},create:function(a){var b,c,d;return g.userCan("create_kontentblocks")||e.notice("You're not allowed to do this","error"),b=KB.Areas.get(this.model.get("area").get("id")),g.blockLimit(b)?(d=this.model,c={action:"createNewModule","class":d.get("settings")["class"],globalModule:d.get("globalModule"),parentObject:d.get("parentObject"),areaContext:b.get("context"),renderSettings:b.get("renderSettings"),area:b.get("id"),_ajax_nonce:f.getNonce("create"),frontend:KB.appData.config.frontend},this.model.get("area").get("parent_id")&&(c.postId=this.model.get("area").get("parent_id")),void i.send(c,this.success,this,{ui:a})):(e.notice("Limit for this area reached","error"),!1)},success:function(a,b){var c,e=this;b.ui.helper.replaceWith(a.data.html),c=KB.Modules.add(a.data.module),KB.ObjectProxy.add(c),c.Area.View.Layout.applyClasses(),h.prototype.resort(this.model.get("area")),e.model.get("area").trigger("kb.module.created"),_.defer(function(){d.parseAdditionalJSON(a.data.json),KB.Events.trigger("content.change reposition"),KB.App.adminBar.isActive()&&c.trigger("module.create")})},findHelperSize:function(a){var b=[],c=[];return _.each(a.attachedModuleViews,function(a){b.push(a.View.$el.width()),c.push(a.View.$el.height())}),{width:Math.max.apply(Math,b)-10,height:Math.max.apply(Math,c)-10}}})},{"common/Ajax":9,"common/Checks":10,"common/Config":11,"common/Notice":14,"common/Payload":15,"frontend/Models/ModuleModel":91,"frontend/Views/AreaView":94,"templates/frontend/sidebar/category-module-item.hbs":157}],111:[function(a,b,c){var d=a("frontend/Views/Sidebar/AreaOverview/ModuleListItem"),e=a("frontend/Views/Sidebar/AreaDetails/AreaDetailsController"),f=a("templates/frontend/sidebar/empty-area.hbs");b.exports=Backbone.View.extend({tagName:"ul",className:"kb-sidebar-areaview__modules-list",ModuleViews:{},initialize:function(a){this.Modules=new Backbone.Collection,this.$parent=a.$el,this.controller=a.controller,this.sidebarController=a.sidebarController,this.$toggleHandle=this.$parent.find(".kb-sidebar-areaview__title"),this.ModuleList=new e({controller:a.controller,sidebarController:a.sidebarController,model:this.model}),this.render(),this.bindHandlers()},render:function(){this.$el.appendTo(this.$parent).hide()},bindHandlers:function(){var a=this;this.listenTo(this.Modules,"add",this.renderModuleItem),this.listenTo(this.model,"area.resorted",this.resortViews),this.$toggleHandle.on("click",function(){a.controller.setActiveList(a)}),this.$parent.on("click",".kb-js-sidebar-add-module",function(){a.sidebarController.setView(a.ModuleList)}),this.listenToOnce(KB.Events,"frontend.init",this.afterInit)},activate:function(){this.$parent.removeClass("kb-sidebar-areaview--inactive"),this.model.View.$el.addClass("kb-in-sidebar-active")},deactivate:function(){this.$parent.addClass("kb-sidebar-areaview--inactive"),this.model.View.$el.removeClass("kb-in-sidebar-active")},renderModuleItem:function(a){this.ModuleViews[a.id]=View=new d({$parent:this.$el,model:a}),View.$el.appendTo(this.$el)},attachModuleView:function(a){this.Modules.add(a.model),this.listenToOnce(a.model,"remove",this.removeModuleView)},removeModuleView:function(a){var b=this.ModuleViews[a.id];this.Modules.remove(a),delete this.ModuleViews[a.id],b.dispose()},afterInit:function(){0===this.Modules.models.length&&this.model.View.$el.is(":visible")&&this.$el.append(f({}))},moduleOrder:function(){var a=this.model.View.$el,b=jQuery("[id^=module]",a);return _.pluck(b,"id")},resortViews:function(){var a=this,b=this.moduleOrder().reverse();_.each(b,function(b){var c=a.ModuleViews[b];c.$el.detach(),c.$el.prependTo(a.$el)})}})},{"frontend/Views/Sidebar/AreaDetails/AreaDetailsController":107,"frontend/Views/Sidebar/AreaOverview/ModuleListItem":113,"templates/frontend/sidebar/empty-area.hbs":158}],112:[function(a,b,c){var d=a("frontend/Views/Sidebar/AreaOverview/AreaListItem"),e=a("templates/frontend/sidebar/sidebar-area-view.hbs"),f=a("templates/frontend/sidebar/root-item.hbs");b.exports=Backbone.View.extend({tagName:"div",className:"kb-sidebar-main-panel",Areas:new Backbone.Collection,AreaViews:{},activeList:null,events:{"click .kb-sidebar-areaview__title":"toggleList"},initialize:function(a){this.sidebarController=a.controller,this.render(),this.bindHandlers()},render:function(){return this.$el},bindHandlers:function(){this.listenTo(KB.Views.Areas,"view:add",this.attachAreaView),this.listenTo(KB.Views.Modules,"view:add",this.attachModuleView),this.listenTo(this.Areas,"add",this.createAreaItem)},attachAreaView:function(a){a.el&&this.Areas.add(a.model)},attachModuleView:function(a){var b=this.AreaViews[a.model.get("area")];b&&b.attachModuleView(a)},createAreaItem:function(a){if(!a.get("internal")){var b=jQuery(e(a.toJSON())).appendTo(this.$el);this.AreaViews[a.get("id")]=new d({$el:b,controller:this,sidebarController:this.sidebarController,model:a})}},setActiveList:function(a){return this.activeList&&this.activeList.cid?this.activeList.cid===a.cid?!1:(this.activeList.$el.slideUp(),this.activeList.deactivate(),this.activeList=null,this.setActiveList(a),void 0):(this.activeList=a,a.$el.slideDown(),a.activate(),!0)},renderRootItem:function(){return this.sidebarController.$container.append(f({text:"Areas",id:"AreaList"}))}})},{"frontend/Views/Sidebar/AreaOverview/AreaListItem":111,"templates/frontend/sidebar/root-item.hbs":162,"templates/frontend/sidebar/sidebar-area-view.hbs":163}],113:[function(a,b,c){var d=a("templates/frontend/sidebar/module-view-item.hbs");b.exports=Backbone.View.extend({tagName:"li",initialize:function(a){this.$parent=a.$parent,this.parentView=this.model.View,this.bindHandlers(),this.render()},events:{mouseenter:"over",mouseleave:"out",click:"scrollTo","click .kb-sidebar-item__edit":"openControls","click .kb-js-inline-update":"inlineUpdate","click .kb-js-inline-delete":"inlineDelete"},bindHandlers:function(){this.listenTo(this.model,"change",this.getDirty),this.listenTo(this.model,"module.model.updated",this.getClean),this.listenTo(this.model,"module.model.clean",this.getClean)},getDirty:function(){this.$el.addClass("kb-module-dirty")},getClean:function(){this.$el.removeClass("kb-module-dirty")},over:function(){this.parentView.$el.addClass("kb-in-sidebar-active")},out:function(){this.parentView.$el.removeClass("kb-in-sidebar-active")},openControls:function(a){a.stopPropagation(),this.parentView.openOptions()},inlineUpdate:function(a){a.stopPropagation(),this.parentView.Controls.UpdateControl.update(),this.parentView.getClean()},inlineDelete:function(a){a.stopPropagation(),this.parentView.Controls.DeleteControl.confirmRemoval()},scrollTo:function(){var a=this;jQuery("html, body").animate({scrollTop:a.parentView.$el.offset().top-100},750)},render:function(){this.$el.append(d({view:this.model.toJSON()}))},dispose:function(){this.stopListening(),this.remove(),delete this.model,delete this.parentView}})},{"templates/frontend/sidebar/module-view-item.hbs":159}],114:[function(a,b,c){var d=a("common/Config"),e=a("common/Payload"),f=a("common/UI"),g=a("templates/frontend/sidebar/option-panel-details.hbs");b.exports=Backbone.View.extend({tagName:"div",className:"kb-sidebar__option-panel-wrap",initialize:function(a){this.Controller=a.controller,this.parentView=a.parentView,this.$el.append(g({name:this.model.get("settings").baseId})),this.$form=this.$(".kb-sidebar__form-container")},events:{"click .kb-sidebar-action--update":"save","click .kb-sidebar-action--close":"close"},render:function(){return this.loadForm(),this.$el},save:function(){var a=this;jQuery.ajax({url:ajaxurl,data:{action:"saveStaticPanelForm",data:a.$form.serializeJSON(),panel:a.model.toJSON(),_ajax_nonce:d.getNonce("update")},type:"POST",dataType:"json",success:function(a){},error:function(){}})},loadForm:function(){var a=this;jQuery.ajax({url:ajaxurl,data:{action:"getStaticPanelForm",panel:a.model.toJSON(),_ajax_nonce:d.getNonce("read")},type:"POST",dataType:"json",success:function(b){a.model.trigger("modal.serialize.before"),a.$form.html(b.data.html),e.parseAdditionalJSON(b.data.json),a.model.trigger("modal.serialize"),f.initTabs(a.$el)},error:function(){}})},close:function(){this.model.trigger("modal.serialize.before"),this.parentView.closeDetails()}})},{"common/Config":11,"common/Payload":15,"common/UI":19,"templates/frontend/sidebar/option-panel-details.hbs":160}],115:[function(a,b,c){b.exports=Backbone.View.extend({tagName:"div",className:"kb-sidebar__panel-item",initialize:function(a){this.$parent=a.$parent,this.Controller=a.controller,this.render()},events:{click:"setupFormView"},render:function(){return this.$el.append(KB.Templates.render("frontend/sidebar/panel-list-item",{name:this.model.get("args").menu.name})),this.$parent.append(this.$el)},setupFormView:function(){this.FormView=new KB.Backbone.Sidebar.OptionsPanelFormView({model:this.model,controller:this.Controller,parentView:this}),this.Controller.sidebarController.setExtendedView(this.FormView)},closeDetails:function(){this.Controller.sidebarController.closeExtendedView()}})},{}],116:[function(a,b,c){var d=a("frontend/Views/Sidebar/PanelOverview/StaticPanelView"),e=a("frontend/Views/Sidebar/PanelOverview/OptionPanelView"),f=a("templates/frontend/sidebar/root-item.hbs");b.exports=Backbone.View.extend({tagName:"div",className:"kb-sidebar-main-panel panel-view",Panels:new Backbone.Collection,PanelViews:{option:{},"static":{}},activeList:null,initialize:function(a){this.sidebarController=a.controller,this.render(),this.bindHandlers()},render:function(){return this.$el},bindHandlers:function(){this.listenTo(KB.Panels,"add",this.createPanelItem)},createPanelItem:function(a){a.get("settings").frontend&&(a.get("type")&&"option"===a.get("type")&&(this.PanelViews.option[a.get("baseId")]=new e({model:a,$parent:this.$el,controller:this})),a.get("type")&&"static"===a.get("type")&&(this.PanelViews["static"][a.get("baseId")]=new d({model:a,$parent:this.$el,controller:this})))},renderRootItem:function(){return this.sidebarController.$container.append(f("frontend/sidebar/root-item",{text:"Panels",id:"PanelList"}))}})},{"frontend/Views/Sidebar/PanelOverview/OptionPanelView":115,"frontend/Views/Sidebar/PanelOverview/StaticPanelView":117,"templates/frontend/sidebar/root-item.hbs":162}],117:[function(a,b,c){var d=a("templates/frontend/sidebar/panel-list-item.hbs"),e=a("frontend/Views/Sidebar/PanelDetails/StaticPanelFormView");b.exports=Backbone.View.extend({tagName:"div",className:"kb-sidebar__panel-item",initialize:function(a){this.$parent=a.$parent,this.Controller=a.controller,this.render()},events:{click:"setupFormView"},render:function(){return this.$el.append(d({name:this.model.get("settings").baseId})),this.$parent.append(this.$el)},setupFormView:function(){this.FormView=new e({model:this.model,controller:this.Controller,parentView:this}),this.Controller.sidebarController.setExtendedView(this.FormView)},closeDetails:function(){this.Controller.sidebarController.closeExtendedView()}})},{"frontend/Views/Sidebar/PanelDetails/StaticPanelFormView":114,"templates/frontend/sidebar/panel-list-item.hbs":161}],118:[function(a,b,c){var d=a("templates/frontend/sidebar/sidebar-header.hbs");b.exports=Backbone.View.extend({tagName:"div",className:"kb-sidebar__header",initialize:function(){this.$el.append(d({}))},render:function(){return this.$el}})},{"templates/frontend/sidebar/sidebar-header.hbs":164}],119:[function(a,b,c){var d=a("common/Notice"),e=a("templates/frontend/change-observer.hbs"),f=a("common/I18n"),g=a("common/Config");b.exports=Backbone.View.extend({models:new Backbone.Collection,className:"kb-change-observer",initialize:function(){this.listenTo(KB.Modules,"add",this.attachHandler),this.render()},events:{"click .kb-button":"saveAll"},render:function(){this.$el.append(e({strings:f.getString("UI.changeObserver")})),this.$el.appendTo("body")},attachHandler:function(a){this.listenTo(a,"change:entityData",this.add),this.listenTo(a,"module.model.updated",this.remove),this.listenTo(a,"module.model.clean",this.remove)},add:function(a){this.models.add(a),this.trigger("change"),this.handleState()},remove:function(a){this.models.remove(a,{silent:!0}),this.trigger("change"),this.handleState()},getModels:function(){return this.models},saveAll:function(){tinyMCE.triggerSave(),_.each(this.models.models,function(a){a.sync(!0)}),g.isAdmin()||d.notice("Data is safe.","success"),this.trigger("change")},handleState:function(){var a=this.models.models.length;a>0?this.$el.addClass("show"):this.$el.removeClass("show")}})},{"common/Config":11,"common/I18n":12,"common/Notice":14,"templates/frontend/change-observer.hbs":151}],120:[function(a,b,c){var d=a("shared/ModuleBrowser/ModuleBrowserDefinitions"),e=a("shared/ModuleBrowser/ModuleDefinitionModel"),f=a("shared/ModuleBrowser/ModuleBrowserDescriptions"),g=a("shared/ModuleBrowser/ModuleBrowserNavigation"),h=a("common/Checks"),i=a("common/Notice"),j=a("common/Payload"),k=a("common/Ajax"),l=a("common/TinyMCE"),m=a("common/Config"),n=a("templates/backend/modulebrowser/module-browser.hbs");b.exports=Backbone.View.extend({initialize:function(a){this.options=a||{},this.isOpen=!1,this.area=this.options.area,this.viewMode=this.getViewMode(),this.modulesDefinitions=new d(this.prepareAssignedModules(),{model:e,area:this.options.area}).setup(),this.$el.append(n({viewMode:this.getViewModeClass()})),this.$backdrop=jQuery('<div class="kb-module-browser--backdrop"></div>'),this.$list=jQuery(".modules-list",this.$el),this.subviews.ModuleDescription=new f({el:jQuery(".module-description",this.$el),browser:this}),this.subviews.Navigation=new g({el:jQuery(".module-categories",this.$el),cats:this.modulesDefinitions.categories,browser:this}),this.listenTo(this.subviews.Navigation,"browser:change",this.update),this.bindHandlers()},tagName:"div",id:"module-browser",className:"kb-overlay",events:{"click .close-browser":"close","click .module-browser--switch__list-view":"toggleViewMode","click .module-browser--switch__excerpt-view":"toggleViewMode"},subviews:{},toggleViewMode:function(){jQuery(".module-browser-wrapper",this.$el).toggleClass("module-browser--list-view module-browser--excerpt-view");var a="mdb_"+this.area.model.get("id")+"_state",b=store.get(a);"list"==b?(this.viewMode="excerpt",store.set(a,"excerpt")):(this.viewMode="list",store.set(a,"list"))},render:function(){this.open()},getViewMode:function(){var a="mdb_"+this.area.model.get("id")+"_state";return store.get(a)?store.get(a):(store.set(a,"list"),"list")},getViewModeClass:function(){return"list"===this.viewMode?"module-browser--list-view":"module-browser--excerpt-view"},bindHandlers:function(){var a=this;jQuery("body").on("click",function(b){a.isOpen&&jQuery(b.target).is(".kb-module-browser--backdrop")&&a.close()}),jQuery(document).keydown(function(b){if(a.isOpen){switch(b.which){case 27:a.close();break;default:return}b.preventDefault()}})},open:function(){this.$el.appendTo("body"),this.$backdrop.appendTo("body"),jQuery("#wpwrap").addClass("module-browser-open"),jQuery(".kb-nano").nanoScroller({flash:!0,contentClass:"kb-nano-content"}),this.isOpen=!0},close:function(){jQuery("#wpwrap").removeClass("module-browser-open"),this.trigger("browser:close"),this.$backdrop.detach(),this.$el.detach(),this.isOpen=!1},update:function(a){var b=a.model.get("id");this.modulesDefinitions.getModules(b);a.renderList()},loadDetails:function(a){this.subviews.ModuleDescription.model=a,this.subviews.ModuleDescription.update()},createModule:function(a){var b,c;return h.userCan("create_kontentblocks")||i.notice("You're not allowed to do this","error"),b=KB.Areas.get(this.options.area.model.get("id")),h.blockLimit(b)?(c={action:"createNewModule","class":a.get("settings")["class"],globalModule:a.get("globalModule"),parentObject:a.get("parentObject"),parentObjectId:a.get("parentObjectId"),areaContext:this.options.area.model.get("context"),area:this.options.area.model.get("id"),_ajax_nonce:m.getNonce("create"),frontend:KB.appData.config.frontend,submodule:!1},this.options.area.model.get("parent_id")&&(c.postId=this.options.area.model.get("parent_id")),this.close(),void k.send(c,this.success,this)):(i.notice("Limit for this area reached","error"),!1)},success:function(a){var b,c;c=a.data,this.options.area.modulesList.append(c.html),b=KB.ObjectProxy.add(KB.Modules.add(c.module)),this.options.area.attachModuleView(b),this.parseAdditionalJSON(c.json),b.View.$el.addClass("kb-open"),setTimeout(function(){KB.Fields.trigger("newModule",b.View),l.addEditor(b.View.$el)},150),this.trigger("browser.module.created",{res:a})},parseAdditionalJSON:function(a){KB.payload.Fields||(KB.payload.Fields={}),_.extend(KB.payload.Fields,a.Fields),j.parseAdditionalJSON(a)},prepareAssignedModules:function(){var a=this.area.model.get("assignedModules"),b=[];return _.each(j.getPayload("ModuleDefinitions"),function(c){-1!==_.indexOf(a,c.settings["class"])&&b.push(c)}),KB.Events.trigger("module.browser.setup.defs",this,b),b}})},{"common/Ajax":9,"common/Checks":10,"common/Config":11,"common/Notice":14,"common/Payload":15,"common/TinyMCE":18,"shared/ModuleBrowser/ModuleBrowserDefinitions":121,"shared/ModuleBrowser/ModuleBrowserDescriptions":122,"shared/ModuleBrowser/ModuleBrowserNavigation":125,"shared/ModuleBrowser/ModuleDefinitionModel":127,"templates/backend/modulebrowser/module-browser.hbs":132}],121:[function(a,b,c){var d=a("common/Payload");b.exports=Backbone.Collection.extend({initialize:function(a,b){this.area=b.area},setup:function(){return this.categories=this.prepareCategories(),this.sortToCategories(),this},getModules:function(a){return this.categories[a].modules},getCategories:function(){return this.categories},sortToCategories:function(){var a=this;_.each(this.models,function(b){if(a.validateVisibility(b)){var c=_.isUndefined(b.get("settings").category)?"standard":b.get("settings").category;a.categories[c].modules.push(b)}})},validateVisibility:function(a){return a.get("settings").hidden?!1:a.get("settings").disabled?!1:!(!a.get("settings").globalModule&&this.area.model.get("dynamic"))},prepareCategories:function(){var a={},b=d.getPayload("ModuleCategories");return _.each(b,function(b,c){a[c]={id:c,name:b,modules:[]}}),KB.Events.trigger("module.browser.setup.cats",a),a}})},{"common/Payload":15}],122:[function(a,b,c){var d=a("common/Templates"),e=a("templates/backend/modulebrowser/module-template-description.hbs"),f=a("templates/backend/modulebrowser/module-description.hbs"),g=a("templates/backend/modulebrowser/poster.hbs");b.exports=Backbone.View.extend({initialize:function(a){this.options=a||{},this.Browser=a.browser,this.Browser.on("browser:close",this.close,this)},events:{"click .kb-js-create-module":"createModule"},update:function(){this.$el.empty(),this.model.get("template")?this.$el.html(e({module:this.model.toJSON()})):this.$el.html(f({module:this.model.toJSON()})),this.model.get("settings").poster!==!1&&this.$el.append(g({module:this.model.toJSON()})),this.model.get("settings").helpfile!==!1&&this.$el.append(d.render(this.model.get("settings").helpfile,{module:this.model.toJSON()}))},close:function(){},createModule:function(){this.Browser.createModule(this.model)}})},{"common/Templates":17,"templates/backend/modulebrowser/module-description.hbs":133,"templates/backend/modulebrowser/module-template-description.hbs":135,"templates/backend/modulebrowser/poster.hbs":137}],123:[function(a,b,c){var d=a("shared/ModuleBrowser/ModuleBrowserListItem");b.exports=Backbone.View.extend({initialize:function(a){this.options=a||{},this.cat=a.cat},modules:{},subviews:{},setModules:function(a){return this.modules=a,this},update:function(){var a=this,b=!1;this.$el.empty(),_.each(this.cat.model.get("modules"),function(c){a.subviews[c.cid]=new d({model:c,parent:a,browser:a.options.browser}),b===!1&&(a.options.browser.loadDetails(c),b=!b),a.$el.append(a.subviews[c.cid].render(a.$el))})},render:function(){}})},{"shared/ModuleBrowser/ModuleBrowserListItem":124}],124:[function(a,b,c){var d=a("templates/backend/modulebrowser/module-template-list-item.hbs"),e=a("templates/backend/modulebrowser/module-list-item.hbs");b.exports=Backbone.View.extend({tagName:"li",className:"modules-list-item",initialize:function(a){this.options=a||{},this.Browser=a.browser,this.area=a.browser.area},render:function(a){this.model.get("globalModule")?this.$el.html(d({module:this.model.toJSON()})):this.$el.html(e({module:this.model.toJSON()})),a.append(this.$el)},events:{click:"handleClick","click .kb-js-create-module":"handlePlusClick"},handleClick:function(){"list"===this.Browser.viewMode?this.createModule():this.Browser.loadDetails(this.model)},handlePlusClick:function(){return"list"===this.Browser.viewMode?(this.handleClick(),!1):void this.createModule()},createModule:function(){this.Browser.createModule(this.model)},close:function(){this.remove()}})},{"templates/backend/modulebrowser/module-list-item.hbs":134,"templates/backend/modulebrowser/module-template-list-item.hbs":136}],125:[function(a,b,c){var d=a("shared/ModuleBrowser/ModuleBrowserTabItemView");b.exports=Backbone.View.extend({catSet:!1,initialize:function(a){var b=this;this.options=a||{},this.$list=jQuery("<ul></ul>").appendTo(this.$el),_.each(this.options.cats,function(a){var c=new Backbone.Model(a);new d({parent:b,model:c,browser:b.options.browser}).render()})}})},{"shared/ModuleBrowser/ModuleBrowserTabItemView":126}],126:[function(a,b,c){var d=a("shared/ModuleBrowser/ModuleBrowserList");b.exports=Backbone.View.extend({initialize:function(a){if(this.options=a||{},this.model.get("listRenderer")){var b=this.model.get("listRenderer");this.listRenderer=new b({cat:this,el:a.browser.$list,browser:a.browser})}else this.listRenderer=new d({cat:this,el:a.browser.$list,browser:a.browser})},tagName:"li",className:"cat-item",events:{click:"change"},change:function(){this.options.parent.trigger("browser:change",this),this.$el.addClass("active"),jQuery("li").not(this.$el).removeClass("active")},render:function(){var a=_.keys(this.model.get("modules")).length,b="("+a+")";return 0===a?!1:(this.options.parent.catSet===!1&&(this.options.parent.catSet=!0,this.options.browser.update(this),this.$el.addClass("active")),void this.options.parent.$list.append(this.$el.html(this.model.get("name")+'<span class="module-count">'+b+"</span>")))},renderList:function(){this.listRenderer.update()}})},{"shared/ModuleBrowser/ModuleBrowserList":123}],127:[function(a,b,c){b.exports=Backbone.Model.extend({initialize:function(){var a=this;this.id=function(){return"template"===a.get("settings").category?a.get("mid"):a.get("settings")["class"]}()}})},{}],128:[function(a,b,c){KB.ViewsCollection=function(){this.views={},this.lastViewAdded=null,this.add=function(a,b){return this.views[a]||(this.views[a]=b,KB.trigger("kb:"+b.model.get("class")+":added",b),this.trigger("view:add",b),this.lastViewAdded=b),b},this.ready=function(){_.each(this.views,function(a){a.trigger("kb:"+a.model.get("class"),a),KB.trigger("kb:"+a.model.get("class")+":loaded",a)}),KB.trigger("kb:ready")},this.readyOnFront=function(){_.each(this.views,function(a){a.trigger("kb:"+a.model.get("class"),a),KB.trigger("kb:"+a.model.get("class")+":loadedOnFront",a)}),KB.trigger("kb:ready")},this.remove=function(a){var b=this.get(a);b.model.Area.View.trigger("kb.module.deleted",b),this.trigger("kb.modules.view.deleted",b),delete this.views[a],b.dispose()},this.get=function(a){return this.views[a]?this.views[a]:void 0},this.filterByModelAttr=function(a,b){return _.filter(this.views,function(c){return c.model.get(a)===b})}},_.extend(KB.ViewsCollection.prototype,Backbone.Events),b.exports=KB.ViewsCollection},{}],129:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){return'<div class="kb-context-bar grid__col grid__col--12-of-12">\n    <ul class="kb-context-bar--actions">\n\n    </ul>\n</div>'},useData:!0})},{"hbsfy/runtime":199}],130:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){return'<div class="kb-fullscreen--holder-wrap">\n    <div class="kb-fullscreen--controls">\n       <div class="kb-fullscreen-js-close"><span class="dashicons dashicons-no-alt"></span></div>\n    </div>\n    <div class="kb-fullscreen--inner">\n\n    </div>\n</div>'},useData:!0})},{"hbsfy/runtime":199}],131:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){return"<ul class='module-actions'></ul>"},useData:!0})},{"hbsfy/runtime":199}],132:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'<div class="module-browser-wrapper '+this.escapeExpression((e=null!=(e=b.viewMode||(null!=a?a.viewMode:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"viewMode",hash:{},data:d}):e))+'">\n\n    <div class="module-browser-header module-categories">\n        <a class="genericon genericon-close-alt close-browser kb-button"></a>\n        <a class="dashicons dashicons-list-view module-browser--switch__list-view "></a>\n        <a class="dashicons dashicons-exerpt-view module-browser--switch__excerpt-view "></a>\n    </div>\n\n    <div class="module-browser__left-column kb-nano">\n        <ul class="modules-list kb-nano-content">\n\n        </ul>\n    </div>\n\n    <div class="module-browser__right-column kb-nano">\n        <div class="module-description kb-nano-content">\n\n        </div>\n    </div>\n</div>'},useData:!0})},{"hbsfy/runtime":199}],133:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return"<h3>"+this.escapeExpression(this.lambda(null!=(e=null!=(e=null!=a?a.module:a)?e.settings:e)?e.publicName:e,a))+' <div class="kb-button-small kb-js-create-module">Add module</div>\n</h3>\n'},useData:!0})},{"hbsfy/runtime":199}],134:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f=this.lambda,g=this.escapeExpression;return'<div class="dashicons dashicons-plus kb-js-create-module"></div>\n<h4>'+g(f(null!=(e=null!=(e=null!=a?a.module:a)?e.settings:e)?e.name:e,a))+'</h4>\n<p class="description">'+g(f(null!=(e=null!=(e=null!=a?a.module:a)?e.settings:e)?e.description:e,a))+"</p>"},useData:!0})},{"hbsfy/runtime":199}],135:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return"<h3>"+this.escapeExpression(this.lambda(null!=(e=null!=(e=null!=a?a.module:a)?e.parentObject:e)?e.post_title:e,a))+"</h3>"},useData:!0})},{"hbsfy/runtime":199}],136:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'<div class="dashicons dashicons-plus kb-js-create-module"></div>\n<h4>'+this.escapeExpression(this.lambda(null!=(e=null!=(e=null!=a?a.module:a)?e.parentObject:e)?e.post_title:e,a))+"</h4>"},useData:!0})},{"hbsfy/runtime":199}],137:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'<div class="module-browser--poster-wrap">\n    <img src="'+this.escapeExpression(this.lambda(null!=(e=null!=(e=null!=a?a.module:a)?e.settings:e)?e.poster:e,a))+'" >\n</div>'},useData:!0})},{"hbsfy/runtime":199}],138:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f=this.lambda,g=this.escapeExpression;return'<div class="kb-field kb-js-field field-api-editor">\n    <label class="heading">'+g(f(null!=(e=null!=a?a.model:a)?e.label:e,a))+'</label>\n    <div class="kb-ff-editor-wrapper-'+g(f(null!=(e=null!=a?a.model:a)?e.index:e,a))+"-"+g(f(null!=(e=null!=a?a.model:a)?e.key:e,a))+'">\n    </div>\n    <p class="description">'+g(f(null!=(e=null!=a?a.model:a)?e.description:e,a))+"</p>\n</div>"},useData:!0})},{"hbsfy/runtime":199}],139:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f,g=b.helperMissing,h="function",i=this.escapeExpression;return'<input type="hidden" name="'+i((f=null!=(f=b.inputName||(null!=a?a.inputName:a))?f:g,typeof f===h?f.call(a,{name:"inputName",hash:{},data:d}):f))+'[_meta][uid]" value="'+i((f=null!=(f=b.uid||(null!=a?a.uid:a))?f:g,typeof f===h?f.call(a,{name:"uid",hash:{},data:d}):f))+'">\n<div class="flexible-fields--section-box">\n    <div class="flexible-fields--section-title">\n        <h3>\n            <span class="genericon genericon-draggable flexible-fields--js-drag-handle"></span>\n            <span class="dashicons dashicons-trash flexible-fields--js-trash"></span>\n            <input type="text" value="'+i(this.lambda(null!=(e=null!=a?a.item:a)?e.title:e,a))+'" name="'+i((f=null!=(f=b.inputName||(null!=a?a.inputName:a))?f:g,typeof f===h?f.call(a,{name:"inputName",hash:{},data:d}):f))+'[_meta][title] ">\n        </h3>\n    </div>\n    <div class="kb-field--tabs">\n        <ul class="flexible-field--tab-nav">\n\n        </ul>\n\n    </div>\n</div>'},useData:!0})},{"hbsfy/runtime":199}],140:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f,g=b.helperMissing,h="function",i=this.escapeExpression;return'<input type="hidden" name="'+i((f=null!=(f=b.inputName||(null!=a?a.inputName:a))?f:g,typeof f===h?f.call(a,{name:"inputName",hash:{},data:d}):f))+'[_meta][uid]" value="'+i((f=null!=(f=b.uid||(null!=a?a.uid:a))?f:g,typeof f===h?f.call(a,{name:"uid",hash:{},data:d}):f))+'">\n<div class="flexible-fields--toggle-title">\n    <h3>\n        <span class="genericon genericon-draggable flexible-fields--js-drag-handle"></span>\n        <span class="genericon genericon-expand flexible-fields--js-toggle"></span>\n        <span class="dashicons dashicons-trash flexible-fields--js-trash"></span>\n\n        <input type="text" value="'+i(this.lambda(null!=(e=null!=a?a.item:a)?e.title:e,a))+'" name="'+i((f=null!=(f=b.inputName||(null!=a?a.inputName:a))?f:g,typeof f===h?f.call(a,{name:"inputName",hash:{},data:d}):f))+'[_meta][title] ">\n    </h3>\n</div>\n<div class="flexible-fields--toggle-box kb-hide">\n    <div class="kb-field--tabs">\n        <ul class="flexible-field--tab-nav">\n\n        </ul>\n    </div>\n\n</div>'},useData:!0})},{"hbsfy/runtime":199
}],141:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'<div class="flexible-fields--header">\n    <a class="button button-primary kb-flexible-fields--js-add-item">'+this.escapeExpression(this.lambda(null!=(e=null!=a?a.i18n:a)?e.addNewItem:e,a))+'</a>\n</div>\n<ul class="flexible-fields--item-list"></ul>\n'},useData:!0})},{"hbsfy/runtime":199}],142:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f,g=b.helperMissing,h="function",i=this.escapeExpression,j=this.lambda;return'<div class="kb-gallery--header">\n    <h3>Image Details</h3>\n</div>\n<div class="kb-gallery--left-column">\n    <div class="kb-gallery--image-meta" style="display: none;">\n        <span class="genericon genericon-close-alt kb-gallery--js-meta-close"></span>\n\n        <div class="kb-field--tabs">\n            <ul class="kb-gallery--tabs-nav">\n                <li><a href="#tab'+i((f=null!=(f=b.uid||(null!=a?a.uid:a))?f:g,typeof f===h?f.call(a,{name:"uid",hash:{},data:d}):f))+'-1">Details</a></li>\n                <li><a href="#tab'+i((f=null!=(f=b.uid||(null!=a?a.uid:a))?f:g,typeof f===h?f.call(a,{name:"uid",hash:{},data:d}):f))+'-2">Beschreibung</a></li>\n            </ul>\n            <div id="tab'+i((f=null!=(f=b.uid||(null!=a?a.uid:a))?f:g,typeof f===h?f.call(a,{name:"uid",hash:{},data:d}):f))+'-1">\n                <div class="kb-gallery--meta-field kb-field">\n                    <label class="heading">Titel</label>\n                    <input class="large" type="text" name="'+i((f=null!=(f=b.inputName||(null!=a?a.inputName:a))?f:g,typeof f===h?f.call(a,{name:"inputName",hash:{},data:d}):f))+'[details][title]" value="'+i(j(null!=(e=null!=(e=null!=a?a.image:a)?e.details:e)?e.title:e,a))+'">\n                </div>\n                <div class="kb-gallery--meta-field kb-field">\n                    <label class="heading">Alt</label>\n                    <input class="large" type="text" name="'+i((f=null!=(f=b.inputName||(null!=a?a.inputName:a))?f:g,typeof f===h?f.call(a,{name:"inputName",hash:{},data:d}):f))+'[details][alt]" value="'+i(j(null!=(e=null!=(e=null!=a?a.image:a)?e.details:e)?e.alt:e,a))+'">\n                </div>\n            </div>\n\n            <div id="tab'+i((f=null!=(f=b.uid||(null!=a?a.uid:a))?f:g,typeof f===h?f.call(a,{name:"uid",hash:{},data:d}):f))+'-2">\n                <div class="kb-js--remote-editor" data-uid="'+i((f=null!=(f=b.uid||(null!=a?a.uid:a))?f:g,typeof f===h?f.call(a,{name:"uid",hash:{},data:d}):f))+'">\n                    <textarea name="'+i((f=null!=(f=b.inputName||(null!=a?a.inputName:a))?f:g,typeof f===h?f.call(a,{name:"inputName",hash:{},data:d}):f))+'[details][description]">'+i(j(null!=(e=null!=(e=null!=a?a.image:a)?e.details:e)?e.description:e,a))+'</textarea>\n                </div>\n\n            </div>\n        </div>\n    </div>\n</div>\n<div class="kb-gallery--right-column">\n    <div class="kb-gallery--image-holder">\n        <img src="'+i(j(null!=(e=null!=(e=null!=(e=null!=(e=null!=a?a.image:a)?e.file:e)?e.sizes:e)?e.thumbnail:e)?e.url:e,a))+'">\n        <span class="genericon genericon-edit kb-gallery--js-edit"></span>\n        <span class="genericon genericon-close-alt kb-gallery--js-delete"></span>\n        <input type="hidden" name="'+i((f=null!=(f=b.inputName||(null!=a?a.inputName:a))?f:g,typeof f===h?f.call(a,{name:"inputName",hash:{},data:d}):f))+'[id]" value="'+i(j(null!=(e=null!=a?a.image:a)?e.id:e,a))+'">\n        <input type="hidden" class="kb-gallery--image-remove" name="'+i((f=null!=(f=b.inputName||(null!=a?a.inputName:a))?f:g,typeof f===h?f.call(a,{name:"inputName",hash:{},data:d}):f))+'[remove]" value="">\n    </div>\n</div>'},useData:!0})},{"hbsfy/runtime":199}],143:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f,g=this.lambda,h=this.escapeExpression;return'<div class="kb-gallery--right-column">\n    <div class="kb-gallery--image-holder">\n        <img src="'+h(g(null!=(e=null!=a?a.image:a)?e.previewUrl:e,a))+'">\n        <input type="hidden" name="'+h((f=null!=(f=b.inputName||(null!=a?a.inputName:a))?f:b.helperMissing,"function"==typeof f?f.call(a,{name:"inputName",hash:{},data:d}):f))+'" value="'+h(g(null!=(e=null!=a?a.image:a)?e.id:e,a))+'">\n    </div>\n</div>'},useData:!0})},{"hbsfy/runtime":199}],144:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({1:function(a,b,c,d){var e;return'                <img src="'+(null!=(e=this.lambda(null!=(e=null!=(e=null!=a?a.model:a)?e.value:e)?e.url:e,a))?e:"")+'">\n'},3:function(a,b,c,d){return" kb-hide "},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f=this.lambda,g=this.escapeExpression,h=b.helperMissing;return"<div class=\"kb-field kb-field kb-field--image kb-fieldapi-field\">\n    <div class='kb-field-image-wrapper' data-kbfield=\"image\">\n        <div class='kb-js-add-image kb-field-image-container'>\n"+(null!=(e=b["if"].call(a,null!=(e=null!=(e=null!=a?a.model:a)?e.value:e)?e.url:e,{name:"if",hash:{},fn:this.program(1,d,0),inverse:this.noop,data:d}))?e:"")+'        </div>\n        <div class="kb-field-image-meta '+(null!=(e=b["if"].call(a,null!=(e=null!=a?a.model:a)?e.hideMeta:e,{name:"if",hash:{},fn:this.program(3,d,0),inverse:this.noop,data:d}))?e:"")+' ">\n            <div class="kb-field-image-title">\n                <label>'+g(f(null!=(e=null!=a?a.i18n:a)?e.title:e,a))+"</label>\n                <input class='kb-js-image-title kb-observe' readonly type=\"text\"\n                       name='"+g((b.fieldName||a&&a.fieldName||h).call(a,null!=(e=null!=a?a.model:a)?e.baseId:e,null!=(e=null!=a?a.model:a)?e.index:e,null!=(e=null!=a?a.model:a)?e.primeKey:e,{name:"fieldName",hash:{},data:d}))+"[title]'\n                       value='"+(null!=(e=f(null!=(e=null!=(e=null!=a?a.model:a)?e.value:e)?e.title:e,a))?e:"")+'\'>\n            </div>\n            <div class="kb-field-image-description">\n                <label>'+g(f(null!=(e=null!=a?a.i18n:a)?e.description:e,a))+"</label>\n        <textarea readonly class='kb-js-image-description kb-observe'\n                  name='"+g((b.fieldName||a&&a.fieldName||h).call(a,null!=(e=null!=a?a.model:a)?e.baseId:e,null!=(e=null!=a?a.model:a)?e.index:e,null!=(e=null!=a?a.model:a)?e.primeKey:e,{name:"fieldName",hash:{},data:d}))+"[caption]'>\n            "+(null!=(e=f(null!=(e=null!=(e=null!=a?a.model:a)?e.value:e)?e.caption:e,a))?e:"")+"\n        </textarea>\n            </div>\n        </div>\n        <input class='kb-js-image-id' type='hidden'\n               name='"+g((b.fieldName||a&&a.fieldName||h).call(a,null!=(e=null!=a?a.model:a)?e.baseId:e,null!=(e=null!=a?a.model:a)?e.index:e,null!=(e=null!=a?a.model:a)?e.primeKey:e,{name:"fieldName",hash:{},data:d}))+"[id]'\n               value='"+(null!=(e=f(null!=(e=null!=(e=null!=a?a.model:a)?e.value:e)?e.id:e,a))?e:"")+'\'>\n    </div>\n    <div class="kb-field-image--footer">\n        <a class="button kb-js-reset-image">Reset</a>\n    </div>\n</div>'},useData:!0})},{"hbsfy/runtime":199}],145:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({1:function(a,b,c,d){var e,f=this.lambda,g=this.escapeExpression;return"    <div class='kb-field--link-meta'><label for='"+g(f(null!=(e=null!=a?a.model:a)?e.index:e,a))+"-linktext'>"+g(f(null!=(e=null!=a?a.i18n:a)?e.linktext:e,a))+"</label><br>\n        <input\n                type='text' data-kbf-link-linktext\n                name=\""+g((b.fieldName||a&&a.fieldName||b.helperMissing).call(a,null!=(e=null!=a?a.model:a)?e.baseId:e,null!=(e=null!=a?a.model:a)?e.index:e,null!=(e=null!=a?a.model:a)?e.primeKey:e,{name:"fieldName",hash:{},data:d}))+"[linktext]\"\n                class='kb-field--link-linktext'\n                id='"+g(f(null!=(e=null!=a?a.model:a)?e.index:e,a))+"-linktext'\n                value='"+g(f(null!=(e=null!=(e=null!=a?a.model:a)?e.value:e)?e.linktext:e,a))+"'>\n    </div>\n"},3:function(a,b,c,d){var e,f=this.lambda,g=this.escapeExpression;return"        <div class='kb-field--link-meta'><label for='"+g(f(null!=(e=null!=a?a.model:a)?e.index:e,a))+"-linktitle'>"+g(f(null!=(e=null!=a?a.i18n:a)?e.linktitle:e,a))+"</label><br>\n            <input\n                    type='text'\n                    name=\""+g((b.fieldName||a&&a.fieldName||b.helperMissing).call(a,null!=(e=null!=a?a.model:a)?e.baseId:e,null!=(e=null!=a?a.model:a)?e.index:e,null!=(e=null!=a?a.model:a)?e.primeKey:e,{name:"fieldName",hash:{},data:d}))+"[linktitle]\"\n                    class='kb-field--link-linktitle'\n                    id='"+g(f(null!=(e=null!=a?a.model:a)?e.index:e,a))+"-linktitle'\n                    value='"+g(f(null!=(e=null!=(e=null!=a?a.model:a)?e.value:e)?e.linktitle:e,a))+"'>\n        </div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f=this.lambda,g=this.escapeExpression;return'<div class="kb-field kb-js-field kb-field--link field-api-link">\n    <label class="heading">'+g(f(null!=(e=null!=a?a.model:a)?e.label:e,a))+'</label>\n    <input class="kb-js-link-input" data-kbf-link-url\n           id="'+g(f(null!=(e=null!=a?a.model:a)?e.index:e,a))+'_link_input"\n           type="text"\n           name="'+g((b.fieldName||a&&a.fieldName||b.helperMissing).call(a,null!=(e=null!=a?a.model:a)?e.baseId:e,null!=(e=null!=a?a.model:a)?e.index:e,null!=(e=null!=a?a.model:a)?e.primeKey:e,{name:"fieldName",hash:{},data:d}))+'[link]"\n           value="'+g(f(null!=(e=null!=(e=null!=a?a.model:a)?e.value:e)?e.link:e,a))+"\">\n    <a class='button kb-js-add-link'>Add Link</a>\n"+(null!=(e=b["if"].call(a,null!=(e=null!=a?a.model:a)?e.linktext:e,{name:"if",hash:{},fn:this.program(1,d,0),inverse:this.noop,data:d}))?e:"")+"\n"+(null!=(e=b["if"].call(a,null!=(e=null!=a?a.model:a)?e.linktitle:e,{name:"if",hash:{},fn:this.program(3,d,0),inverse:this.noop,data:d}))?e:"")+'    <p class="description">'+g(f(null!=(e=null!=a?a.model:a)?e.description:e,a))+"</p>\n\n</div>"},useData:!0})},{"hbsfy/runtime":199}],146:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({1:function(a,b,c,d){return'            <option value="">Auswählen</option>\n'},3:function(a,b,c,d,e,f){var g,h=this.lambda,i=this.escapeExpression;return"            <option "+(null!=(g=(b.ifCond||a&&a.ifCond||b.helperMissing).call(a,null!=a?a.value:a,"==",null!=(g=null!=f[1]?f[1].model:f[1])?g.value:g,{name:"ifCond",hash:{},fn:this.program(4,d,0,e,f),inverse:this.noop,data:d}))?g:"")+'    value="'+i(h(null!=a?a.value:a,a))+'">'+i(h(null!=a?a.name:a,a))+"</option>\n"},4:function(a,b,c,d){return'selected="selected"'},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d,e,f){var g,h=this.lambda,i=this.escapeExpression;return'<div class="kb-field kb-js-field field-api-text kb-field--select">\n    <label class="heading">'+i(h(null!=(g=null!=a?a.model:a)?g.label:g,a))+'</label>\n    <select name="'+i((b.fieldName||a&&a.fieldName||b.helperMissing).call(a,null!=(g=null!=a?a.model:a)?g.baseId:g,null!=(g=null!=a?a.model:a)?g.index:g,null!=(g=null!=a?a.model:a)?g.primeKey:g,{name:"fieldName",hash:{},data:d}))+'">\n'+(null!=(g=b["if"].call(a,null!=(g=null!=a?a.model:a)?g.showempty:g,{name:"if",hash:{},fn:this.program(1,d,0,e,f),inverse:this.noop,data:d}))?g:"")+(null!=(g=b.each.call(a,null!=(g=null!=a?a.model:a)?g.options:g,{name:"each",hash:{},fn:this.program(3,d,0,e,f),inverse:this.noop,data:d}))?g:"")+'    </select>\n    <p class="description">'+i(h(null!=(g=null!=a?a.model:a)?g.description:g,a))+"</p>\n</div>"},useData:!0,useDepths:!0})},{"hbsfy/runtime":199}],147:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f=this.lambda,g=this.escapeExpression;return'<div class="kb-field kb-js-field field-api-text kb-field--text">\n    <label class="heading">'+g(f(null!=(e=null!=a?a.model:a)?e.label:e,a))+'</label>\n    <input type="text" name="'+g((b.fieldName||a&&a.fieldName||b.helperMissing).call(a,null!=(e=null!=a?a.model:a)?e.baseId:e,null!=(e=null!=a?a.model:a)?e.index:e,null!=(e=null!=a?a.model:a)?e.primeKey:e,{name:"fieldName",hash:{},data:d}))+'" value="'+g(f(null!=(e=null!=a?a.model:a)?e.value:e,a))+'" >\n    <p class="description">'+g(f(null!=(e=null!=a?a.model:a)?e.description:e,a))+"</p>\n</div>"},useData:!0})},{"hbsfy/runtime":199}],148:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f=this.lambda,g=this.escapeExpression;return'<div class="kb-field--text-multiple-item">\n    <div class="kb-field--text-multiple-control kbf-sort"><span class="dashicons dashicons-menu"></span></div>\n    <input type="text" name="'+g(f(null!=(e=null!=a?a.model:a)?e.baseId:e,a))+'[]" value="'+g(f(null!=(e=null!=a?a.model:a)?e.value:e,a))+'">\n    <div data-kbfaction="delete" class="kb-field--text-multiple-control kbf-delete"><span class="dashicons dashicons-trash" ></span></div>\n</div>'},useData:!0})},{"hbsfy/runtime":199}],149:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f=this.lambda,g=this.escapeExpression;return'<div class="kb-field kb-js-field field-api-textarea">\n    <label class="heading">'+g(f(null!=(e=null!=a?a.model:a)?e.label:e,a))+'</label>\n    <textarea name="'+g((b.fieldName||a&&a.fieldName||b.helperMissing).call(a,null!=(e=null!=a?a.model:a)?e.baseId:e,null!=(e=null!=a?a.model:a)?e.index:e,null!=(e=null!=a?a.model:a)?e.primeKey:e,{name:"fieldName",hash:{},data:d}))+'">'+g(f(null!=(e=null!=a?a.model:a)?e.value:e,a))+'</textarea>\n    <p class="description">'+g(f(null!=(e=null!=a?a.model:a)?e.description:e,a))+"</p>\n</div>"},useData:!0})},{"hbsfy/runtime":199}],150:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){return'<div class="kb-area__empty-placeholder">\n    <pre>Start adding modules here</pre>\n</div>'},useData:!0})},{"hbsfy/runtime":199}],151:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return"<div>"+(null!=(e=this.lambda(null!=(e=null!=a?a.strings:a)?e.feedback:e,a))?e:"")+"</div>"},useData:!0})},{"hbsfy/runtime":199}],152:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({1:function(a,b,c,d){return" kb-dynamic-module "},3:function(a,b,c,d){return" global-module "},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'<div data-kb-mcontrols="'+this.escapeExpression(this.lambda(null!=(e=null!=a?a.model:a)?e.mid:e,a))+"\" class='kb-module-controls "+(null!=(e=b["if"].call(a,null!=(e=null!=a?a.model:a)?e.inDynamic:e,{name:"if",hash:{},fn:this.program(1,d,0),inverse:this.noop,data:d}))?e:"")+" "+(null!=(e=b["if"].call(a,null!=(e=null!=a?a.model:a)?e.globalModule:e,{name:"if",hash:{},fn:this.program(3,d,0),inverse:this.noop,data:d}))?e:"")+'\'>\n    <div class="kb-controls-wrap"></div>\n</div>'},useData:!0})},{"hbsfy/runtime":199}],153:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f=this.lambda,g=this.escapeExpression;return'<h2 class="controls-title">Module: <span> '+g(f(null!=(e=null!=(e=null!=a?a.model:a)?e.settings:e)?e.name:e,a))+'</span></h2>\n<div class="kb-modal__draft-notice" style="display: none;">Draft Message</div>\n<div class="dashicons dashicons-no close-controls kb-button"></div>\n<div class="kb-controls--buttons-wrap">\n    <div class="kb-modal-history-back kb-button kb-button-secondary">&laquo; previous module</div>\n    <div class="kb-save-form kb-button kb-button-primary" title="'+g(f(null!=(e=null!=(e=null!=a?a.i18n:a)?e.frontendModal:e)?e.modalSave:e,a))+'">\n        <div class="dashicons dashicons-update"></div>'+g(f(null!=(e=null!=(e=null!=a?a.i18n:a)?e.frontendModal:e)?e.modalSave:e,a))+'<span\n            class="kb-dirty-notice">*</span></div>\n    <div class="kb-preview-form kb-button kb-button-secondary">'+g(f(null!=(e=null!=(e=null!=a?a.i18n:a)?e.frontendModal:e)?e.modalPreview:e,a))+'</div>\n\n</div>\n<form id="onsite-form" class="wp-core-ui wp-admin kb-nano">\n    <div class="kb-nano-content" id="onsite-content">\n\n        <div class="os-content-inner kb-module">\n\n        </div>\n    </div>\n</form>'},useData:!0})},{"hbsfy/runtime":199}],154:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'<div class="kb-module__placeholder">\n    <p>'+this.escapeExpression(this.lambda(null!=(e=null!=(e=null!=a?a.model:a)?e.settings:e)?e.name:e,a))+"\n    <span>Start here.</span>\n    </p>\n</div>"},useData:!0})},{"hbsfy/runtime":199}],155:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'<div class="kb-sidebar__subheader">\n    <span>You are editing area:</span> '+this.escapeExpression((e=null!=(e=b.name||(null!=a?a.name:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"name",hash:{},data:d}):e))+'\n    <div class="kb-sidebar-action--update kb-fx-button kb-fx-button--effect-boris"><span class="dashicons dashicons-update"></span></div>\n    <div class="kb-sidebar-action--cog kb-fx-button kb-fx-button--effect-boris"><span class="dashicons dashicons-admin-generic"></span></div>\n</div>\n<div class="kb-sidebar-area-details__settings" style="display: none">\n\n</div>\n<!--<div class="kb-sidebar-area-details__subheader">Categories</div>-->'},useData:!0})},{"hbsfy/runtime":199}],156:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'<div class="kb-sidebar__category-item">\n    <div class="kb-sidebar__category-item__title">\n        Category: '+this.escapeExpression((e=null!=(e=b.name||(null!=a?a.name:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"name",hash:{},data:d}):e))+'\n    </div>\n    <ul class="kb-sidebar__category-item__module-list">\n    </ul>\n</div>'},useData:!0})},{"hbsfy/runtime":199}],157:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'<div class="kb-sidebar__cat-module-item">\n    '+this.escapeExpression(this.lambda(null!=(e=null!=a?a.settings:a)?e.name:e,a))+'\n    <div class="kb-sidebar__cat-module-item__actions">\n    </div>\n</div>\n'},useData:!0})},{"hbsfy/runtime":199}],158:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){return'<li class="kb-sidebar__no-modules">No Modules attached yet</li>'},useData:!0})},{"hbsfy/runtime":199}],159:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f=this.lambda,g=this.escapeExpression;return'<div class="kb-sidebar-item__wrapper">\n    <div class="kb-sidebar-item__name">'+(null!=(e=f(null!=(e=null!=(e=null!=a?a.view:a)?e.settings:e)?e.name:e,a))?e:"")+'</div>\n    <div class="kb-sidebar-item__id">'+(null!=(e=f(null!=(e=null!=(e=null!=a?a.view:a)?e.settings:e)?e.id:e,a))?e:"")+"</div>\n</div>\n<div class=\"kb-sidebar-item__actions\">\n    <a class='kb-sidebar-item__edit' title='edit'\n       data='"+g(f(null!=(e=null!=a?a.view:a)?e.mid:e,a))+"' data-url='"+g(f(null!=(e=null!=a?a.view:a)?e.editURL:e,a))+'\'>\n        <span class="dashicons dashicons-edit"></span>\n        <span class="os-action">'+g(f(null!=(e=null!=(e=null!=a?a.i18n:a)?e.moduleControls:e)?e.controlsEdit:e,a))+"</span></a>\n    <a class='kb-sidebar__module-delete kb-js-inline-delete'><span\n            class=\"dashicons dashicons-trash\"></span></a>\n    <a class='kb-sidebar__module-update kb-js-inline-update'><span\n            class=\"dashicons dashicons-update\"></span></a>\n\n</div>"},useData:!0})},{"hbsfy/runtime":199}],160:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'<div class="kb-sidebar__header-wrap">\n    <div class="kb-sidebar__subheader">\n        '+this.escapeExpression((e=null!=(e=b.name||(null!=a?a.name:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"name",hash:{},data:d}):e))+'\n    </div>\n    <span class="genericon genericon-close-alt kb-sidebar-action--close"></span>\n    <div class="kb-sidebar-action--update kb-fx-button kb-fx-button--effect-boris"><span class="dashicons dashicons-update"></span></div>\n\n</div>\n<form class="kb-sidebar__form-container">\n\n</form>\n'},useData:!0})},{"hbsfy/runtime":199}],161:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'<div class="kb-sidebar--panel-item kb-sidebar__item">\n    '+this.escapeExpression((e=null!=(e=b.name||(null!=a?a.name:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"name",hash:{},data:d}):e))+"\n</div>"},useData:!0})},{"hbsfy/runtime":199}],162:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f=b.helperMissing,g="function",h=this.escapeExpression;return'<div class="kb-sidebar__item kb-sidebar__item--root" data-kb-action="'+h((e=null!=(e=b.id||(null!=a?a.id:a))?e:f,typeof e===g?e.call(a,{name:"id",hash:{},data:d}):e))+'">\n    '+h((e=null!=(e=b.text||(null!=a?a.text:a))?e:f,typeof e===g?e.call(a,{name:"text",hash:{},data:d}):e))+'\n    <span class="dashicons dashicons-arrow-right-alt2 kb-sidebar__add-module kb-js-sidebar-add-module"></span>\n\n</div>'},useData:!0})},{"hbsfy/runtime":199}],163:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'<div class="kb-sidebar-areaview kb-sidebar-areaview--inactive">\n    <div class="kb-sidebar-areaview__title"> '+this.escapeExpression((e=null!=(e=b.name||(null!=a?a.name:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"name",hash:{},data:d}):e))+'</div>\n    <span class="dashicons dashicons-arrow-right-alt2 kb-sidebar__add-module kb-js-sidebar-add-module"></span>\n</div>'},useData:!0})},{"hbsfy/runtime":199}],164:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){return'<div class="kb-sidebar__header-wrap">\n    <div class="kb-sidebar__subheader">\n        Kontentblocks\n    </div>\n</div>'},useData:!0})},{"hbsfy/runtime":199}],165:[function(a,b,c){var d=a("hbsfy/runtime");b.exports=d.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){return'<div class="kb-sidebar__nav-controls">\n    <div class="kb-sidebar__nav-button kb-js-sidebar-nav-back">\n        <span class="dashicons dashicons-arrow-left-alt2 cbutton cbutton--effect-boris"></span>\n    </div>\n</div>'},useData:!0})},{"hbsfy/runtime":199}],166:[function(a,b,c){},{}],167:[function(a,b,c){function d(a,b){for(var c=0,d=a.length-1;d>=0;d--){var e=a[d];"."===e?a.splice(d,1):".."===e?(a.splice(d,1),c++):c&&(a.splice(d,1),c--)}if(b)for(;c--;c)a.unshift("..");return a}function e(a,b){if(a.filter)return a.filter(b);for(var c=[],d=0;d<a.length;d++)b(a[d],d,a)&&c.push(a[d]);return c}var f=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,g=function(a){return f.exec(a).slice(1)};c.resolve=function(){for(var a="",b=!1,c=arguments.length-1;c>=-1&&!b;c--){var f=c>=0?arguments[c]:process.cwd();if("string"!=typeof f)throw new TypeError("Arguments to path.resolve must be strings");f&&(a=f+"/"+a,b="/"===f.charAt(0))}return a=d(e(a.split("/"),function(a){return!!a}),!b).join("/"),(b?"/":"")+a||"."},c.normalize=function(a){var b=c.isAbsolute(a),f="/"===h(a,-1);return a=d(e(a.split("/"),function(a){return!!a}),!b).join("/"),a||b||(a="."),a&&f&&(a+="/"),(b?"/":"")+a},c.isAbsolute=function(a){return"/"===a.charAt(0)},c.join=function(){var a=Array.prototype.slice.call(arguments,0);return c.normalize(e(a,function(a,b){if("string"!=typeof a)throw new TypeError("Arguments to path.join must be strings");return a}).join("/"))},c.relative=function(a,b){function d(a){for(var b=0;b<a.length&&""===a[b];b++);for(var c=a.length-1;c>=0&&""===a[c];c--);return b>c?[]:a.slice(b,c-b+1)}a=c.resolve(a).substr(1),b=c.resolve(b).substr(1);for(var e=d(a.split("/")),f=d(b.split("/")),g=Math.min(e.length,f.length),h=g,i=0;g>i;i++)if(e[i]!==f[i]){h=i;break}for(var j=[],i=h;i<e.length;i++)j.push("..");return j=j.concat(f.slice(h)),j.join("/")},c.sep="/",c.delimiter=":",c.dirname=function(a){var b=g(a),c=b[0],d=b[1];return c||d?(d&&(d=d.substr(0,d.length-1)),c+d):"."},c.basename=function(a,b){var c=g(a)[2];return b&&c.substr(-1*b.length)===b&&(c=c.substr(0,c.length-b.length)),c},c.extname=function(a){return g(a)[3]};var h="b"==="ab".substr(-1)?function(a,b,c){return a.substr(b,c)}:function(a,b,c){return 0>b&&(b=a.length+b),a.substr(b,c)}},{}],168:[function(a,b,c){"use strict";function d(){var a=r();return a.compile=function(b,c){return k.compile(b,c,a)},a.precompile=function(b,c){return k.precompile(b,c,a)},a.AST=i["default"],a.Compiler=k.Compiler,a.JavaScriptCompiler=m["default"],a.Parser=j.parser,a.parse=j.parse,a}var e=function(a){return a&&a.__esModule?a:{"default":a}};c.__esModule=!0;var f=a("./handlebars.runtime"),g=e(f),h=a("./handlebars/compiler/ast"),i=e(h),j=a("./handlebars/compiler/base"),k=a("./handlebars/compiler/compiler"),l=a("./handlebars/compiler/javascript-compiler"),m=e(l),n=a("./handlebars/compiler/visitor"),o=e(n),p=a("./handlebars/no-conflict"),q=e(p),r=g["default"].create,s=d();s.create=d,q["default"](s),s.Visitor=o["default"],s["default"]=s,c["default"]=s,b.exports=c["default"]},{"./handlebars.runtime":169,"./handlebars/compiler/ast":171,"./handlebars/compiler/base":172,"./handlebars/compiler/compiler":174,"./handlebars/compiler/javascript-compiler":176,"./handlebars/compiler/visitor":179,"./handlebars/no-conflict":182}],169:[function(a,b,c){"use strict";function d(){var a=new g.HandlebarsEnvironment;return m.extend(a,g),a.SafeString=i["default"],a.Exception=k["default"],a.Utils=m,a.escapeExpression=m.escapeExpression,a.VM=o,a.template=function(b){return o.template(b,a)},a}var e=function(a){return a&&a.__esModule?a:{"default":a}};c.__esModule=!0;var f=a("./handlebars/base"),g=e(f),h=a("./handlebars/safe-string"),i=e(h),j=a("./handlebars/exception"),k=e(j),l=a("./handlebars/utils"),m=e(l),n=a("./handlebars/runtime"),o=e(n),p=a("./handlebars/no-conflict"),q=e(p),r=d();r.create=d,q["default"](r),r["default"]=r,c["default"]=r,b.exports=c["default"]},{"./handlebars/base":170,"./handlebars/exception":181,"./handlebars/no-conflict":182,"./handlebars/runtime":183,"./handlebars/safe-string":184,"./handlebars/utils":185}],170:[function(a,b,c){"use strict";function d(a,b){this.helpers=a||{},this.partials=b||{},e(this)}function e(a){a.registerHelper("helperMissing",function(){if(1===arguments.length)return void 0;throw new k["default"]('Missing helper: "'+arguments[arguments.length-1].name+'"')}),a.registerHelper("blockHelperMissing",function(b,c){var d=c.inverse,e=c.fn;if(b===!0)return e(this);if(b===!1||null==b)return d(this);if(o(b))return b.length>0?(c.ids&&(c.ids=[c.name]),a.helpers.each(b,c)):d(this);if(c.data&&c.ids){var g=f(c.data);g.contextPath=i.appendContextPath(c.data.contextPath,c.name),c={data:g}}return e(b,c)}),a.registerHelper("each",function(a,b){function c(b,c,e){j&&(j.key=b,j.index=c,j.first=0===c,j.last=!!e,l&&(j.contextPath=l+b)),h+=d(a[b],{data:j,blockParams:i.blockParams([a[b],b],[l+b,null])})}if(!b)throw new k["default"]("Must pass iterator to #each");var d=b.fn,e=b.inverse,g=0,h="",j=void 0,l=void 0;if(b.data&&b.ids&&(l=i.appendContextPath(b.data.contextPath,b.ids[0])+"."),p(a)&&(a=a.call(this)),b.data&&(j=f(b.data)),a&&"object"==typeof a)if(o(a))for(var m=a.length;m>g;g++)c(g,g,g===a.length-1);else{var n=void 0;for(var q in a)a.hasOwnProperty(q)&&(n&&c(n,g-1),n=q,g++);n&&c(n,g-1,!0)}return 0===g&&(h=e(this)),h}),a.registerHelper("if",function(a,b){return p(a)&&(a=a.call(this)),!b.hash.includeZero&&!a||i.isEmpty(a)?b.inverse(this):b.fn(this)}),a.registerHelper("unless",function(b,c){return a.helpers["if"].call(this,b,{fn:c.inverse,inverse:c.fn,hash:c.hash})}),a.registerHelper("with",function(a,b){p(a)&&(a=a.call(this));var c=b.fn;if(i.isEmpty(a))return b.inverse(this);if(b.data&&b.ids){var d=f(b.data);d.contextPath=i.appendContextPath(b.data.contextPath,b.ids[0]),b={data:d}}return c(a,b)}),a.registerHelper("log",function(b,c){var d=c.data&&null!=c.data.level?parseInt(c.data.level,10):1;a.log(d,b)}),a.registerHelper("lookup",function(a,b){return a&&a[b]})}function f(a){var b=i.extend({},a);return b._parent=a,b}var g=function(a){return a&&a.__esModule?a:{"default":a}};c.__esModule=!0,c.HandlebarsEnvironment=d,c.createFrame=f;var h=a("./utils"),i=g(h),j=a("./exception"),k=g(j),l="3.0.1";c.VERSION=l;var m=6;c.COMPILER_REVISION=m;var n={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1"};c.REVISION_CHANGES=n;var o=i.isArray,p=i.isFunction,q=i.toString,r="[object Object]";d.prototype={constructor:d,logger:s,log:t,registerHelper:function(a,b){if(q.call(a)===r){if(b)throw new k["default"]("Arg not supported with multiple helpers");i.extend(this.helpers,a)}else this.helpers[a]=b},unregisterHelper:function(a){delete this.helpers[a]},registerPartial:function(a,b){if(q.call(a)===r)i.extend(this.partials,a);else{if("undefined"==typeof b)throw new k["default"]("Attempting to register a partial as undefined");this.partials[a]=b}},unregisterPartial:function(a){delete this.partials[a]}};var s={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:1,log:function(a,b){if("undefined"!=typeof console&&s.level<=a){var c=s.methodMap[a];(console[c]||console.log).call(console,b)}}};c.logger=s;var t=s.log;c.log=t},{"./exception":181,"./utils":185}],171:[function(a,b,c){"use strict";c.__esModule=!0;var d={Program:function(a,b,c,d){this.loc=d,this.type="Program",this.body=a,this.blockParams=b,this.strip=c},MustacheStatement:function(a,b,c,d,e,f){this.loc=f,this.type="MustacheStatement",this.path=a,this.params=b||[],this.hash=c,this.escaped=d,this.strip=e},BlockStatement:function(a,b,c,d,e,f,g,h,i){this.loc=i,this.type="BlockStatement",this.path=a,this.params=b||[],this.hash=c,this.program=d,this.inverse=e,this.openStrip=f,this.inverseStrip=g,this.closeStrip=h},PartialStatement:function(a,b,c,d,e){this.loc=e,this.type="PartialStatement",this.name=a,this.params=b||[],this.hash=c,this.indent="",this.strip=d},ContentStatement:function(a,b){this.loc=b,this.type="ContentStatement",this.original=this.value=a},CommentStatement:function(a,b,c){this.loc=c,this.type="CommentStatement",this.value=a,this.strip=b},SubExpression:function(a,b,c,d){this.loc=d,this.type="SubExpression",this.path=a,this.params=b||[],this.hash=c},PathExpression:function(a,b,c,d,e){this.loc=e,this.type="PathExpression",this.data=a,this.original=d,this.parts=c,this.depth=b},StringLiteral:function(a,b){this.loc=b,this.type="StringLiteral",this.original=this.value=a},NumberLiteral:function(a,b){this.loc=b,this.type="NumberLiteral",this.original=this.value=Number(a)},BooleanLiteral:function(a,b){this.loc=b,this.type="BooleanLiteral",this.original=this.value="true"===a},UndefinedLiteral:function(a){this.loc=a,this.type="UndefinedLiteral",this.original=this.value=void 0},NullLiteral:function(a){this.loc=a,this.type="NullLiteral",this.original=this.value=null},Hash:function(a,b){this.loc=b,this.type="Hash",this.pairs=a},HashPair:function(a,b,c){this.loc=c,this.type="HashPair",this.key=a,this.value=b},helpers:{helperExpression:function(a){return!("SubExpression"!==a.type&&!a.params.length&&!a.hash)},scopedId:function(a){return/^\.|this\b/.test(a.original)},simpleId:function(a){return 1===a.parts.length&&!d.helpers.scopedId(a)&&!a.depth}}};c["default"]=d,b.exports=c["default"]},{}],172:[function(a,b,c){"use strict";function d(a,b){if("Program"===a.type)return a;
g["default"].yy=o,o.locInfo=function(a){return new o.SourceLocation(b&&b.srcName,a)};var c=new k["default"];return c.accept(g["default"].parse(a))}var e=function(a){return a&&a.__esModule?a:{"default":a}};c.__esModule=!0,c.parse=d;var f=a("./parser"),g=e(f),h=a("./ast"),i=e(h),j=a("./whitespace-control"),k=e(j),l=a("./helpers"),m=e(l),n=a("../utils");c.parser=g["default"];var o={};n.extend(o,m,i["default"])},{"../utils":185,"./ast":171,"./helpers":175,"./parser":177,"./whitespace-control":180}],173:[function(a,b,c){"use strict";function d(a,b,c){if(f.isArray(a)){for(var d=[],e=0,g=a.length;g>e;e++)d.push(b.wrap(a[e],c));return d}return"boolean"==typeof a||"number"==typeof a?a+"":a}function e(a){this.srcFile=a,this.source=[]}c.__esModule=!0;var f=a("../utils"),g=void 0;try{if("function"!=typeof define||!define.amd){var h=a("source-map");g=h.SourceNode}}catch(i){}g||(g=function(a,b,c,d){this.src="",d&&this.add(d)},g.prototype={add:function(a){f.isArray(a)&&(a=a.join("")),this.src+=a},prepend:function(a){f.isArray(a)&&(a=a.join("")),this.src=a+this.src},toStringWithSourceMap:function(){return{code:this.toString()}},toString:function(){return this.src}}),e.prototype={prepend:function(a,b){this.source.unshift(this.wrap(a,b))},push:function(a,b){this.source.push(this.wrap(a,b))},merge:function(){var a=this.empty();return this.each(function(b){a.add(["  ",b,"\n"])}),a},each:function(a){for(var b=0,c=this.source.length;c>b;b++)a(this.source[b])},empty:function(){var a=void 0===arguments[0]?this.currentLocation||{start:{}}:arguments[0];return new g(a.start.line,a.start.column,this.srcFile)},wrap:function(a){var b=void 0===arguments[1]?this.currentLocation||{start:{}}:arguments[1];return a instanceof g?a:(a=d(a,this,b),new g(b.start.line,b.start.column,this.srcFile,a))},functionCall:function(a,b,c){return c=this.generateList(c),this.wrap([a,b?"."+b+"(":"(",c,")"])},quotedString:function(a){return'"'+(a+"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function(a){var b=[];for(var c in a)if(a.hasOwnProperty(c)){var e=d(a[c],this);"undefined"!==e&&b.push([this.quotedString(c),":",e])}var f=this.generateList(b);return f.prepend("{"),f.add("}"),f},generateList:function(a,b){for(var c=this.empty(b),e=0,f=a.length;f>e;e++)e&&c.add(","),c.add(d(a[e],this,b));return c},generateArray:function(a,b){var c=this.generateList(a,b);return c.prepend("["),c.add("]"),c}},c["default"]=e,b.exports=c["default"]},{"../utils":185,"source-map":187}],174:[function(a,b,c){"use strict";function d(){}function e(a,b,c){if(null==a||"string"!=typeof a&&"Program"!==a.type)throw new k["default"]("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+a);b=b||{},"data"in b||(b.data=!0),b.compat&&(b.useDepths=!0);var d=c.parse(a,b),e=(new c.Compiler).compile(d,b);return(new c.JavaScriptCompiler).compile(e,b)}function f(a,b,c){function d(){var b=c.parse(a,f),d=(new c.Compiler).compile(b,f),e=(new c.JavaScriptCompiler).compile(d,f,void 0,!0);return c.template(e)}function e(a,b){return g||(g=d()),g.call(this,a,b)}var f=void 0===arguments[1]?{}:arguments[1];if(null==a||"string"!=typeof a&&"Program"!==a.type)throw new k["default"]("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+a);"data"in f||(f.data=!0),f.compat&&(f.useDepths=!0);var g=void 0;return e._setup=function(a){return g||(g=d()),g._setup(a)},e._child=function(a,b,c,e){return g||(g=d()),g._child(a,b,c,e)},e}function g(a,b){if(a===b)return!0;if(l.isArray(a)&&l.isArray(b)&&a.length===b.length){for(var c=0;c<a.length;c++)if(!g(a[c],b[c]))return!1;return!0}}function h(a){if(!a.path.parts){var b=a.path;a.path=new n["default"].PathExpression(!1,0,[b.original+""],b.original+"",b.loc)}}var i=function(a){return a&&a.__esModule?a:{"default":a}};c.__esModule=!0,c.Compiler=d,c.precompile=e,c.compile=f;var j=a("../exception"),k=i(j),l=a("../utils"),m=a("./ast"),n=i(m),o=[].slice;d.prototype={compiler:d,equals:function(a){var b=this.opcodes.length;if(a.opcodes.length!==b)return!1;for(var c=0;b>c;c++){var d=this.opcodes[c],e=a.opcodes[c];if(d.opcode!==e.opcode||!g(d.args,e.args))return!1}b=this.children.length;for(var c=0;b>c;c++)if(!this.children[c].equals(a.children[c]))return!1;return!0},guid:0,compile:function(a,b){this.sourceNode=[],this.opcodes=[],this.children=[],this.options=b,this.stringParams=b.stringParams,this.trackIds=b.trackIds,b.blockParams=b.blockParams||[];var c=b.knownHelpers;if(b.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0,lookup:!0},c)for(var d in c)d in c&&(b.knownHelpers[d]=c[d]);return this.accept(a)},compileProgram:function(a){var b=new this.compiler,c=b.compile(a,this.options),d=this.guid++;return this.usePartial=this.usePartial||c.usePartial,this.children[d]=c,this.useDepths=this.useDepths||c.useDepths,d},accept:function(a){this.sourceNode.unshift(a);var b=this[a.type](a);return this.sourceNode.shift(),b},Program:function(a){this.options.blockParams.unshift(a.blockParams);for(var b=a.body,c=b.length,d=0;c>d;d++)this.accept(b[d]);return this.options.blockParams.shift(),this.isSimple=1===c,this.blockParams=a.blockParams?a.blockParams.length:0,this},BlockStatement:function(a){h(a);var b=a.program,c=a.inverse;b=b&&this.compileProgram(b),c=c&&this.compileProgram(c);var d=this.classifySexpr(a);"helper"===d?this.helperSexpr(a,b,c):"simple"===d?(this.simpleSexpr(a),this.opcode("pushProgram",b),this.opcode("pushProgram",c),this.opcode("emptyHash"),this.opcode("blockValue",a.path.original)):(this.ambiguousSexpr(a,b,c),this.opcode("pushProgram",b),this.opcode("pushProgram",c),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},PartialStatement:function(a){this.usePartial=!0;var b=a.params;if(b.length>1)throw new k["default"]("Unsupported number of partial arguments: "+b.length,a);b.length||b.push({type:"PathExpression",parts:[],depth:0});var c=a.name.original,d="SubExpression"===a.name.type;d&&this.accept(a.name),this.setupFullMustacheParams(a,void 0,void 0,!0);var e=a.indent||"";this.options.preventIndent&&e&&(this.opcode("appendContent",e),e=""),this.opcode("invokePartial",d,c,e),this.opcode("append")},MustacheStatement:function(a){this.SubExpression(a),a.escaped&&!this.options.noEscape?this.opcode("appendEscaped"):this.opcode("append")},ContentStatement:function(a){a.value&&this.opcode("appendContent",a.value)},CommentStatement:function(){},SubExpression:function(a){h(a);var b=this.classifySexpr(a);"simple"===b?this.simpleSexpr(a):"helper"===b?this.helperSexpr(a):this.ambiguousSexpr(a)},ambiguousSexpr:function(a,b,c){var d=a.path,e=d.parts[0],f=null!=b||null!=c;this.opcode("getContext",d.depth),this.opcode("pushProgram",b),this.opcode("pushProgram",c),this.accept(d),this.opcode("invokeAmbiguous",e,f)},simpleSexpr:function(a){this.accept(a.path),this.opcode("resolvePossibleLambda")},helperSexpr:function(a,b,c){var d=this.setupFullMustacheParams(a,b,c),e=a.path,f=e.parts[0];if(this.options.knownHelpers[f])this.opcode("invokeKnownHelper",d.length,f);else{if(this.options.knownHelpersOnly)throw new k["default"]("You specified knownHelpersOnly, but used the unknown helper "+f,a);e.falsy=!0,this.accept(e),this.opcode("invokeHelper",d.length,e.original,n["default"].helpers.simpleId(e))}},PathExpression:function(a){this.addDepth(a.depth),this.opcode("getContext",a.depth);var b=a.parts[0],c=n["default"].helpers.scopedId(a),d=!a.depth&&!c&&this.blockParamIndex(b);d?this.opcode("lookupBlockParam",d,a.parts):b?a.data?(this.options.data=!0,this.opcode("lookupData",a.depth,a.parts)):this.opcode("lookupOnContext",a.parts,a.falsy,c):this.opcode("pushContext")},StringLiteral:function(a){this.opcode("pushString",a.value)},NumberLiteral:function(a){this.opcode("pushLiteral",a.value)},BooleanLiteral:function(a){this.opcode("pushLiteral",a.value)},UndefinedLiteral:function(){this.opcode("pushLiteral","undefined")},NullLiteral:function(){this.opcode("pushLiteral","null")},Hash:function(a){var b=a.pairs,c=0,d=b.length;for(this.opcode("pushHash");d>c;c++)this.pushParam(b[c].value);for(;c--;)this.opcode("assignToHash",b[c].key);this.opcode("popHash")},opcode:function(a){this.opcodes.push({opcode:a,args:o.call(arguments,1),loc:this.sourceNode[0].loc})},addDepth:function(a){a&&(this.useDepths=!0)},classifySexpr:function(a){var b=n["default"].helpers.simpleId(a.path),c=b&&!!this.blockParamIndex(a.path.parts[0]),d=!c&&n["default"].helpers.helperExpression(a),e=!c&&(d||b);if(e&&!d){var f=a.path.parts[0],g=this.options;g.knownHelpers[f]?d=!0:g.knownHelpersOnly&&(e=!1)}return d?"helper":e?"ambiguous":"simple"},pushParams:function(a){for(var b=0,c=a.length;c>b;b++)this.pushParam(a[b])},pushParam:function(a){var b=null!=a.value?a.value:a.original||"";if(this.stringParams)b.replace&&(b=b.replace(/^(\.?\.\/)*/g,"").replace(/\//g,".")),a.depth&&this.addDepth(a.depth),this.opcode("getContext",a.depth||0),this.opcode("pushStringParam",b,a.type),"SubExpression"===a.type&&this.accept(a);else{if(this.trackIds){var c=void 0;if(!a.parts||n["default"].helpers.scopedId(a)||a.depth||(c=this.blockParamIndex(a.parts[0])),c){var d=a.parts.slice(1).join(".");this.opcode("pushId","BlockParam",c,d)}else b=a.original||b,b.replace&&(b=b.replace(/^\.\//g,"").replace(/^\.$/g,"")),this.opcode("pushId",a.type,b)}this.accept(a)}},setupFullMustacheParams:function(a,b,c,d){var e=a.params;return this.pushParams(e),this.opcode("pushProgram",b),this.opcode("pushProgram",c),a.hash?this.accept(a.hash):this.opcode("emptyHash",d),e},blockParamIndex:function(a){for(var b=0,c=this.options.blockParams.length;c>b;b++){var d=this.options.blockParams[b],e=d&&l.indexOf(d,a);if(d&&e>=0)return[b,e]}}}},{"../exception":181,"../utils":185,"./ast":171}],175:[function(a,b,c){"use strict";function d(a,b){this.source=a,this.start={line:b.first_line,column:b.first_column},this.end={line:b.last_line,column:b.last_column}}function e(a){return/^\[.*\]$/.test(a)?a.substr(1,a.length-2):a}function f(a,b){return{open:"~"===a.charAt(2),close:"~"===b.charAt(b.length-3)}}function g(a){return a.replace(/^\{\{~?\!-?-?/,"").replace(/-?-?~?\}\}$/,"")}function h(a,b,c){c=this.locInfo(c);for(var d=a?"@":"",e=[],f=0,g="",h=0,i=b.length;i>h;h++){var j=b[h].part,k=b[h].original!==j;if(d+=(b[h].separator||"")+j,k||".."!==j&&"."!==j&&"this"!==j)e.push(j);else{if(e.length>0)throw new n["default"]("Invalid path: "+d,{loc:c});".."===j&&(f++,g+="../")}}return new this.PathExpression(a,f,e,d,c)}function i(a,b,c,d,e,f){var g=d.charAt(3)||d.charAt(2),h="{"!==g&&"&"!==g;return new this.MustacheStatement(a,b,c,h,e,this.locInfo(f))}function j(a,b,c,d){if(a.path.original!==c){var e={loc:a.path.loc};throw new n["default"](a.path.original+" doesn't match "+c,e)}d=this.locInfo(d);var f=new this.Program([b],null,{},d);return new this.BlockStatement(a.path,a.params,a.hash,f,void 0,{},{},{},d)}function k(a,b,c,d,e,f){if(d&&d.path&&a.path.original!==d.path.original){var g={loc:a.path.loc};throw new n["default"](a.path.original+" doesn't match "+d.path.original,g)}b.blockParams=a.blockParams;var h=void 0,i=void 0;return c&&(c.chain&&(c.program.body[0].closeStrip=d.strip),i=c.strip,h=c.program),e&&(e=h,h=b,b=e),new this.BlockStatement(a.path,a.params,a.hash,b,h,a.strip,i,d&&d.strip,this.locInfo(f))}var l=function(a){return a&&a.__esModule?a:{"default":a}};c.__esModule=!0,c.SourceLocation=d,c.id=e,c.stripFlags=f,c.stripComment=g,c.preparePath=h,c.prepareMustache=i,c.prepareRawBlock=j,c.prepareBlock=k;var m=a("../exception"),n=l(m)},{"../exception":181}],176:[function(a,b,c){"use strict";function d(a){this.value=a}function e(){}function f(a,b,c,d){var e=b.popStack(),f=0,g=c.length;for(a&&g--;g>f;f++)e=b.nameLookup(e,c[f],d);return a?[b.aliasable("this.strict"),"(",e,", ",b.quotedString(c[f]),")"]:e}var g=function(a){return a&&a.__esModule?a:{"default":a}};c.__esModule=!0;var h=a("../base"),i=a("../exception"),j=g(i),k=a("../utils"),l=a("./code-gen"),m=g(l);e.prototype={nameLookup:function(a,b){return e.isValidJavaScriptVariableName(b)?[a,".",b]:[a,"['",b,"']"]},depthedLookup:function(a){return[this.aliasable("this.lookup"),'(depths, "',a,'")']},compilerInfo:function(){var a=h.COMPILER_REVISION,b=h.REVISION_CHANGES[a];return[a,b]},appendToBuffer:function(a,b,c){return k.isArray(a)||(a=[a]),a=this.source.wrap(a,b),this.environment.isSimple?["return ",a,";"]:c?["buffer += ",a,";"]:(a.appendToBuffer=!0,a)},initializeBuffer:function(){return this.quotedString("")},compile:function(a,b,c,d){this.environment=a,this.options=b,this.stringParams=this.options.stringParams,this.trackIds=this.options.trackIds,this.precompile=!d,this.name=this.environment.name,this.isChild=!!c,this.context=c||{programs:[],environments:[]},this.preamble(),this.stackSlot=0,this.stackVars=[],this.aliases={},this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.blockParams=[],this.compileChildren(a,b),this.useDepths=this.useDepths||a.useDepths||this.options.compat,this.useBlockParams=this.useBlockParams||a.useBlockParams;var e=a.opcodes,f=void 0,g=void 0,h=void 0,i=void 0;for(h=0,i=e.length;i>h;h++)f=e[h],this.source.currentLocation=f.loc,g=g||f.loc,this[f.opcode].apply(this,f.args);if(this.source.currentLocation=g,this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new j["default"]("Compile completed with content left on stack");var k=this.createFunctionContext(d);if(this.isChild)return k;var l={compiler:this.compilerInfo(),main:k},m=this.context.programs;for(h=0,i=m.length;i>h;h++)m[h]&&(l[h]=m[h]);return this.environment.usePartial&&(l.usePartial=!0),this.options.data&&(l.useData=!0),this.useDepths&&(l.useDepths=!0),this.useBlockParams&&(l.useBlockParams=!0),this.options.compat&&(l.compat=!0),d?l.compilerOptions=this.options:(l.compiler=JSON.stringify(l.compiler),this.source.currentLocation={start:{line:1,column:0}},l=this.objectLiteral(l),b.srcName?(l=l.toStringWithSourceMap({file:b.destName}),l.map=l.map&&l.map.toString()):l=l.toString()),l},preamble:function(){this.lastContext=0,this.source=new m["default"](this.options.srcName)},createFunctionContext:function(a){var b="",c=this.stackVars.concat(this.registers.list);c.length>0&&(b+=", "+c.join(", "));var d=0;for(var e in this.aliases){var f=this.aliases[e];this.aliases.hasOwnProperty(e)&&f.children&&f.referenceCount>1&&(b+=", alias"+ ++d+"="+e,f.children[0]="alias"+d)}var g=["depth0","helpers","partials","data"];(this.useBlockParams||this.useDepths)&&g.push("blockParams"),this.useDepths&&g.push("depths");var h=this.mergeSource(b);return a?(g.push(h),Function.apply(this,g)):this.source.wrap(["function(",g.join(","),") {\n  ",h,"}"])},mergeSource:function(a){var b=this.environment.isSimple,c=!this.forceBuffer,d=void 0,e=void 0,f=void 0,g=void 0;return this.source.each(function(a){a.appendToBuffer?(f?a.prepend("  + "):f=a,g=a):(f&&(e?f.prepend("buffer += "):d=!0,g.add(";"),f=g=void 0),e=!0,b||(c=!1))}),c?f?(f.prepend("return "),g.add(";")):e||this.source.push('return "";'):(a+=", buffer = "+(d?"":this.initializeBuffer()),f?(f.prepend("return buffer + "),g.add(";")):this.source.push("return buffer;")),a&&this.source.prepend("var "+a.substring(2)+(d?"":";\n")),this.source.merge()},blockValue:function(a){var b=this.aliasable("helpers.blockHelperMissing"),c=[this.contextName(0)];this.setupHelperArgs(a,0,c);var d=this.popStack();c.splice(1,0,d),this.push(this.source.functionCall(b,"call",c))},ambiguousBlockValue:function(){var a=this.aliasable("helpers.blockHelperMissing"),b=[this.contextName(0)];this.setupHelperArgs("",0,b,!0),this.flushInline();var c=this.topStack();b.splice(1,0,c),this.pushSource(["if (!",this.lastHelper,") { ",c," = ",this.source.functionCall(a,"call",b),"}"])},appendContent:function(a){this.pendingContent?a=this.pendingContent+a:this.pendingLocation=this.source.currentLocation,this.pendingContent=a},append:function(){if(this.isInline())this.replaceStack(function(a){return[" != null ? ",a,' : ""']}),this.pushSource(this.appendToBuffer(this.popStack()));else{var a=this.popStack();this.pushSource(["if (",a," != null) { ",this.appendToBuffer(a,void 0,!0)," }"]),this.environment.isSimple&&this.pushSource(["else { ",this.appendToBuffer("''",void 0,!0)," }"])}},appendEscaped:function(){this.pushSource(this.appendToBuffer([this.aliasable("this.escapeExpression"),"(",this.popStack(),")"]))},getContext:function(a){this.lastContext=a},pushContext:function(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function(a,b,c){var d=0;c||!this.options.compat||this.lastContext?this.pushContext():this.push(this.depthedLookup(a[d++])),this.resolvePath("context",a,d,b)},lookupBlockParam:function(a,b){this.useBlockParams=!0,this.push(["blockParams[",a[0],"][",a[1],"]"]),this.resolvePath("context",b,1)},lookupData:function(a,b){a?this.pushStackLiteral("this.data(data, "+a+")"):this.pushStackLiteral("data"),this.resolvePath("data",b,0,!0)},resolvePath:function(a,b,c,d){var e=this;if(this.options.strict||this.options.assumeObjects)return void this.push(f(this.options.strict,this,b,a));for(var g=b.length;g>c;c++)this.replaceStack(function(f){var g=e.nameLookup(f,b[c],a);return d?[" && ",g]:[" != null ? ",g," : ",f]})},resolvePossibleLambda:function(){this.push([this.aliasable("this.lambda"),"(",this.popStack(),", ",this.contextName(0),")"])},pushStringParam:function(a,b){this.pushContext(),this.pushString(b),"SubExpression"!==b&&("string"==typeof a?this.pushString(a):this.pushStackLiteral(a))},emptyHash:function(a){this.trackIds&&this.push("{}"),this.stringParams&&(this.push("{}"),this.push("{}")),this.pushStackLiteral(a?"undefined":"{}")},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:[],types:[],contexts:[],ids:[]}},popHash:function(){var a=this.hash;this.hash=this.hashes.pop(),this.trackIds&&this.push(this.objectLiteral(a.ids)),this.stringParams&&(this.push(this.objectLiteral(a.contexts)),this.push(this.objectLiteral(a.types))),this.push(this.objectLiteral(a.values))},pushString:function(a){this.pushStackLiteral(this.quotedString(a))},pushLiteral:function(a){this.pushStackLiteral(a)},pushProgram:function(a){null!=a?this.pushStackLiteral(this.programExpression(a)):this.pushStackLiteral(null)},invokeHelper:function(a,b,c){var d=this.popStack(),e=this.setupHelper(a,b),f=c?[e.name," || "]:"",g=["("].concat(f,d);this.options.strict||g.push(" || ",this.aliasable("helpers.helperMissing")),g.push(")"),this.push(this.source.functionCall(g,"call",e.callParams))},invokeKnownHelper:function(a,b){var c=this.setupHelper(a,b);this.push(this.source.functionCall(c.name,"call",c.callParams))},invokeAmbiguous:function(a,b){this.useRegister("helper");var c=this.popStack();this.emptyHash();var d=this.setupHelper(0,a,b),e=this.lastHelper=this.nameLookup("helpers",a,"helper"),f=["(","(helper = ",e," || ",c,")"];this.options.strict||(f[0]="(helper = ",f.push(" != null ? helper : ",this.aliasable("helpers.helperMissing"))),this.push(["(",f,d.paramsInit?["),(",d.paramsInit]:[],"),","(typeof helper === ",this.aliasable('"function"')," ? ",this.source.functionCall("helper","call",d.callParams)," : helper))"])},invokePartial:function(a,b,c){var d=[],e=this.setupParams(b,1,d,!1);a&&(b=this.popStack(),delete e.name),c&&(e.indent=JSON.stringify(c)),e.helpers="helpers",e.partials="partials",a?d.unshift(b):d.unshift(this.nameLookup("partials",b,"partial")),this.options.compat&&(e.depths="depths"),e=this.objectLiteral(e),d.push(e),this.push(this.source.functionCall("this.invokePartial","",d))},assignToHash:function(a){var b=this.popStack(),c=void 0,d=void 0,e=void 0;this.trackIds&&(e=this.popStack()),this.stringParams&&(d=this.popStack(),c=this.popStack());var f=this.hash;c&&(f.contexts[a]=c),d&&(f.types[a]=d),e&&(f.ids[a]=e),f.values[a]=b},pushId:function(a,b,c){"BlockParam"===a?this.pushStackLiteral("blockParams["+b[0]+"].path["+b[1]+"]"+(c?" + "+JSON.stringify("."+c):"")):"PathExpression"===a?this.pushString(b):"SubExpression"===a?this.pushStackLiteral("true"):this.pushStackLiteral("null")},compiler:e,compileChildren:function(a,b){for(var c=a.children,d=void 0,e=void 0,f=0,g=c.length;g>f;f++){d=c[f],e=new this.compiler;var h=this.matchExistingProgram(d);null==h?(this.context.programs.push(""),h=this.context.programs.length,d.index=h,d.name="program"+h,this.context.programs[h]=e.compile(d,b,this.context,!this.precompile),this.context.environments[h]=d,this.useDepths=this.useDepths||e.useDepths,this.useBlockParams=this.useBlockParams||e.useBlockParams):(d.index=h,d.name="program"+h,this.useDepths=this.useDepths||d.useDepths,this.useBlockParams=this.useBlockParams||d.useBlockParams)}},matchExistingProgram:function(a){for(var b=0,c=this.context.environments.length;c>b;b++){var d=this.context.environments[b];if(d&&d.equals(a))return b}},programExpression:function(a){var b=this.environment.children[a],c=[b.index,"data",b.blockParams];return(this.useBlockParams||this.useDepths)&&c.push("blockParams"),this.useDepths&&c.push("depths"),"this.program("+c.join(", ")+")"},useRegister:function(a){this.registers[a]||(this.registers[a]=!0,this.registers.list.push(a))},push:function(a){return a instanceof d||(a=this.source.wrap(a)),this.inlineStack.push(a),a},pushStackLiteral:function(a){this.push(new d(a))},pushSource:function(a){this.pendingContent&&(this.source.push(this.appendToBuffer(this.source.quotedString(this.pendingContent),this.pendingLocation)),this.pendingContent=void 0),a&&this.source.push(a)},replaceStack:function(a){var b=["("],c=void 0,e=void 0,f=void 0;if(!this.isInline())throw new j["default"]("replaceStack on non-inline");var g=this.popStack(!0);if(g instanceof d)c=[g.value],b=["(",c],f=!0;else{e=!0;var h=this.incrStack();b=["((",this.push(h)," = ",g,")"],c=this.topStack()}var i=a.call(this,c);f||this.popStack(),e&&this.stackSlot--,this.push(b.concat(i,")"))},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var a=this.inlineStack;this.inlineStack=[];for(var b=0,c=a.length;c>b;b++){var e=a[b];if(e instanceof d)this.compileStack.push(e);else{var f=this.incrStack();this.pushSource([f," = ",e,";"]),this.compileStack.push(f)}}},isInline:function(){return this.inlineStack.length},popStack:function(a){var b=this.isInline(),c=(b?this.inlineStack:this.compileStack).pop();if(!a&&c instanceof d)return c.value;if(!b){if(!this.stackSlot)throw new j["default"]("Invalid stack pop");this.stackSlot--}return c},topStack:function(){var a=this.isInline()?this.inlineStack:this.compileStack,b=a[a.length-1];return b instanceof d?b.value:b},contextName:function(a){return this.useDepths&&a?"depths["+a+"]":"depth"+a},quotedString:function(a){return this.source.quotedString(a)},objectLiteral:function(a){return this.source.objectLiteral(a)},aliasable:function(a){var b=this.aliases[a];return b?(b.referenceCount++,b):(b=this.aliases[a]=this.source.wrap(a),b.aliasable=!0,b.referenceCount=1,b)},setupHelper:function(a,b,c){var d=[],e=this.setupHelperArgs(b,a,d,c),f=this.nameLookup("helpers",b,"helper");return{params:d,paramsInit:e,name:f,callParams:[this.contextName(0)].concat(d)}},setupParams:function(a,b,c){var d={},e=[],f=[],g=[],h=void 0;d.name=this.quotedString(a),d.hash=this.popStack(),this.trackIds&&(d.hashIds=this.popStack()),this.stringParams&&(d.hashTypes=this.popStack(),d.hashContexts=this.popStack());var i=this.popStack(),j=this.popStack();(j||i)&&(d.fn=j||"this.noop",d.inverse=i||"this.noop");for(var k=b;k--;)h=this.popStack(),c[k]=h,this.trackIds&&(g[k]=this.popStack()),this.stringParams&&(f[k]=this.popStack(),e[k]=this.popStack());return this.trackIds&&(d.ids=this.source.generateArray(g)),this.stringParams&&(d.types=this.source.generateArray(f),d.contexts=this.source.generateArray(e)),this.options.data&&(d.data="data"),this.useBlockParams&&(d.blockParams="blockParams"),d},setupHelperArgs:function(a,b,c,d){var e=this.setupParams(a,b,c,!0);return e=this.objectLiteral(e),d?(this.useRegister("options"),c.push("options"),["options=",e]):(c.push(e),"")}},function(){for(var a="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield await null true false".split(" "),b=e.RESERVED_WORDS={},c=0,d=a.length;d>c;c++)b[a[c]]=!0}(),e.isValidJavaScriptVariableName=function(a){return!e.RESERVED_WORDS[a]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(a)},c["default"]=e,b.exports=c["default"]},{"../base":170,"../exception":181,"../utils":185,"./code-gen":173}],177:[function(a,b,c){"use strict";c.__esModule=!0;var d=function(){function a(){this.yy={}}var b={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,content:12,COMMENT:13,CONTENT:14,openRawBlock:15,END_RAW_BLOCK:16,OPEN_RAW_BLOCK:17,helperName:18,openRawBlock_repetition0:19,openRawBlock_option0:20,CLOSE_RAW_BLOCK:21,openBlock:22,block_option0:23,closeBlock:24,openInverse:25,block_option1:26,OPEN_BLOCK:27,openBlock_repetition0:28,openBlock_option0:29,openBlock_option1:30,CLOSE:31,OPEN_INVERSE:32,openInverse_repetition0:33,openInverse_option0:34,openInverse_option1:35,openInverseChain:36,OPEN_INVERSE_CHAIN:37,openInverseChain_repetition0:38,openInverseChain_option0:39,openInverseChain_option1:40,inverseAndProgram:41,INVERSE:42,inverseChain:43,inverseChain_option0:44,OPEN_ENDBLOCK:45,OPEN:46,mustache_repetition0:47,mustache_option0:48,OPEN_UNESCAPED:49,mustache_repetition1:50,mustache_option1:51,CLOSE_UNESCAPED:52,OPEN_PARTIAL:53,partialName:54,partial_repetition0:55,partial_option0:56,param:57,sexpr:58,OPEN_SEXPR:59,sexpr_repetition0:60,sexpr_option0:61,CLOSE_SEXPR:62,hash:63,hash_repetition_plus0:64,hashSegment:65,ID:66,EQUALS:67,blockParams:68,OPEN_BLOCK_PARAMS:69,blockParams_repetition_plus0:70,CLOSE_BLOCK_PARAMS:71,path:72,dataName:73,STRING:74,NUMBER:75,BOOLEAN:76,UNDEFINED:77,NULL:78,DATA:79,pathSegments:80,SEP:81,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",13:"COMMENT",14:"CONTENT",16:"END_RAW_BLOCK",17:"OPEN_RAW_BLOCK",21:"CLOSE_RAW_BLOCK",27:"OPEN_BLOCK",31:"CLOSE",32:"OPEN_INVERSE",37:"OPEN_INVERSE_CHAIN",42:"INVERSE",45:"OPEN_ENDBLOCK",46:"OPEN",49:"OPEN_UNESCAPED",52:"CLOSE_UNESCAPED",53:"OPEN_PARTIAL",59:"OPEN_SEXPR",62:"CLOSE_SEXPR",66:"ID",67:"EQUALS",69:"OPEN_BLOCK_PARAMS",71:"CLOSE_BLOCK_PARAMS",74:"STRING",75:"NUMBER",76:"BOOLEAN",77:"UNDEFINED",78:"NULL",79:"DATA",81:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[12,1],[10,3],[15,5],[9,4],[9,4],[22,6],[25,6],[36,6],[41,2],[43,3],[43,1],[24,3],[8,5],[8,5],[11,5],[57,1],[57,1],[58,5],[63,1],[65,3],[68,3],[18,1],[18,1],[18,1],[18,1],[18,1],[18,1],[18,1],[54,1],[54,1],[73,2],[72,1],[80,3],[80,1],[6,0],[6,2],[19,0],[19,2],[20,0],[20,1],[23,0],[23,1],[26,0],[26,1],[28,0],[28,2],[29,0],[29,1],[30,0],[30,1],[33,0],[33,2],[34,0],[34,1],[35,0],[35,1],[38,0],[38,2],[39,0],[39,1],[40,0],[40,1],[44,0],[44,1],[47,0],[47,2],[48,0],[48,1],[50,0],[50,2],[51,0],[51,1],[55,0],[55,2],[56,0],[56,1],[60,0],[60,2],[61,0],[61,1],[64,1],[64,2],[70,1],[70,2]],performAction:function(a,b,c,d,e,f,g){var h=f.length-1;switch(e){case 1:return f[h-1];case 2:this.$=new d.Program(f[h],null,{},d.locInfo(this._$));break;case 3:this.$=f[h];break;case 4:this.$=f[h];break;case 5:this.$=f[h];break;case 6:this.$=f[h];break;case 7:this.$=f[h];break;case 8:this.$=new d.CommentStatement(d.stripComment(f[h]),d.stripFlags(f[h],f[h]),d.locInfo(this._$));break;case 9:this.$=new d.ContentStatement(f[h],d.locInfo(this._$));break;case 10:this.$=d.prepareRawBlock(f[h-2],f[h-1],f[h],this._$);break;case 11:this.$={path:f[h-3],params:f[h-2],hash:f[h-1]};break;case 12:this.$=d.prepareBlock(f[h-3],f[h-2],f[h-1],f[h],!1,this._$);break;case 13:this.$=d.prepareBlock(f[h-3],f[h-2],f[h-1],f[h],!0,this._$);break;case 14:this.$={path:f[h-4],params:f[h-3],hash:f[h-2],blockParams:f[h-1],strip:d.stripFlags(f[h-5],f[h])};break;case 15:this.$={path:f[h-4],params:f[h-3],hash:f[h-2],blockParams:f[h-1],strip:d.stripFlags(f[h-5],f[h])};break;case 16:this.$={path:f[h-4],params:f[h-3],hash:f[h-2],blockParams:f[h-1],strip:d.stripFlags(f[h-5],f[h])};break;case 17:this.$={strip:d.stripFlags(f[h-1],f[h-1]),program:f[h]};break;case 18:var i=d.prepareBlock(f[h-2],f[h-1],f[h],f[h],!1,this._$),j=new d.Program([i],null,{},d.locInfo(this._$));j.chained=!0,this.$={strip:f[h-2].strip,program:j,chain:!0};break;case 19:this.$=f[h];break;case 20:this.$={path:f[h-1],strip:d.stripFlags(f[h-2],f[h])};break;case 21:this.$=d.prepareMustache(f[h-3],f[h-2],f[h-1],f[h-4],d.stripFlags(f[h-4],f[h]),this._$);break;case 22:this.$=d.prepareMustache(f[h-3],f[h-2],f[h-1],f[h-4],d.stripFlags(f[h-4],f[h]),this._$);break;case 23:this.$=new d.PartialStatement(f[h-3],f[h-2],f[h-1],d.stripFlags(f[h-4],f[h]),d.locInfo(this._$));break;case 24:this.$=f[h];break;case 25:this.$=f[h];break;case 26:this.$=new d.SubExpression(f[h-3],f[h-2],f[h-1],d.locInfo(this._$));break;case 27:this.$=new d.Hash(f[h],d.locInfo(this._$));break;case 28:this.$=new d.HashPair(d.id(f[h-2]),f[h],d.locInfo(this._$));break;case 29:this.$=d.id(f[h-1]);break;case 30:this.$=f[h];break;case 31:this.$=f[h];break;case 32:this.$=new d.StringLiteral(f[h],d.locInfo(this._$));break;case 33:this.$=new d.NumberLiteral(f[h],d.locInfo(this._$));break;case 34:this.$=new d.BooleanLiteral(f[h],d.locInfo(this._$));break;case 35:this.$=new d.UndefinedLiteral(d.locInfo(this._$));break;case 36:this.$=new d.NullLiteral(d.locInfo(this._$));break;case 37:this.$=f[h];break;case 38:this.$=f[h];break;case 39:this.$=d.preparePath(!0,f[h],this._$);break;case 40:this.$=d.preparePath(!1,f[h],this._$);break;case 41:f[h-2].push({part:d.id(f[h]),original:f[h],separator:f[h-1]}),this.$=f[h-2];break;case 42:this.$=[{part:d.id(f[h]),original:f[h]}];break;case 43:this.$=[];break;case 44:f[h-1].push(f[h]);break;case 45:this.$=[];break;case 46:f[h-1].push(f[h]);break;case 53:this.$=[];break;case 54:f[h-1].push(f[h]);break;case 59:this.$=[];break;case 60:f[h-1].push(f[h]);break;case 65:this.$=[];break;case 66:f[h-1].push(f[h]);break;case 73:this.$=[];break;case 74:f[h-1].push(f[h]);break;case 77:this.$=[];break;case 78:f[h-1].push(f[h]);break;case 81:this.$=[];break;case 82:f[h-1].push(f[h]);break;case 85:this.$=[];break;case 86:f[h-1].push(f[h]);break;case 89:this.$=[f[h]];break;case 90:f[h-1].push(f[h]);break;case 91:this.$=[f[h]];break;case 92:f[h-1].push(f[h])}},table:[{3:1,4:2,5:[2,43],6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],46:[2,43],49:[2,43],53:[2,43]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:10,13:[1,11],14:[1,18],15:16,17:[1,21],22:14,25:15,27:[1,19],32:[1,20],37:[2,2],42:[2,2],45:[2,2],46:[1,12],49:[1,13],53:[1,17]},{1:[2,1]},{5:[2,44],13:[2,44],14:[2,44],17:[2,44],27:[2,44],32:[2,44],37:[2,44],42:[2,44],45:[2,44],46:[2,44],49:[2,44],53:[2,44]},{5:[2,3],13:[2,3],14:[2,3],17:[2,3],27:[2,3],32:[2,3],37:[2,3],42:[2,3],45:[2,3],46:[2,3],49:[2,3],53:[2,3]},{5:[2,4],13:[2,4],14:[2,4],17:[2,4],27:[2,4],32:[2,4],37:[2,4],42:[2,4],45:[2,4],46:[2,4],49:[2,4],53:[2,4]},{5:[2,5],13:[2,5],14:[2,5],17:[2,5],27:[2,5],32:[2,5],37:[2,5],42:[2,5],45:[2,5],46:[2,5],49:[2,5],53:[2,5]},{5:[2,6],13:[2,6],14:[2,6],17:[2,6],27:[2,6],32:[2,6],37:[2,6],42:[2,6],45:[2,6],46:[2,6],49:[2,6],53:[2,6]},{5:[2,7],13:[2,7],14:[2,7],17:[2,7],27:[2,7],32:[2,7],37:[2,7],42:[2,7],45:[2,7],46:[2,7],49:[2,7],53:[2,7]},{5:[2,8],13:[2,8],14:[2,8],17:[2,8],27:[2,8],32:[2,8],37:[2,8],42:[2,8],45:[2,8],46:[2,8],49:[2,8],53:[2,8]},{18:22,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:33,66:[1,32],
72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{4:34,6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],37:[2,43],42:[2,43],45:[2,43],46:[2,43],49:[2,43],53:[2,43]},{4:35,6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],42:[2,43],45:[2,43],46:[2,43],49:[2,43],53:[2,43]},{12:36,14:[1,18]},{18:38,54:37,58:39,59:[1,40],66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{5:[2,9],13:[2,9],14:[2,9],16:[2,9],17:[2,9],27:[2,9],32:[2,9],37:[2,9],42:[2,9],45:[2,9],46:[2,9],49:[2,9],53:[2,9]},{18:41,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:42,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:43,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{31:[2,73],47:44,59:[2,73],66:[2,73],74:[2,73],75:[2,73],76:[2,73],77:[2,73],78:[2,73],79:[2,73]},{21:[2,30],31:[2,30],52:[2,30],59:[2,30],62:[2,30],66:[2,30],69:[2,30],74:[2,30],75:[2,30],76:[2,30],77:[2,30],78:[2,30],79:[2,30]},{21:[2,31],31:[2,31],52:[2,31],59:[2,31],62:[2,31],66:[2,31],69:[2,31],74:[2,31],75:[2,31],76:[2,31],77:[2,31],78:[2,31],79:[2,31]},{21:[2,32],31:[2,32],52:[2,32],59:[2,32],62:[2,32],66:[2,32],69:[2,32],74:[2,32],75:[2,32],76:[2,32],77:[2,32],78:[2,32],79:[2,32]},{21:[2,33],31:[2,33],52:[2,33],59:[2,33],62:[2,33],66:[2,33],69:[2,33],74:[2,33],75:[2,33],76:[2,33],77:[2,33],78:[2,33],79:[2,33]},{21:[2,34],31:[2,34],52:[2,34],59:[2,34],62:[2,34],66:[2,34],69:[2,34],74:[2,34],75:[2,34],76:[2,34],77:[2,34],78:[2,34],79:[2,34]},{21:[2,35],31:[2,35],52:[2,35],59:[2,35],62:[2,35],66:[2,35],69:[2,35],74:[2,35],75:[2,35],76:[2,35],77:[2,35],78:[2,35],79:[2,35]},{21:[2,36],31:[2,36],52:[2,36],59:[2,36],62:[2,36],66:[2,36],69:[2,36],74:[2,36],75:[2,36],76:[2,36],77:[2,36],78:[2,36],79:[2,36]},{21:[2,40],31:[2,40],52:[2,40],59:[2,40],62:[2,40],66:[2,40],69:[2,40],74:[2,40],75:[2,40],76:[2,40],77:[2,40],78:[2,40],79:[2,40],81:[1,45]},{66:[1,32],80:46},{21:[2,42],31:[2,42],52:[2,42],59:[2,42],62:[2,42],66:[2,42],69:[2,42],74:[2,42],75:[2,42],76:[2,42],77:[2,42],78:[2,42],79:[2,42],81:[2,42]},{50:47,52:[2,77],59:[2,77],66:[2,77],74:[2,77],75:[2,77],76:[2,77],77:[2,77],78:[2,77],79:[2,77]},{23:48,36:50,37:[1,52],41:51,42:[1,53],43:49,45:[2,49]},{26:54,41:55,42:[1,53],45:[2,51]},{16:[1,56]},{31:[2,81],55:57,59:[2,81],66:[2,81],74:[2,81],75:[2,81],76:[2,81],77:[2,81],78:[2,81],79:[2,81]},{31:[2,37],59:[2,37],66:[2,37],74:[2,37],75:[2,37],76:[2,37],77:[2,37],78:[2,37],79:[2,37]},{31:[2,38],59:[2,38],66:[2,38],74:[2,38],75:[2,38],76:[2,38],77:[2,38],78:[2,38],79:[2,38]},{18:58,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{28:59,31:[2,53],59:[2,53],66:[2,53],69:[2,53],74:[2,53],75:[2,53],76:[2,53],77:[2,53],78:[2,53],79:[2,53]},{31:[2,59],33:60,59:[2,59],66:[2,59],69:[2,59],74:[2,59],75:[2,59],76:[2,59],77:[2,59],78:[2,59],79:[2,59]},{19:61,21:[2,45],59:[2,45],66:[2,45],74:[2,45],75:[2,45],76:[2,45],77:[2,45],78:[2,45],79:[2,45]},{18:65,31:[2,75],48:62,57:63,58:66,59:[1,40],63:64,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{66:[1,70]},{21:[2,39],31:[2,39],52:[2,39],59:[2,39],62:[2,39],66:[2,39],69:[2,39],74:[2,39],75:[2,39],76:[2,39],77:[2,39],78:[2,39],79:[2,39],81:[1,45]},{18:65,51:71,52:[2,79],57:72,58:66,59:[1,40],63:73,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{24:74,45:[1,75]},{45:[2,50]},{4:76,6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],37:[2,43],42:[2,43],45:[2,43],46:[2,43],49:[2,43],53:[2,43]},{45:[2,19]},{18:77,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{4:78,6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],45:[2,43],46:[2,43],49:[2,43],53:[2,43]},{24:79,45:[1,75]},{45:[2,52]},{5:[2,10],13:[2,10],14:[2,10],17:[2,10],27:[2,10],32:[2,10],37:[2,10],42:[2,10],45:[2,10],46:[2,10],49:[2,10],53:[2,10]},{18:65,31:[2,83],56:80,57:81,58:66,59:[1,40],63:82,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{59:[2,85],60:83,62:[2,85],66:[2,85],74:[2,85],75:[2,85],76:[2,85],77:[2,85],78:[2,85],79:[2,85]},{18:65,29:84,31:[2,55],57:85,58:66,59:[1,40],63:86,64:67,65:68,66:[1,69],69:[2,55],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:65,31:[2,61],34:87,57:88,58:66,59:[1,40],63:89,64:67,65:68,66:[1,69],69:[2,61],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:65,20:90,21:[2,47],57:91,58:66,59:[1,40],63:92,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{31:[1,93]},{31:[2,74],59:[2,74],66:[2,74],74:[2,74],75:[2,74],76:[2,74],77:[2,74],78:[2,74],79:[2,74]},{31:[2,76]},{21:[2,24],31:[2,24],52:[2,24],59:[2,24],62:[2,24],66:[2,24],69:[2,24],74:[2,24],75:[2,24],76:[2,24],77:[2,24],78:[2,24],79:[2,24]},{21:[2,25],31:[2,25],52:[2,25],59:[2,25],62:[2,25],66:[2,25],69:[2,25],74:[2,25],75:[2,25],76:[2,25],77:[2,25],78:[2,25],79:[2,25]},{21:[2,27],31:[2,27],52:[2,27],62:[2,27],65:94,66:[1,95],69:[2,27]},{21:[2,89],31:[2,89],52:[2,89],62:[2,89],66:[2,89],69:[2,89]},{21:[2,42],31:[2,42],52:[2,42],59:[2,42],62:[2,42],66:[2,42],67:[1,96],69:[2,42],74:[2,42],75:[2,42],76:[2,42],77:[2,42],78:[2,42],79:[2,42],81:[2,42]},{21:[2,41],31:[2,41],52:[2,41],59:[2,41],62:[2,41],66:[2,41],69:[2,41],74:[2,41],75:[2,41],76:[2,41],77:[2,41],78:[2,41],79:[2,41],81:[2,41]},{52:[1,97]},{52:[2,78],59:[2,78],66:[2,78],74:[2,78],75:[2,78],76:[2,78],77:[2,78],78:[2,78],79:[2,78]},{52:[2,80]},{5:[2,12],13:[2,12],14:[2,12],17:[2,12],27:[2,12],32:[2,12],37:[2,12],42:[2,12],45:[2,12],46:[2,12],49:[2,12],53:[2,12]},{18:98,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{36:50,37:[1,52],41:51,42:[1,53],43:100,44:99,45:[2,71]},{31:[2,65],38:101,59:[2,65],66:[2,65],69:[2,65],74:[2,65],75:[2,65],76:[2,65],77:[2,65],78:[2,65],79:[2,65]},{45:[2,17]},{5:[2,13],13:[2,13],14:[2,13],17:[2,13],27:[2,13],32:[2,13],37:[2,13],42:[2,13],45:[2,13],46:[2,13],49:[2,13],53:[2,13]},{31:[1,102]},{31:[2,82],59:[2,82],66:[2,82],74:[2,82],75:[2,82],76:[2,82],77:[2,82],78:[2,82],79:[2,82]},{31:[2,84]},{18:65,57:104,58:66,59:[1,40],61:103,62:[2,87],63:105,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{30:106,31:[2,57],68:107,69:[1,108]},{31:[2,54],59:[2,54],66:[2,54],69:[2,54],74:[2,54],75:[2,54],76:[2,54],77:[2,54],78:[2,54],79:[2,54]},{31:[2,56],69:[2,56]},{31:[2,63],35:109,68:110,69:[1,108]},{31:[2,60],59:[2,60],66:[2,60],69:[2,60],74:[2,60],75:[2,60],76:[2,60],77:[2,60],78:[2,60],79:[2,60]},{31:[2,62],69:[2,62]},{21:[1,111]},{21:[2,46],59:[2,46],66:[2,46],74:[2,46],75:[2,46],76:[2,46],77:[2,46],78:[2,46],79:[2,46]},{21:[2,48]},{5:[2,21],13:[2,21],14:[2,21],17:[2,21],27:[2,21],32:[2,21],37:[2,21],42:[2,21],45:[2,21],46:[2,21],49:[2,21],53:[2,21]},{21:[2,90],31:[2,90],52:[2,90],62:[2,90],66:[2,90],69:[2,90]},{67:[1,96]},{18:65,57:112,58:66,59:[1,40],66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{5:[2,22],13:[2,22],14:[2,22],17:[2,22],27:[2,22],32:[2,22],37:[2,22],42:[2,22],45:[2,22],46:[2,22],49:[2,22],53:[2,22]},{31:[1,113]},{45:[2,18]},{45:[2,72]},{18:65,31:[2,67],39:114,57:115,58:66,59:[1,40],63:116,64:67,65:68,66:[1,69],69:[2,67],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{5:[2,23],13:[2,23],14:[2,23],17:[2,23],27:[2,23],32:[2,23],37:[2,23],42:[2,23],45:[2,23],46:[2,23],49:[2,23],53:[2,23]},{62:[1,117]},{59:[2,86],62:[2,86],66:[2,86],74:[2,86],75:[2,86],76:[2,86],77:[2,86],78:[2,86],79:[2,86]},{62:[2,88]},{31:[1,118]},{31:[2,58]},{66:[1,120],70:119},{31:[1,121]},{31:[2,64]},{14:[2,11]},{21:[2,28],31:[2,28],52:[2,28],62:[2,28],66:[2,28],69:[2,28]},{5:[2,20],13:[2,20],14:[2,20],17:[2,20],27:[2,20],32:[2,20],37:[2,20],42:[2,20],45:[2,20],46:[2,20],49:[2,20],53:[2,20]},{31:[2,69],40:122,68:123,69:[1,108]},{31:[2,66],59:[2,66],66:[2,66],69:[2,66],74:[2,66],75:[2,66],76:[2,66],77:[2,66],78:[2,66],79:[2,66]},{31:[2,68],69:[2,68]},{21:[2,26],31:[2,26],52:[2,26],59:[2,26],62:[2,26],66:[2,26],69:[2,26],74:[2,26],75:[2,26],76:[2,26],77:[2,26],78:[2,26],79:[2,26]},{13:[2,14],14:[2,14],17:[2,14],27:[2,14],32:[2,14],37:[2,14],42:[2,14],45:[2,14],46:[2,14],49:[2,14],53:[2,14]},{66:[1,125],71:[1,124]},{66:[2,91],71:[2,91]},{13:[2,15],14:[2,15],17:[2,15],27:[2,15],32:[2,15],42:[2,15],45:[2,15],46:[2,15],49:[2,15],53:[2,15]},{31:[1,126]},{31:[2,70]},{31:[2,29]},{66:[2,92],71:[2,92]},{13:[2,16],14:[2,16],17:[2,16],27:[2,16],32:[2,16],37:[2,16],42:[2,16],45:[2,16],46:[2,16],49:[2,16],53:[2,16]}],defaultActions:{4:[2,1],49:[2,50],51:[2,19],55:[2,52],64:[2,76],73:[2,80],78:[2,17],82:[2,84],92:[2,48],99:[2,18],100:[2,72],105:[2,88],107:[2,58],110:[2,64],111:[2,11],123:[2,70],124:[2,29]},parseError:function(a,b){throw new Error(a)},parse:function(a){function b(){var a;return a=c.lexer.lex()||1,"number"!=typeof a&&(a=c.symbols_[a]||a),a}var c=this,d=[0],e=[null],f=[],g=this.table,h="",i=0,j=0,k=0;this.lexer.setInput(a),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var l=this.lexer.yylloc;f.push(l);var m=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var n,o,p,q,r,s,t,u,v,w={};;){if(p=d[d.length-1],this.defaultActions[p]?q=this.defaultActions[p]:((null===n||"undefined"==typeof n)&&(n=b()),q=g[p]&&g[p][n]),"undefined"==typeof q||!q.length||!q[0]){var x="";if(!k){v=[];for(s in g[p])this.terminals_[s]&&s>2&&v.push("'"+this.terminals_[s]+"'");x=this.lexer.showPosition?"Parse error on line "+(i+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+v.join(", ")+", got '"+(this.terminals_[n]||n)+"'":"Parse error on line "+(i+1)+": Unexpected "+(1==n?"end of input":"'"+(this.terminals_[n]||n)+"'"),this.parseError(x,{text:this.lexer.match,token:this.terminals_[n]||n,line:this.lexer.yylineno,loc:l,expected:v})}}if(q[0]instanceof Array&&q.length>1)throw new Error("Parse Error: multiple actions possible at state: "+p+", token: "+n);switch(q[0]){case 1:d.push(n),e.push(this.lexer.yytext),f.push(this.lexer.yylloc),d.push(q[1]),n=null,o?(n=o,o=null):(j=this.lexer.yyleng,h=this.lexer.yytext,i=this.lexer.yylineno,l=this.lexer.yylloc,k>0&&k--);break;case 2:if(t=this.productions_[q[1]][1],w.$=e[e.length-t],w._$={first_line:f[f.length-(t||1)].first_line,last_line:f[f.length-1].last_line,first_column:f[f.length-(t||1)].first_column,last_column:f[f.length-1].last_column},m&&(w._$.range=[f[f.length-(t||1)].range[0],f[f.length-1].range[1]]),r=this.performAction.call(w,h,j,i,this.yy,q[1],e,f),"undefined"!=typeof r)return r;t&&(d=d.slice(0,-1*t*2),e=e.slice(0,-1*t),f=f.slice(0,-1*t)),d.push(this.productions_[q[1]][0]),e.push(w.$),f.push(w._$),u=g[d[d.length-2]][d[d.length-1]],d.push(u);break;case 3:return!0}}return!0}},c=function(){var a={EOF:1,parseError:function(a,b){if(!this.yy.parser)throw new Error(a);this.yy.parser.parseError(a,b)},setInput:function(a){return this._input=a,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var a=this._input[0];this.yytext+=a,this.yyleng++,this.offset++,this.match+=a,this.matched+=a;var b=a.match(/(?:\r\n?|\n).*/g);return b?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),a},unput:function(a){var b=a.length,c=a.split(/(?:\r\n?|\n)/g);this._input=a+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-b-1),this.offset-=b;var d=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),c.length-1&&(this.yylineno-=c.length-1);var e=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:c?(c.length===d.length?this.yylloc.first_column:0)+d[d.length-c.length].length-c[0].length:this.yylloc.first_column-b},this.options.ranges&&(this.yylloc.range=[e[0],e[0]+this.yyleng-b]),this},more:function(){return this._more=!0,this},less:function(a){this.unput(this.match.slice(a))},pastInput:function(){var a=this.matched.substr(0,this.matched.length-this.match.length);return(a.length>20?"...":"")+a.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var a=this.match;return a.length<20&&(a+=this._input.substr(0,20-a.length)),(a.substr(0,20)+(a.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var a=this.pastInput(),b=new Array(a.length+1).join("-");return a+this.upcomingInput()+"\n"+b+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var a,b,c,d,e;this._more||(this.yytext="",this.match="");for(var f=this._currentRules(),g=0;g<f.length&&(c=this._input.match(this.rules[f[g]]),!c||b&&!(c[0].length>b[0].length)||(b=c,d=g,this.options.flex));g++);return b?(e=b[0].match(/(?:\r\n?|\n).*/g),e&&(this.yylineno+=e.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:e?e[e.length-1].length-e[e.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+b[0].length},this.yytext+=b[0],this.match+=b[0],this.matches=b,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(b[0].length),this.matched+=b[0],a=this.performAction.call(this,this.yy,this,f[d],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),a?a:void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var a=this.next();return"undefined"!=typeof a?a:this.lex()},begin:function(a){this.conditionStack.push(a)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(a){this.begin(a)}};return a.options={},a.performAction=function(a,b,c,d){function e(a,c){return b.yytext=b.yytext.substr(a,b.yyleng-c)}switch(c){case 0:if("\\\\"===b.yytext.slice(-2)?(e(0,1),this.begin("mu")):"\\"===b.yytext.slice(-1)?(e(0,1),this.begin("emu")):this.begin("mu"),b.yytext)return 14;break;case 1:return 14;case 2:return this.popState(),14;case 3:return b.yytext=b.yytext.substr(5,b.yyleng-9),this.popState(),16;case 4:return 14;case 5:return this.popState(),13;case 6:return 59;case 7:return 62;case 8:return 17;case 9:return this.popState(),this.begin("raw"),21;case 10:return 53;case 11:return 27;case 12:return 45;case 13:return this.popState(),42;case 14:return this.popState(),42;case 15:return 32;case 16:return 37;case 17:return 49;case 18:return 46;case 19:this.unput(b.yytext),this.popState(),this.begin("com");break;case 20:return this.popState(),13;case 21:return 46;case 22:return 67;case 23:return 66;case 24:return 66;case 25:return 81;case 26:break;case 27:return this.popState(),52;case 28:return this.popState(),31;case 29:return b.yytext=e(1,2).replace(/\\"/g,'"'),74;case 30:return b.yytext=e(1,2).replace(/\\'/g,"'"),74;case 31:return 79;case 32:return 76;case 33:return 76;case 34:return 77;case 35:return 78;case 36:return 75;case 37:return 69;case 38:return 71;case 39:return 66;case 40:return 66;case 41:return"INVALID";case 42:return 5}},a.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]*?(?=(\{\{\{\{\/)))/,/^(?:[\s\S]*?--(~)?\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{(~)?!--)/,/^(?:\{\{(~)?![\s\S]*?\}\})/,/^(?:\{\{(~)?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)|])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:undefined(?=([~}\s)])))/,/^(?:null(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:as\s+\|)/,/^(?:\|)/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)|]))))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/],a.conditions={mu:{rules:[6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[5],inclusive:!1},raw:{rules:[3,4],inclusive:!1},INITIAL:{rules:[0,1,42],inclusive:!0}},a}();return b.lexer=c,a.prototype=b,b.Parser=a,new a}();c["default"]=d,b.exports=c["default"]},{}],178:[function(a,b,c){"use strict";function d(a){return(new e).accept(a)}function e(){this.padding=0}var f=function(a){return a&&a.__esModule?a:{"default":a}};c.__esModule=!0,c.print=d,c.PrintVisitor=e;var g=a("./visitor"),h=f(g);e.prototype=new h["default"],e.prototype.pad=function(a){for(var b="",c=0,d=this.padding;d>c;c++)b+="  ";return b=b+a+"\n"},e.prototype.Program=function(a){var b="",c=a.body,d=void 0,e=void 0;if(a.blockParams){var f="BLOCK PARAMS: [";for(d=0,e=a.blockParams.length;e>d;d++)f+=" "+a.blockParams[d];f+=" ]",b+=this.pad(f)}for(d=0,e=c.length;e>d;d++)b+=this.accept(c[d]);return this.padding--,b},e.prototype.MustacheStatement=function(a){return this.pad("{{ "+this.SubExpression(a)+" }}")},e.prototype.BlockStatement=function(a){var b="";return b+=this.pad("BLOCK:"),this.padding++,b+=this.pad(this.SubExpression(a)),a.program&&(b+=this.pad("PROGRAM:"),this.padding++,b+=this.accept(a.program),this.padding--),a.inverse&&(a.program&&this.padding++,b+=this.pad("{{^}}"),this.padding++,b+=this.accept(a.inverse),this.padding--,a.program&&this.padding--),this.padding--,b},e.prototype.PartialStatement=function(a){var b="PARTIAL:"+a.name.original;return a.params[0]&&(b+=" "+this.accept(a.params[0])),a.hash&&(b+=" "+this.accept(a.hash)),this.pad("{{> "+b+" }}")},e.prototype.ContentStatement=function(a){return this.pad("CONTENT[ '"+a.value+"' ]")},e.prototype.CommentStatement=function(a){return this.pad("{{! '"+a.value+"' }}")},e.prototype.SubExpression=function(a){for(var b=a.params,c=[],d=void 0,e=0,f=b.length;f>e;e++)c.push(this.accept(b[e]));return b="["+c.join(", ")+"]",d=a.hash?" "+this.accept(a.hash):"",this.accept(a.path)+" "+b+d},e.prototype.PathExpression=function(a){var b=a.parts.join("/");return(a.data?"@":"")+"PATH:"+b},e.prototype.StringLiteral=function(a){return'"'+a.value+'"'},e.prototype.NumberLiteral=function(a){return"NUMBER{"+a.value+"}"},e.prototype.BooleanLiteral=function(a){return"BOOLEAN{"+a.value+"}"},e.prototype.UndefinedLiteral=function(){return"UNDEFINED"},e.prototype.NullLiteral=function(){return"NULL"},e.prototype.Hash=function(a){for(var b=a.pairs,c=[],d=0,e=b.length;e>d;d++)c.push(this.accept(b[d]));return"HASH{"+c.join(", ")+"}"},e.prototype.HashPair=function(a){return a.key+"="+this.accept(a.value)}},{"./visitor":179}],179:[function(a,b,c){"use strict";function d(){this.parents=[]}var e=function(a){return a&&a.__esModule?a:{"default":a}};c.__esModule=!0;var f=a("../exception"),g=e(f),h=a("./ast"),i=e(h);d.prototype={constructor:d,mutating:!1,acceptKey:function(a,b){var c=this.accept(a[b]);if(this.mutating){if(c&&(!c.type||!i["default"][c.type]))throw new g["default"]('Unexpected node type "'+c.type+'" found when accepting '+b+" on "+a.type);a[b]=c}},acceptRequired:function(a,b){if(this.acceptKey(a,b),!a[b])throw new g["default"](a.type+" requires "+b)},acceptArray:function(a){for(var b=0,c=a.length;c>b;b++)this.acceptKey(a,b),a[b]||(a.splice(b,1),b--,c--)},accept:function(a){if(a){this.current&&this.parents.unshift(this.current),this.current=a;var b=this[a.type](a);return this.current=this.parents.shift(),!this.mutating||b?b:b!==!1?a:void 0}},Program:function(a){this.acceptArray(a.body)},MustacheStatement:function(a){this.acceptRequired(a,"path"),this.acceptArray(a.params),this.acceptKey(a,"hash")},BlockStatement:function(a){this.acceptRequired(a,"path"),this.acceptArray(a.params),this.acceptKey(a,"hash"),this.acceptKey(a,"program"),this.acceptKey(a,"inverse")},PartialStatement:function(a){this.acceptRequired(a,"name"),this.acceptArray(a.params),this.acceptKey(a,"hash")},ContentStatement:function(){},CommentStatement:function(){},SubExpression:function(a){this.acceptRequired(a,"path"),this.acceptArray(a.params),this.acceptKey(a,"hash")},PathExpression:function(){},StringLiteral:function(){},NumberLiteral:function(){},BooleanLiteral:function(){},UndefinedLiteral:function(){},NullLiteral:function(){},Hash:function(a){this.acceptArray(a.pairs)},HashPair:function(a){this.acceptRequired(a,"value")}},c["default"]=d,b.exports=c["default"]},{"../exception":181,"./ast":171}],180:[function(a,b,c){"use strict";function d(){}function e(a,b,c){void 0===b&&(b=a.length);var d=a[b-1],e=a[b-2];return d?"ContentStatement"===d.type?(e||!c?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(d.original):void 0:c}function f(a,b,c){void 0===b&&(b=-1);var d=a[b+1],e=a[b+2];return d?"ContentStatement"===d.type?(e||!c?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(d.original):void 0:c}function g(a,b,c){var d=a[null==b?0:b+1];if(d&&"ContentStatement"===d.type&&(c||!d.rightStripped)){var e=d.value;d.value=d.value.replace(c?/^\s+/:/^[ \t]*\r?\n?/,""),d.rightStripped=d.value!==e}}function h(a,b,c){var d=a[null==b?a.length-1:b-1];if(d&&"ContentStatement"===d.type&&(c||!d.leftStripped)){var e=d.value;return d.value=d.value.replace(c?/\s+$/:/[ \t]+$/,""),d.leftStripped=d.value!==e,d.leftStripped}}var i=function(a){return a&&a.__esModule?a:{"default":a}};c.__esModule=!0;var j=a("./visitor"),k=i(j);d.prototype=new k["default"],d.prototype.Program=function(a){var b=!this.isRootSeen;this.isRootSeen=!0;for(var c=a.body,d=0,i=c.length;i>d;d++){var j=c[d],k=this.accept(j);if(k){var l=e(c,d,b),m=f(c,d,b),n=k.openStandalone&&l,o=k.closeStandalone&&m,p=k.inlineStandalone&&l&&m;k.close&&g(c,d,!0),k.open&&h(c,d,!0),p&&(g(c,d),h(c,d)&&"PartialStatement"===j.type&&(j.indent=/([ \t]+$)/.exec(c[d-1].original)[1])),n&&(g((j.program||j.inverse).body),h(c,d)),o&&(g(c,d),h((j.inverse||j.program).body))}}return a},d.prototype.BlockStatement=function(a){this.accept(a.program),this.accept(a.inverse);var b=a.program||a.inverse,c=a.program&&a.inverse,d=c,i=c;if(c&&c.chained)for(d=c.body[0].program;i.chained;)i=i.body[i.body.length-1].program;var j={open:a.openStrip.open,close:a.closeStrip.close,openStandalone:f(b.body),closeStandalone:e((d||b).body)};if(a.openStrip.close&&g(b.body,null,!0),c){var k=a.inverseStrip;k.open&&h(b.body,null,!0),k.close&&g(d.body,null,!0),a.closeStrip.open&&h(i.body,null,!0),e(b.body)&&f(d.body)&&(h(b.body),g(d.body))}else a.closeStrip.open&&h(b.body,null,!0);return j},d.prototype.MustacheStatement=function(a){return a.strip},d.prototype.PartialStatement=d.prototype.CommentStatement=function(a){var b=a.strip||{};return{inlineStandalone:!0,open:b.open,close:b.close}},c["default"]=d,b.exports=c["default"]},{"./visitor":179}],181:[function(a,b,c){"use strict";function d(a,b){var c=b&&b.loc,f=void 0,g=void 0;c&&(f=c.start.line,g=c.start.column,a+=" - "+f+":"+g);for(var h=Error.prototype.constructor.call(this,a),i=0;i<e.length;i++)this[e[i]]=h[e[i]];Error.captureStackTrace&&Error.captureStackTrace(this,d),c&&(this.lineNumber=f,this.column=g)}c.__esModule=!0;var e=["description","fileName","lineNumber","message","name","number","stack"];d.prototype=new Error,c["default"]=d,b.exports=c["default"]},{}],182:[function(a,b,c){"use strict";c.__esModule=!0,c["default"]=function(a){var b="undefined"!=typeof global?global:window,c=b.Handlebars;a.noConflict=function(){b.Handlebars===a&&(b.Handlebars=c)}},b.exports=c["default"]},{}],183:[function(a,b,c){"use strict";function d(a){var b=a&&a[0]||1,c=p.COMPILER_REVISION;if(b!==c){if(c>b){var d=p.REVISION_CHANGES[c],e=p.REVISION_CHANGES[b];throw new o["default"]("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+d+") or downgrade your runtime to an older version ("+e+").")}throw new o["default"]("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+a[1]+").")}}function e(a,b){function c(c,d,e){e.hash&&(d=m.extend({},d,e.hash)),c=b.VM.resolvePartial.call(this,c,d,e);var f=b.VM.invokePartial.call(this,c,d,e);if(null==f&&b.compile&&(e.partials[e.name]=b.compile(c,a.compilerOptions,b),f=e.partials[e.name](d,e)),null!=f){if(e.indent){for(var g=f.split("\n"),h=0,i=g.length;i>h&&(g[h]||h+1!==i);h++)g[h]=e.indent+g[h];f=g.join("\n")}return f}throw new o["default"]("The partial "+e.name+" could not be compiled when running in runtime-only mode")}function d(b){var c=void 0===arguments[1]?{}:arguments[1],f=c.data;d._setup(c),!c.partial&&a.useData&&(f=j(b,f));var g=void 0,h=a.useBlockParams?[]:void 0;return a.useDepths&&(g=c.depths?[b].concat(c.depths):[b]),a.main.call(e,b,e.helpers,e.partials,f,h,g)}if(!b)throw new o["default"]("No environment passed to template");if(!a||!a.main)throw new o["default"]("Unknown template object: "+typeof a);b.VM.checkRevision(a.compiler);var e={strict:function(a,b){if(!(b in a))throw new o["default"]('"'+b+'" not defined in '+a);return a[b]},lookup:function(a,b){for(var c=a.length,d=0;c>d;d++)if(a[d]&&null!=a[d][b])return a[d][b]},lambda:function(a,b){return"function"==typeof a?a.call(b):a},escapeExpression:m.escapeExpression,invokePartial:c,fn:function(b){return a[b]},programs:[],program:function(a,b,c,d,e){var g=this.programs[a],h=this.fn(a);return b||e||d||c?g=f(this,a,h,b,c,d,e):g||(g=this.programs[a]=f(this,a,h)),g},data:function(a,b){for(;a&&b--;)a=a._parent;return a},merge:function(a,b){var c=a||b;return a&&b&&a!==b&&(c=m.extend({},b,a)),c},noop:b.VM.noop,compilerInfo:a.compiler};return d.isTop=!0,d._setup=function(c){c.partial?(e.helpers=c.helpers,e.partials=c.partials):(e.helpers=e.merge(c.helpers,b.helpers),a.usePartial&&(e.partials=e.merge(c.partials,b.partials)))},d._child=function(b,c,d,g){if(a.useBlockParams&&!d)throw new o["default"]("must pass block params");if(a.useDepths&&!g)throw new o["default"]("must pass parent depths");return f(e,b,a[b],c,0,d,g)},d}function f(a,b,c,d,e,f,g){function h(b){var e=void 0===arguments[1]?{}:arguments[1];return c.call(a,b,a.helpers,a.partials,e.data||d,f&&[e.blockParams].concat(f),g&&[b].concat(g))}return h.program=b,h.depth=g?g.length:0,h.blockParams=e||0,h}function g(a,b,c){return a?a.call||c.name||(c.name=a,a=c.partials[a]):a=c.partials[c.name],a}function h(a,b,c){if(c.partial=!0,void 0===a)throw new o["default"]("The partial "+c.name+" could not be found");return a instanceof Function?a(b,c):void 0}function i(){return""}function j(a,b){return b&&"root"in b||(b=b?p.createFrame(b):{},b.root=a),b}var k=function(a){return a&&a.__esModule?a:{"default":a}};c.__esModule=!0,c.checkRevision=d,c.template=e,c.wrapProgram=f,c.resolvePartial=g,c.invokePartial=h,c.noop=i;var l=a("./utils"),m=k(l),n=a("./exception"),o=k(n),p=a("./base")},{"./base":170,"./exception":181,"./utils":185}],184:[function(a,b,c){"use strict";function d(a){this.string=a}c.__esModule=!0,d.prototype.toString=d.prototype.toHTML=function(){return""+this.string},c["default"]=d,b.exports=c["default"]},{}],185:[function(a,b,c){"use strict";function d(a){return k[a]}function e(a){for(var b=1;b<arguments.length;b++)for(var c in arguments[b])Object.prototype.hasOwnProperty.call(arguments[b],c)&&(a[c]=arguments[b][c]);return a}function f(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1}function g(a){if("string"!=typeof a){if(a&&a.toHTML)return a.toHTML();if(null==a)return"";if(!a)return a+"";a=""+a}return m.test(a)?a.replace(l,d):a}function h(a){return a||0===a?p(a)&&0===a.length?!0:!1:!0}function i(a,b){return a.path=b,a}function j(a,b){return(a?a+".":"")+b}c.__esModule=!0,c.extend=e,c.indexOf=f,c.escapeExpression=g,c.isEmpty=h,c.blockParams=i,c.appendContextPath=j;var k={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},l=/[&<>"'`]/g,m=/[&<>"'`]/,n=Object.prototype.toString;c.toString=n;var o=function(a){return"function"==typeof a};o(/x/)&&(c.isFunction=o=function(a){return"function"==typeof a&&"[object Function]"===n.call(a)});var o;c.isFunction=o;var p=Array.isArray||function(a){return a&&"object"==typeof a?"[object Array]"===n.call(a):!1};c.isArray=p},{}],186:[function(a,b,c){function d(b,c){var d=a("fs"),f=d.readFileSync(c,"utf8");b.exports=e.compile(f)}var e=a("../dist/cjs/handlebars")["default"],f=a("../dist/cjs/handlebars/compiler/printer");e.PrintVisitor=f.PrintVisitor,e.print=f.print,b.exports=e,"undefined"!=typeof a&&a.extensions&&(a.extensions[".handlebars"]=d,a.extensions[".hbs"]=d)},{"../dist/cjs/handlebars":168,"../dist/cjs/handlebars/compiler/printer":178,fs:166}],187:[function(a,b,c){c.SourceMapGenerator=a("./source-map/source-map-generator").SourceMapGenerator,c.SourceMapConsumer=a("./source-map/source-map-consumer").SourceMapConsumer,c.SourceNode=a("./source-map/source-node").SourceNode},{"./source-map/source-map-consumer":193,"./source-map/source-map-generator":194,"./source-map/source-node":195}],188:[function(a,b,c){if("function"!=typeof d)var d=a("amdefine")(b,a);d(function(a,b,c){function d(){this._array=[],this._set={}}var e=a("./util");d.fromArray=function(a,b){for(var c=new d,e=0,f=a.length;f>e;e++)c.add(a[e],b);return c},d.prototype.add=function(a,b){var c=this.has(a),d=this._array.length;(!c||b)&&this._array.push(a),c||(this._set[e.toSetString(a)]=d)},d.prototype.has=function(a){return Object.prototype.hasOwnProperty.call(this._set,e.toSetString(a))},d.prototype.indexOf=function(a){if(this.has(a))return this._set[e.toSetString(a)];throw new Error('"'+a+'" is not in the set.')},d.prototype.at=function(a){if(a>=0&&a<this._array.length)return this._array[a];throw new Error("No element indexed by "+a)},d.prototype.toArray=function(){return this._array.slice()},b.ArraySet=d})},{"./util":196,amdefine:197}],189:[function(a,b,c){if("function"!=typeof d)var d=a("amdefine")(b,a);d(function(a,b,c){function d(a){return 0>a?(-a<<1)+1:(a<<1)+0}function e(a){var b=1===(1&a),c=a>>1;return b?-c:c}var f=a("./base64"),g=5,h=1<<g,i=h-1,j=h;b.encode=function(a){var b,c="",e=d(a);do b=e&i,e>>>=g,e>0&&(b|=j),c+=f.encode(b);while(e>0);return c},b.decode=function(a,b){var c,d,h=0,k=a.length,l=0,m=0;do{if(h>=k)throw new Error("Expected more digits in base 64 VLQ value.");d=f.decode(a.charAt(h++)),c=!!(d&j),d&=i,l+=d<<m,m+=g}while(c);b.value=e(l),b.rest=a.slice(h)}})},{"./base64":190,amdefine:197}],190:[function(a,b,c){if("function"!=typeof d)var d=a("amdefine")(b,a);d(function(a,b,c){var d={},e={};"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("").forEach(function(a,b){d[a]=b,e[b]=a}),b.encode=function(a){if(a in e)return e[a];throw new TypeError("Must be between 0 and 63: "+a)},b.decode=function(a){if(a in d)return d[a];throw new TypeError("Not a valid base 64 digit: "+a)}})},{amdefine:197}],191:[function(a,b,c){if("function"!=typeof d)var d=a("amdefine")(b,a);d(function(a,b,c){function d(a,b,c,e,f){var g=Math.floor((b-a)/2)+a,h=f(c,e[g],!0);return 0===h?g:h>0?b-g>1?d(g,b,c,e,f):g:g-a>1?d(a,g,c,e,f):0>a?-1:a}b.search=function(a,b,c){return 0===b.length?-1:d(-1,b.length,a,b,c)}})},{amdefine:197}],192:[function(a,b,c){if("function"!=typeof d)var d=a("amdefine")(b,a);d(function(a,b,c){function d(a,b){
var c=a.generatedLine,d=b.generatedLine,e=a.generatedColumn,g=b.generatedColumn;return d>c||d==c&&g>=e||f.compareByGeneratedPositions(a,b)<=0}function e(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}var f=a("./util");e.prototype.unsortedForEach=function(a,b){this._array.forEach(a,b)},e.prototype.add=function(a){d(this._last,a)?(this._last=a,this._array.push(a)):(this._sorted=!1,this._array.push(a))},e.prototype.toArray=function(){return this._sorted||(this._array.sort(f.compareByGeneratedPositions),this._sorted=!0),this._array},b.MappingList=e})},{"./util":196,amdefine:197}],193:[function(a,b,c){if("function"!=typeof d)var d=a("amdefine")(b,a);d(function(a,b,c){function d(a){var b=a;"string"==typeof a&&(b=JSON.parse(a.replace(/^\)\]\}'/,"")));var c=e.getArg(b,"version"),d=e.getArg(b,"sources"),f=e.getArg(b,"names",[]),h=e.getArg(b,"sourceRoot",null),i=e.getArg(b,"sourcesContent",null),j=e.getArg(b,"mappings"),k=e.getArg(b,"file",null);if(c!=this._version)throw new Error("Unsupported version: "+c);d=d.map(e.normalize),this._names=g.fromArray(f,!0),this._sources=g.fromArray(d,!0),this.sourceRoot=h,this.sourcesContent=i,this._mappings=j,this.file=k}var e=a("./util"),f=a("./binary-search"),g=a("./array-set").ArraySet,h=a("./base64-vlq");d.fromSourceMap=function(a){var b=Object.create(d.prototype);return b._names=g.fromArray(a._names.toArray(),!0),b._sources=g.fromArray(a._sources.toArray(),!0),b.sourceRoot=a._sourceRoot,b.sourcesContent=a._generateSourcesContent(b._sources.toArray(),b.sourceRoot),b.file=a._file,b.__generatedMappings=a._mappings.toArray().slice(),b.__originalMappings=a._mappings.toArray().slice().sort(e.compareByOriginalPositions),b},d.prototype._version=3,Object.defineProperty(d.prototype,"sources",{get:function(){return this._sources.toArray().map(function(a){return null!=this.sourceRoot?e.join(this.sourceRoot,a):a},this)}}),d.prototype.__generatedMappings=null,Object.defineProperty(d.prototype,"_generatedMappings",{get:function(){return this.__generatedMappings||(this.__generatedMappings=[],this.__originalMappings=[],this._parseMappings(this._mappings,this.sourceRoot)),this.__generatedMappings}}),d.prototype.__originalMappings=null,Object.defineProperty(d.prototype,"_originalMappings",{get:function(){return this.__originalMappings||(this.__generatedMappings=[],this.__originalMappings=[],this._parseMappings(this._mappings,this.sourceRoot)),this.__originalMappings}}),d.prototype._nextCharIsMappingSeparator=function(a){var b=a.charAt(0);return";"===b||","===b},d.prototype._parseMappings=function(a,b){for(var c,d=1,f=0,g=0,i=0,j=0,k=0,l=a,m={};l.length>0;)if(";"===l.charAt(0))d++,l=l.slice(1),f=0;else if(","===l.charAt(0))l=l.slice(1);else{if(c={},c.generatedLine=d,h.decode(l,m),c.generatedColumn=f+m.value,f=c.generatedColumn,l=m.rest,l.length>0&&!this._nextCharIsMappingSeparator(l)){if(h.decode(l,m),c.source=this._sources.at(j+m.value),j+=m.value,l=m.rest,0===l.length||this._nextCharIsMappingSeparator(l))throw new Error("Found a source, but no line and column");if(h.decode(l,m),c.originalLine=g+m.value,g=c.originalLine,c.originalLine+=1,l=m.rest,0===l.length||this._nextCharIsMappingSeparator(l))throw new Error("Found a source and line, but no column");h.decode(l,m),c.originalColumn=i+m.value,i=c.originalColumn,l=m.rest,l.length>0&&!this._nextCharIsMappingSeparator(l)&&(h.decode(l,m),c.name=this._names.at(k+m.value),k+=m.value,l=m.rest)}this.__generatedMappings.push(c),"number"==typeof c.originalLine&&this.__originalMappings.push(c)}this.__generatedMappings.sort(e.compareByGeneratedPositions),this.__originalMappings.sort(e.compareByOriginalPositions)},d.prototype._findMapping=function(a,b,c,d,e){if(a[c]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+a[c]);if(a[d]<0)throw new TypeError("Column must be greater than or equal to 0, got "+a[d]);return f.search(a,b,e)},d.prototype.computeColumnSpans=function(){for(var a=0;a<this._generatedMappings.length;++a){var b=this._generatedMappings[a];if(a+1<this._generatedMappings.length){var c=this._generatedMappings[a+1];if(b.generatedLine===c.generatedLine){b.lastGeneratedColumn=c.generatedColumn-1;continue}}b.lastGeneratedColumn=1/0}},d.prototype.originalPositionFor=function(a){var b={generatedLine:e.getArg(a,"line"),generatedColumn:e.getArg(a,"column")},c=this._findMapping(b,this._generatedMappings,"generatedLine","generatedColumn",e.compareByGeneratedPositions);if(c>=0){var d=this._generatedMappings[c];if(d.generatedLine===b.generatedLine){var f=e.getArg(d,"source",null);return null!=f&&null!=this.sourceRoot&&(f=e.join(this.sourceRoot,f)),{source:f,line:e.getArg(d,"originalLine",null),column:e.getArg(d,"originalColumn",null),name:e.getArg(d,"name",null)}}}return{source:null,line:null,column:null,name:null}},d.prototype.sourceContentFor=function(a){if(!this.sourcesContent)return null;if(null!=this.sourceRoot&&(a=e.relative(this.sourceRoot,a)),this._sources.has(a))return this.sourcesContent[this._sources.indexOf(a)];var b;if(null!=this.sourceRoot&&(b=e.urlParse(this.sourceRoot))){var c=a.replace(/^file:\/\//,"");if("file"==b.scheme&&this._sources.has(c))return this.sourcesContent[this._sources.indexOf(c)];if((!b.path||"/"==b.path)&&this._sources.has("/"+a))return this.sourcesContent[this._sources.indexOf("/"+a)]}throw new Error('"'+a+'" is not in the SourceMap.')},d.prototype.generatedPositionFor=function(a){var b={source:e.getArg(a,"source"),originalLine:e.getArg(a,"line"),originalColumn:e.getArg(a,"column")};null!=this.sourceRoot&&(b.source=e.relative(this.sourceRoot,b.source));var c=this._findMapping(b,this._originalMappings,"originalLine","originalColumn",e.compareByOriginalPositions);if(c>=0){var d=this._originalMappings[c];return{line:e.getArg(d,"generatedLine",null),column:e.getArg(d,"generatedColumn",null),lastColumn:e.getArg(d,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}},d.prototype.allGeneratedPositionsFor=function(a){var b={source:e.getArg(a,"source"),originalLine:e.getArg(a,"line"),originalColumn:1/0};null!=this.sourceRoot&&(b.source=e.relative(this.sourceRoot,b.source));var c=[],d=this._findMapping(b,this._originalMappings,"originalLine","originalColumn",e.compareByOriginalPositions);if(d>=0)for(var f=this._originalMappings[d];f&&f.originalLine===b.originalLine;)c.push({line:e.getArg(f,"generatedLine",null),column:e.getArg(f,"generatedColumn",null),lastColumn:e.getArg(f,"lastGeneratedColumn",null)}),f=this._originalMappings[--d];return c.reverse()},d.GENERATED_ORDER=1,d.ORIGINAL_ORDER=2,d.prototype.eachMapping=function(a,b,c){var f,g=b||null,h=c||d.GENERATED_ORDER;switch(h){case d.GENERATED_ORDER:f=this._generatedMappings;break;case d.ORIGINAL_ORDER:f=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var i=this.sourceRoot;f.map(function(a){var b=a.source;return null!=b&&null!=i&&(b=e.join(i,b)),{source:b,generatedLine:a.generatedLine,generatedColumn:a.generatedColumn,originalLine:a.originalLine,originalColumn:a.originalColumn,name:a.name}}).forEach(a,g)},b.SourceMapConsumer=d})},{"./array-set":188,"./base64-vlq":189,"./binary-search":191,"./util":196,amdefine:197}],194:[function(a,b,c){if("function"!=typeof d)var d=a("amdefine")(b,a);d(function(a,b,c){function d(a){a||(a={}),this._file=f.getArg(a,"file",null),this._sourceRoot=f.getArg(a,"sourceRoot",null),this._skipValidation=f.getArg(a,"skipValidation",!1),this._sources=new g,this._names=new g,this._mappings=new h,this._sourcesContents=null}var e=a("./base64-vlq"),f=a("./util"),g=a("./array-set").ArraySet,h=a("./mapping-list").MappingList;d.prototype._version=3,d.fromSourceMap=function(a){var b=a.sourceRoot,c=new d({file:a.file,sourceRoot:b});return a.eachMapping(function(a){var d={generated:{line:a.generatedLine,column:a.generatedColumn}};null!=a.source&&(d.source=a.source,null!=b&&(d.source=f.relative(b,d.source)),d.original={line:a.originalLine,column:a.originalColumn},null!=a.name&&(d.name=a.name)),c.addMapping(d)}),a.sources.forEach(function(b){var d=a.sourceContentFor(b);null!=d&&c.setSourceContent(b,d)}),c},d.prototype.addMapping=function(a){var b=f.getArg(a,"generated"),c=f.getArg(a,"original",null),d=f.getArg(a,"source",null),e=f.getArg(a,"name",null);this._skipValidation||this._validateMapping(b,c,d,e),null==d||this._sources.has(d)||this._sources.add(d),null==e||this._names.has(e)||this._names.add(e),this._mappings.add({generatedLine:b.line,generatedColumn:b.column,originalLine:null!=c&&c.line,originalColumn:null!=c&&c.column,source:d,name:e})},d.prototype.setSourceContent=function(a,b){var c=a;null!=this._sourceRoot&&(c=f.relative(this._sourceRoot,c)),null!=b?(this._sourcesContents||(this._sourcesContents={}),this._sourcesContents[f.toSetString(c)]=b):this._sourcesContents&&(delete this._sourcesContents[f.toSetString(c)],0===Object.keys(this._sourcesContents).length&&(this._sourcesContents=null))},d.prototype.applySourceMap=function(a,b,c){var d=b;if(null==b){if(null==a.file)throw new Error('SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map\'s "file" property. Both were omitted.');d=a.file}var e=this._sourceRoot;null!=e&&(d=f.relative(e,d));var h=new g,i=new g;this._mappings.unsortedForEach(function(b){if(b.source===d&&null!=b.originalLine){var g=a.originalPositionFor({line:b.originalLine,column:b.originalColumn});null!=g.source&&(b.source=g.source,null!=c&&(b.source=f.join(c,b.source)),null!=e&&(b.source=f.relative(e,b.source)),b.originalLine=g.line,b.originalColumn=g.column,null!=g.name&&(b.name=g.name))}var j=b.source;null==j||h.has(j)||h.add(j);var k=b.name;null==k||i.has(k)||i.add(k)},this),this._sources=h,this._names=i,a.sources.forEach(function(b){var d=a.sourceContentFor(b);null!=d&&(null!=c&&(b=f.join(c,b)),null!=e&&(b=f.relative(e,b)),this.setSourceContent(b,d))},this)},d.prototype._validateMapping=function(a,b,c,d){if((!(a&&"line"in a&&"column"in a&&a.line>0&&a.column>=0)||b||c||d)&&!(a&&"line"in a&&"column"in a&&b&&"line"in b&&"column"in b&&a.line>0&&a.column>=0&&b.line>0&&b.column>=0&&c))throw new Error("Invalid mapping: "+JSON.stringify({generated:a,source:c,original:b,name:d}))},d.prototype._serializeMappings=function(){for(var a,b=0,c=1,d=0,g=0,h=0,i=0,j="",k=this._mappings.toArray(),l=0,m=k.length;m>l;l++){if(a=k[l],a.generatedLine!==c)for(b=0;a.generatedLine!==c;)j+=";",c++;else if(l>0){if(!f.compareByGeneratedPositions(a,k[l-1]))continue;j+=","}j+=e.encode(a.generatedColumn-b),b=a.generatedColumn,null!=a.source&&(j+=e.encode(this._sources.indexOf(a.source)-i),i=this._sources.indexOf(a.source),j+=e.encode(a.originalLine-1-g),g=a.originalLine-1,j+=e.encode(a.originalColumn-d),d=a.originalColumn,null!=a.name&&(j+=e.encode(this._names.indexOf(a.name)-h),h=this._names.indexOf(a.name)))}return j},d.prototype._generateSourcesContent=function(a,b){return a.map(function(a){if(!this._sourcesContents)return null;null!=b&&(a=f.relative(b,a));var c=f.toSetString(a);return Object.prototype.hasOwnProperty.call(this._sourcesContents,c)?this._sourcesContents[c]:null},this)},d.prototype.toJSON=function(){var a={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return null!=this._file&&(a.file=this._file),null!=this._sourceRoot&&(a.sourceRoot=this._sourceRoot),this._sourcesContents&&(a.sourcesContent=this._generateSourcesContent(a.sources,a.sourceRoot)),a},d.prototype.toString=function(){return JSON.stringify(this)},b.SourceMapGenerator=d})},{"./array-set":188,"./base64-vlq":189,"./mapping-list":192,"./util":196,amdefine:197}],195:[function(a,b,c){if("function"!=typeof d)var d=a("amdefine")(b,a);d(function(a,b,c){function d(a,b,c,d,e){this.children=[],this.sourceContents={},this.line=null==a?null:a,this.column=null==b?null:b,this.source=null==c?null:c,this.name=null==e?null:e,this[i]=!0,null!=d&&this.add(d)}var e=a("./source-map-generator").SourceMapGenerator,f=a("./util"),g=/(\r?\n)/,h=10,i="$$$isSourceNode$$$";d.fromStringWithSourceMap=function(a,b,c){function e(a,b){if(null===a||void 0===a.source)h.add(b);else{var e=c?f.join(c,a.source):a.source;h.add(new d(a.originalLine,a.originalColumn,e,b,a.name))}}var h=new d,i=a.split(g),j=function(){var a=i.shift(),b=i.shift()||"";return a+b},k=1,l=0,m=null;return b.eachMapping(function(a){if(null!==m){if(!(k<a.generatedLine)){var b=i[0],c=b.substr(0,a.generatedColumn-l);return i[0]=b.substr(a.generatedColumn-l),l=a.generatedColumn,e(m,c),void(m=a)}var c="";e(m,j()),k++,l=0}for(;k<a.generatedLine;)h.add(j()),k++;if(l<a.generatedColumn){var b=i[0];h.add(b.substr(0,a.generatedColumn)),i[0]=b.substr(a.generatedColumn),l=a.generatedColumn}m=a},this),i.length>0&&(m&&e(m,j()),h.add(i.join(""))),b.sources.forEach(function(a){var d=b.sourceContentFor(a);null!=d&&(null!=c&&(a=f.join(c,a)),h.setSourceContent(a,d))}),h},d.prototype.add=function(a){if(Array.isArray(a))a.forEach(function(a){this.add(a)},this);else{if(!a[i]&&"string"!=typeof a)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+a);a&&this.children.push(a)}return this},d.prototype.prepend=function(a){if(Array.isArray(a))for(var b=a.length-1;b>=0;b--)this.prepend(a[b]);else{if(!a[i]&&"string"!=typeof a)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+a);this.children.unshift(a)}return this},d.prototype.walk=function(a){for(var b,c=0,d=this.children.length;d>c;c++)b=this.children[c],b[i]?b.walk(a):""!==b&&a(b,{source:this.source,line:this.line,column:this.column,name:this.name})},d.prototype.join=function(a){var b,c,d=this.children.length;if(d>0){for(b=[],c=0;d-1>c;c++)b.push(this.children[c]),b.push(a);b.push(this.children[c]),this.children=b}return this},d.prototype.replaceRight=function(a,b){var c=this.children[this.children.length-1];return c[i]?c.replaceRight(a,b):"string"==typeof c?this.children[this.children.length-1]=c.replace(a,b):this.children.push("".replace(a,b)),this},d.prototype.setSourceContent=function(a,b){this.sourceContents[f.toSetString(a)]=b},d.prototype.walkSourceContents=function(a){for(var b=0,c=this.children.length;c>b;b++)this.children[b][i]&&this.children[b].walkSourceContents(a);for(var d=Object.keys(this.sourceContents),b=0,c=d.length;c>b;b++)a(f.fromSetString(d[b]),this.sourceContents[d[b]])},d.prototype.toString=function(){var a="";return this.walk(function(b){a+=b}),a},d.prototype.toStringWithSourceMap=function(a){var b={code:"",line:1,column:0},c=new e(a),d=!1,f=null,g=null,i=null,j=null;return this.walk(function(a,e){b.code+=a,null!==e.source&&null!==e.line&&null!==e.column?((f!==e.source||g!==e.line||i!==e.column||j!==e.name)&&c.addMapping({source:e.source,original:{line:e.line,column:e.column},generated:{line:b.line,column:b.column},name:e.name}),f=e.source,g=e.line,i=e.column,j=e.name,d=!0):d&&(c.addMapping({generated:{line:b.line,column:b.column}}),f=null,d=!1);for(var k=0,l=a.length;l>k;k++)a.charCodeAt(k)===h?(b.line++,b.column=0,k+1===l?(f=null,d=!1):d&&c.addMapping({source:e.source,original:{line:e.line,column:e.column},generated:{line:b.line,column:b.column},name:e.name})):b.column++}),this.walkSourceContents(function(a,b){c.setSourceContent(a,b)}),{code:b.code,map:c}},b.SourceNode=d})},{"./source-map-generator":194,"./util":196,amdefine:197}],196:[function(a,b,c){if("function"!=typeof d)var d=a("amdefine")(b,a);d(function(a,b,c){function d(a,b,c){if(b in a)return a[b];if(3===arguments.length)return c;throw new Error('"'+b+'" is a required argument.')}function e(a){var b=a.match(o);return b?{scheme:b[1],auth:b[2],host:b[3],port:b[4],path:b[5]}:null}function f(a){var b="";return a.scheme&&(b+=a.scheme+":"),b+="//",a.auth&&(b+=a.auth+"@"),a.host&&(b+=a.host),a.port&&(b+=":"+a.port),a.path&&(b+=a.path),b}function g(a){var b=a,c=e(a);if(c){if(!c.path)return a;b=c.path}for(var d,g="/"===b.charAt(0),h=b.split(/\/+/),i=0,j=h.length-1;j>=0;j--)d=h[j],"."===d?h.splice(j,1):".."===d?i++:i>0&&(""===d?(h.splice(j+1,i),i=0):(h.splice(j,2),i--));return b=h.join("/"),""===b&&(b=g?"/":"."),c?(c.path=b,f(c)):b}function h(a,b){""===a&&(a="."),""===b&&(b=".");var c=e(b),d=e(a);if(d&&(a=d.path||"/"),c&&!c.scheme)return d&&(c.scheme=d.scheme),f(c);if(c||b.match(p))return b;if(d&&!d.host&&!d.path)return d.host=b,f(d);var h="/"===b.charAt(0)?b:g(a.replace(/\/+$/,"")+"/"+b);return d?(d.path=h,f(d)):h}function i(a,b){""===a&&(a="."),a=a.replace(/\/$/,"");var c=e(a);return"/"==b.charAt(0)&&c&&"/"==c.path?b.slice(1):0===b.indexOf(a+"/")?b.substr(a.length+1):b}function j(a){return"$"+a}function k(a){return a.substr(1)}function l(a,b){var c=a||"",d=b||"";return(c>d)-(d>c)}function m(a,b,c){var d;return(d=l(a.source,b.source))?d:(d=a.originalLine-b.originalLine)?d:(d=a.originalColumn-b.originalColumn,d||c?d:(d=l(a.name,b.name))?d:(d=a.generatedLine-b.generatedLine,d?d:a.generatedColumn-b.generatedColumn))}function n(a,b,c){var d;return(d=a.generatedLine-b.generatedLine)?d:(d=a.generatedColumn-b.generatedColumn,d||c?d:(d=l(a.source,b.source))?d:(d=a.originalLine-b.originalLine)?d:(d=a.originalColumn-b.originalColumn,d?d:l(a.name,b.name)))}b.getArg=d;var o=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.]*)(?::(\d+))?(\S*)$/,p=/^data:.+\,.+$/;b.urlParse=e,b.urlGenerate=f,b.normalize=g,b.join=h,b.relative=i,b.toSetString=j,b.fromSetString=k,b.compareByOriginalPositions=m,b.compareByGeneratedPositions=n})},{amdefine:197}],197:[function(a,b,c){"use strict";function d(b,c){function d(a){var b,c;for(b=0;a[b];b+=1)if(c=a[b],"."===c)a.splice(b,1),b-=1;else if(".."===c){if(1===b&&(".."===a[2]||".."===a[0]))break;b>0&&(a.splice(b-1,2),b-=2)}}function e(a,b){var c;return a&&"."===a.charAt(0)&&b&&(c=b.split("/"),c=c.slice(0,c.length-1),c=c.concat(a.split("/")),d(c),a=c.join("/")),a}function f(a){return function(b){return e(b,a)}}function g(a){function b(b){m[a]=b}return b.fromText=function(a,b){throw new Error("amdefine does not implement load.fromText")},b}function h(a,d,e){var f,g,h,i;if(a)g=m[a]={},h={id:a,uri:__filename,exports:g},f=j(c,g,h,a);else{if(n)throw new Error("amdefine with no module ID cannot be called more than once per file.");n=!0,g=b.exports,h=b,f=j(c,g,h,b.id)}d&&(d=d.map(function(a){return f(a)})),i="function"==typeof e?e.apply(h.exports,d):e,void 0!==i&&(h.exports=i,a&&(m[a]=h.exports))}function i(a,b,c){Array.isArray(a)?(c=b,b=a,a=void 0):"string"!=typeof a&&(c=a,a=b=void 0),b&&!Array.isArray(b)&&(c=b,b=void 0),b||(b=["require","exports","module"]),a?l[a]=[a,b,c]:h(a,b,c)}var j,k,l={},m={},n=!1,o=a("path");return j=function(a,b,c,d){function f(e,f){return"string"==typeof e?k(a,b,c,e,d):(e=e.map(function(e){return k(a,b,c,e,d)}),void(f&&process.nextTick(function(){f.apply(null,e)})))}return f.toUrl=function(a){return 0===a.indexOf(".")?e(a,o.dirname(c.filename)):a},f},c=c||function(){return b.require.apply(b,arguments)},k=function(a,b,c,d,i){var n,o,p=d.indexOf("!"),q=d;if(-1===p){if(d=e(d,i),"require"===d)return j(a,b,c,i);if("exports"===d)return b;if("module"===d)return c;if(m.hasOwnProperty(d))return m[d];if(l[d])return h.apply(null,l[d]),m[d];if(a)return a(q);throw new Error("No module with ID: "+d)}return n=d.substring(0,p),d=d.substring(p+1,d.length),o=k(a,b,c,n,i),d=o.normalize?o.normalize(d,f(i)):e(d,i),m[d]?m[d]:(o.load(d,j(a,b,c,i),g(d),{}),m[d])},i.require=function(a){return m[a]?m[a]:l[a]?(h.apply(null,l[a]),m[a]):void 0},i.amd={},i}b.exports=d},{path:167}],198:[function(a,b,c){b.exports=a("./dist/cjs/handlebars.runtime")["default"]},{"./dist/cjs/handlebars.runtime":169}],199:[function(a,b,c){b.exports=a("handlebars/runtime")["default"]},{"handlebars/runtime":198}],200:[function(a,b,c){!function(d,e){"function"==typeof define&&define.amd?define(e):"object"==typeof c?b.exports=e(a,c,b):d.Tether=e()}(this,function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a){var b=getComputedStyle(a)||{},c=b.position;if("fixed"===c)return a;for(var d=a;d=d.parentNode;){var e=void 0;try{e=getComputedStyle(d)}catch(f){}if("undefined"==typeof e||null===e)return d;var g=e,h=g.overflow,i=g.overflowX,j=g.overflowY;if(/(auto|scroll)/.test(h+j+i)&&("absolute"!==c||["relative","absolute","fixed"].indexOf(e.position)>=0))return d}return document.body}function f(a){var b=void 0;a===document?(b=document,a=document.documentElement):b=a.ownerDocument;var c=b.documentElement,d={},e=a.getBoundingClientRect();for(var f in e)d[f]=e[f];var g=y(b);return d.top-=g.top,d.left-=g.left,"undefined"==typeof d.width&&(d.width=document.body.scrollWidth-d.left-d.right),"undefined"==typeof d.height&&(d.height=document.body.scrollHeight-d.top-d.bottom),d.top=d.top-c.clientTop,d.left=d.left-c.clientLeft,d.right=b.body.clientWidth-d.width-d.left,d.bottom=b.body.clientHeight-d.height-d.top,d}function g(a){return a.offsetParent||document.documentElement}function h(){var a=document.createElement("div");a.style.width="100%",a.style.height="200px";var b=document.createElement("div");i(b.style,{position:"absolute",top:0,left:0,pointerEvents:"none",visibility:"hidden",width:"200px",height:"150px",overflow:"hidden"}),b.appendChild(a),document.body.appendChild(b);var c=a.offsetWidth;b.style.overflow="scroll";var d=a.offsetWidth;c===d&&(d=b.clientWidth),document.body.removeChild(b);var e=c-d;return{width:e,height:e}}function i(){var a=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],b=[];return Array.prototype.push.apply(b,arguments),b.slice(1).forEach(function(b){if(b)for(var c in b)({}).hasOwnProperty.call(b,c)&&(a[c]=b[c])}),a}function j(a,b){if("undefined"!=typeof a.classList)b.split(" ").forEach(function(b){b.trim()&&a.classList.remove(b)});else{var c=new RegExp("(^| )"+b.split(" ").join("|")+"( |$)","gi"),d=m(a).replace(c," ");n(a,d)}}function k(a,b){if("undefined"!=typeof a.classList)b.split(" ").forEach(function(b){b.trim()&&a.classList.add(b)});else{j(a,b);var c=m(a)+(" "+b);n(a,c)}}function l(a,b){if("undefined"!=typeof a.classList)return a.classList.contains(b);var c=m(a);return new RegExp("(^| )"+b+"( |$)","gi").test(c)}function m(a){return a.className instanceof SVGAnimatedString?a.className.baseVal:a.className}function n(a,b){a.setAttribute("class",b)}function o(a,b,c){c.forEach(function(c){-1===b.indexOf(c)&&l(a,c)&&j(a,c)}),b.forEach(function(b){l(a,b)||k(a,b)})}function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function p(a,b){var c=arguments.length<=2||void 0===arguments[2]?1:arguments[2];return a+c>=b&&b>=a-c}function q(){return"undefined"!=typeof performance&&"undefined"!=typeof performance.now?performance.now():+new Date}function r(){for(var a={top:0,left:0},b=arguments.length,c=Array(b),d=0;b>d;d++)c[d]=arguments[d];return c.forEach(function(b){var c=b.top,d=b.left;"string"==typeof c&&(c=parseFloat(c,10)),"string"==typeof d&&(d=parseFloat(d,10)),a.top+=c,a.left+=d}),a}function s(a,b){return"string"==typeof a.left&&-1!==a.left.indexOf("%")&&(a.left=parseFloat(a.left,10)/100*b.width),"string"==typeof a.top&&-1!==a.top.indexOf("%")&&(a.top=parseFloat(a.top,10)/100*b.height),a}function t(a,b){return"scrollParent"===b?b=a.scrollParent:"window"===b&&(b=[pageXOffset,pageYOffset,innerWidth+pageXOffset,innerHeight+pageYOffset]),b===document&&(b=b.documentElement),"undefined"!=typeof b.nodeType&&!function(){var a=f(b),c=a,d=getComputedStyle(b);b=[c.left,c.top,a.width+c.left,a.height+c.top],R.forEach(function(a,c){a=a[0].toUpperCase()+a.substr(1),"Top"===a||"Left"===a?b[c]+=parseFloat(d["border"+a+"Width"]):b[c]-=parseFloat(d["border"+a+"Width"])})}(),b}var u=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),v=void 0;"undefined"==typeof v&&(v={modules:[]});var w=function(){var a=0;return function(){return++a}}(),x={},y=function(a){var b=a._tetherZeroElement;"undefined"==typeof b&&(b=a.createElement("div"),b.setAttribute("data-tether-id",w()),i(b.style,{top:0,left:0,position:"absolute"}),a.body.appendChild(b),a._tetherZeroElement=b);var c=b.getAttribute("data-tether-id");if("undefined"==typeof x[c]){x[c]={};var d=b.getBoundingClientRect();for(var e in d)x[c][e]=d[e];A(function(){delete x[c]})}return x[c]},z=[],A=function(a){z.push(a)},B=function(){for(var a=void 0;a=z.pop();)a()},C=function(){function a(){d(this,a)}return u(a,[{key:"on",value:function(a,b,c){var d=arguments.length<=3||void 0===arguments[3]?!1:arguments[3];"undefined"==typeof this.bindings&&(this.bindings={}),"undefined"==typeof this.bindings[a]&&(this.bindings[a]=[]),this.bindings[a].push({handler:b,ctx:c,once:d})}},{key:"once",value:function(a,b,c){this.on(a,b,c,!0)}},{key:"off",value:function(a,b){if("undefined"==typeof this.bindings||"undefined"==typeof this.bindings[a])if("undefined"==typeof b)delete this.bindings[a];else for(var c=0;c<this.bindings[a].length;)this.bindings[a][c].handler===b?this.bindings[a].splice(c,1):++c}},{key:"trigger",value:function(a){if("undefined"!=typeof this.bindings&&this.bindings[a]){for(var b=0,c=arguments.length,d=Array(c>1?c-1:0),e=1;c>e;e++)d[e-1]=arguments[e];for(;b<this.bindings[a].length;){var f=this.bindings[a][b],g=f.handler,h=f.ctx,i=f.once,j=h;"undefined"==typeof j&&(j=this),g.apply(j,d),i?this.bindings[a].splice(b,1):++b}}}}]),a}();v.Utils={getScrollParent:e,getBounds:f,getOffsetParent:g,extend:i,addClass:k,removeClass:j,hasClass:l,updateClasses:o,defer:A,flush:B,uniqueId:w,Evented:C,getScrollBarSize:h};var D=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();if("undefined"==typeof v)throw new Error("You must include the utils.js file before tether.js");var E=v.Utils,e=E.getScrollParent,f=E.getBounds,g=E.getOffsetParent,i=E.extend,k=E.addClass,j=E.removeClass,o=E.updateClasses,A=E.defer,B=E.flush,h=E.getScrollBarSize,F=function(){if("undefined"==typeof document)return"";for(var a=document.createElement("div"),b=["transform","webkitTransform","OTransform","MozTransform","msTransform"],c=0;c<b.length;++c){var d=b[c];if(void 0!==a.style[d])return d}}(),G=[],H=function(){G.forEach(function(a){a.position(!1)}),B()};!function(){var a=null,b=null,c=null,d=function e(){return"undefined"!=typeof b&&b>16?(b=Math.min(b-16,250),void(c=setTimeout(e,250))):void("undefined"!=typeof a&&q()-a<10||("undefined"!=typeof c&&(clearTimeout(c),c=null),a=q(),H(),b=q()-a))};"undefined"!=typeof window&&["resize","scroll","touchmove"].forEach(function(a){window.addEventListener(a,d)})}();var I={center:"center",left:"right",right:"left"},J={middle:"middle",top:"bottom",bottom:"top"},K={top:0,left:0,middle:"50%",center:"50%",bottom:"100%",right:"100%"},L=function(a,b){var c=a.left,d=a.top;return"auto"===c&&(c=I[b.left]),"auto"===d&&(d=J[b.top]),{left:c,top:d}},M=function(a){var b=a.left,c=a.top;return"undefined"!=typeof K[a.left]&&(b=K[a.left]),"undefined"!=typeof K[a.top]&&(c=K[a.top]),{left:b,top:c}},N=function(a){var b=a.split(" "),c=D(b,2),d=c[0],e=c[1];return{top:d,left:e}},O=N,P=function(){function a(b){var c=this;d(this,a),this.position=this.position.bind(this),G.push(this),this.history=[],this.setOptions(b,!1),v.modules.forEach(function(a){"undefined"!=typeof a.initialize&&a.initialize.call(c)}),this.position()}return u(a,[{key:"getClass",value:function(){var a=arguments.length<=0||void 0===arguments[0]?"":arguments[0],b=this.options.classes;return"undefined"!=typeof b&&b[a]?this.options.classes[a]:this.options.classPrefix?this.options.classPrefix+"-"+a:a}},{key:"setOptions",value:function(a){var b=this,c=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],d={offset:"0 0",targetOffset:"0 0",targetAttachment:"auto auto",classPrefix:"tether"};this.options=i(d,a);var f=this.options,g=f.element,h=f.target,j=f.targetModifier;if(this.element=g,this.target=h,this.targetModifier=j,"viewport"===this.target?(this.target=document.body,this.targetModifier="visible"):"scroll-handle"===this.target&&(this.target=document.body,this.targetModifier="scroll-handle"),["element","target"].forEach(function(a){if("undefined"==typeof b[a])throw new Error("Tether Error: Both element and target must be defined");"undefined"!=typeof b[a].jquery?b[a]=b[a][0]:"string"==typeof b[a]&&(b[a]=document.querySelector(b[a]))}),k(this.element,this.getClass("element")),this.options.addTargetClasses!==!1&&k(this.target,this.getClass("target")),!this.options.attachment)throw new Error("Tether Error: You must provide an attachment");this.targetAttachment=O(this.options.targetAttachment),this.attachment=O(this.options.attachment),this.offset=N(this.options.offset),this.targetOffset=N(this.options.targetOffset),"undefined"!=typeof this.scrollParent&&this.disable(),"scroll-handle"===this.targetModifier?this.scrollParent=this.target:this.scrollParent=e(this.target),this.options.enabled!==!1&&this.enable(c)}},{key:"getTargetBounds",value:function(){if("undefined"==typeof this.targetModifier)return f(this.target);if("visible"===this.targetModifier){if(this.target===document.body)return{top:pageYOffset,left:pageXOffset,height:innerHeight,width:innerWidth};var a=f(this.target),b={height:a.height,width:a.width,top:a.top,left:a.left};return b.height=Math.min(b.height,a.height-(pageYOffset-a.top)),b.height=Math.min(b.height,a.height-(a.top+a.height-(pageYOffset+innerHeight))),b.height=Math.min(innerHeight,b.height),b.height-=2,b.width=Math.min(b.width,a.width-(pageXOffset-a.left)),b.width=Math.min(b.width,a.width-(a.left+a.width-(pageXOffset+innerWidth))),b.width=Math.min(innerWidth,b.width),b.width-=2,b.top<pageYOffset&&(b.top=pageYOffset),b.left<pageXOffset&&(b.left=pageXOffset),b}if("scroll-handle"===this.targetModifier){var a=void 0,c=this.target;c===document.body?(c=document.documentElement,a={left:pageXOffset,top:pageYOffset,height:innerHeight,width:innerWidth}):a=f(c);var d=getComputedStyle(c),e=c.scrollWidth>c.clientWidth||[d.overflow,d.overflowX].indexOf("scroll")>=0||this.target!==document.body,g=0;e&&(g=15);var h=a.height-parseFloat(d.borderTopWidth)-parseFloat(d.borderBottomWidth)-g,b={width:15,height:.975*h*(h/c.scrollHeight),left:a.left+a.width-parseFloat(d.borderLeftWidth)-15},i=0;408>h&&this.target===document.body&&(i=-11e-5*Math.pow(h,2)-.00727*h+22.58),this.target!==document.body&&(b.height=Math.max(b.height,24));var j=this.target.scrollTop/(c.scrollHeight-h);return b.top=j*(h-b.height-i)+a.top+parseFloat(d.borderTopWidth),this.target===document.body&&(b.height=Math.max(b.height,24)),b}}},{key:"clearCache",value:function(){this._cache={}}},{key:"cache",value:function(a,b){return"undefined"==typeof this._cache&&(this._cache={}),"undefined"==typeof this._cache[a]&&(this._cache[a]=b.call(this)),this._cache[a]}},{key:"enable",value:function(){var a=arguments.length<=0||void 0===arguments[0]?!0:arguments[0];this.options.addTargetClasses!==!1&&k(this.target,this.getClass("enabled")),k(this.element,this.getClass("enabled")),this.enabled=!0,this.scrollParent!==document&&this.scrollParent.addEventListener("scroll",this.position),a&&this.position()}},{key:"disable",value:function(){j(this.target,this.getClass("enabled")),j(this.element,this.getClass("enabled")),this.enabled=!1,"undefined"!=typeof this.scrollParent&&this.scrollParent.removeEventListener("scroll",this.position)}},{key:"destroy",value:function(){var a=this;this.disable(),G.forEach(function(b,c){return b===a?void G.splice(c,1):void 0;
})}},{key:"updateAttachClasses",value:function(a,b){var c=this;a=a||this.attachment,b=b||this.targetAttachment;var d=["left","top","bottom","right","middle","center"];"undefined"!=typeof this._addAttachClasses&&this._addAttachClasses.length&&this._addAttachClasses.splice(0,this._addAttachClasses.length),"undefined"==typeof this._addAttachClasses&&(this._addAttachClasses=[]);var e=this._addAttachClasses;a.top&&e.push(this.getClass("element-attached")+"-"+a.top),a.left&&e.push(this.getClass("element-attached")+"-"+a.left),b.top&&e.push(this.getClass("target-attached")+"-"+b.top),b.left&&e.push(this.getClass("target-attached")+"-"+b.left);var f=[];d.forEach(function(a){f.push(c.getClass("element-attached")+"-"+a),f.push(c.getClass("target-attached")+"-"+a)}),A(function(){"undefined"!=typeof c._addAttachClasses&&(o(c.element,c._addAttachClasses,f),c.options.addTargetClasses!==!1&&o(c.target,c._addAttachClasses,f),delete c._addAttachClasses)})}},{key:"position",value:function(){var a=this,b=arguments.length<=0||void 0===arguments[0]?!0:arguments[0];if(this.enabled){this.clearCache();var c=L(this.targetAttachment,this.attachment);this.updateAttachClasses(this.attachment,c);var d=this.cache("element-bounds",function(){return f(a.element)}),e=d.width,i=d.height;if(0===e&&0===i&&"undefined"!=typeof this.lastSize){var j=this.lastSize;e=j.width,i=j.height}else this.lastSize={width:e,height:i};var k=this.cache("target-bounds",function(){return a.getTargetBounds()}),l=k,m=s(M(this.attachment),{width:e,height:i}),n=s(M(c),l),o=s(this.offset,{width:e,height:i}),p=s(this.targetOffset,l);m=r(m,o),n=r(n,p);for(var q=k.left+n.left-m.left,t=k.top+n.top-m.top,u=0;u<v.modules.length;++u){var w=v.modules[u],x=w.position.call(this,{left:q,top:t,targetAttachment:c,targetPos:k,elementPos:d,offset:m,targetOffset:n,manualOffset:o,manualTargetOffset:p,scrollbarSize:z,attachment:this.attachment});if(x===!1)return!1;"undefined"!=typeof x&&"object"==typeof x&&(t=x.top,q=x.left)}var y={page:{top:t,left:q},viewport:{top:t-pageYOffset,bottom:pageYOffset-t-i+innerHeight,left:q-pageXOffset,right:pageXOffset-q-e+innerWidth}},z=void 0;return document.body.scrollWidth>window.innerWidth&&(z=this.cache("scrollbar-size",h),y.viewport.bottom-=z.height),document.body.scrollHeight>window.innerHeight&&(z=this.cache("scrollbar-size",h),y.viewport.right-=z.width),(-1===["","static"].indexOf(document.body.style.position)||-1===["","static"].indexOf(document.body.parentElement.style.position))&&(y.page.bottom=document.body.scrollHeight-t-i,y.page.right=document.body.scrollWidth-q-e),"undefined"!=typeof this.options.optimizations&&this.options.optimizations.moveElement!==!1&&"undefined"==typeof this.targetModifier&&!function(){var b=a.cache("target-offsetparent",function(){return g(a.target)}),c=a.cache("target-offsetparent-bounds",function(){return f(b)}),d=getComputedStyle(b),e=c,h={};if(["Top","Left","Bottom","Right"].forEach(function(a){h[a.toLowerCase()]=parseFloat(d["border"+a+"Width"])}),c.right=document.body.scrollWidth-c.left-e.width+h.right,c.bottom=document.body.scrollHeight-c.top-e.height+h.bottom,y.page.top>=c.top+h.top&&y.page.bottom>=c.bottom&&y.page.left>=c.left+h.left&&y.page.right>=c.right){var i=b.scrollTop,j=b.scrollLeft;y.offset={top:y.page.top-c.top+i-h.top,left:y.page.left-c.left+j-h.left}}}(),this.move(y),this.history.unshift(y),this.history.length>3&&this.history.pop(),b&&B(),!0}}},{key:"move",value:function(a){var b=this;if("undefined"!=typeof this.element.parentNode){var c={};for(var d in a){c[d]={};for(var e in a[d]){for(var f=!1,h=0;h<this.history.length;++h){var j=this.history[h];if("undefined"!=typeof j[d]&&!p(j[d][e],a[d][e])){f=!0;break}}f||(c[d][e]=!0)}}var k={top:"",left:"",right:"",bottom:""},l=function(a,c){var d="undefined"!=typeof b.options.optimizations,e=d?b.options.optimizations.gpu:null;if(e!==!1){var f=void 0,g=void 0;a.top?(k.top=0,f=c.top):(k.bottom=0,f=-c.bottom),a.left?(k.left=0,g=c.left):(k.right=0,g=-c.right),k[F]="translateX("+Math.round(g)+"px) translateY("+Math.round(f)+"px)","msTransform"!==F&&(k[F]+=" translateZ(0)")}else a.top?k.top=c.top+"px":k.bottom=c.bottom+"px",a.left?k.left=c.left+"px":k.right=c.right+"px"},m=!1;if((c.page.top||c.page.bottom)&&(c.page.left||c.page.right)?(k.position="absolute",l(c.page,a.page)):(c.viewport.top||c.viewport.bottom)&&(c.viewport.left||c.viewport.right)?(k.position="fixed",l(c.viewport,a.viewport)):"undefined"!=typeof c.offset&&c.offset.top&&c.offset.left?!function(){k.position="absolute";var d=b.cache("target-offsetparent",function(){return g(b.target)});g(b.element)!==d&&A(function(){b.element.parentNode.removeChild(b.element),d.appendChild(b.element)}),l(c.offset,a.offset),m=!0}():(k.position="absolute",l({top:!0,left:!0},a.page)),!m){for(var n=!0,o=this.element.parentNode;o&&"BODY"!==o.tagName;){if("static"!==getComputedStyle(o).position){n=!1;break}o=o.parentNode}n||(this.element.parentNode.removeChild(this.element),document.body.appendChild(this.element))}var q={},r=!1;for(var e in k){var s=k[e],t=this.element.style[e];""!==t&&""!==s&&["top","left","bottom","right"].indexOf(e)>=0&&(t=parseFloat(t),s=parseFloat(s)),t!==s&&(r=!0,q[e]=s)}r&&A(function(){i(b.element.style,q)})}}}]),a}();P.modules=[],v.position=H;var Q=i(P,v),D=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),E=v.Utils,f=E.getBounds,i=E.extend,o=E.updateClasses,A=E.defer,R=["left","top","right","bottom"];v.modules.push({position:function(a){var b=this,c=a.top,d=a.left,e=a.targetAttachment;if(!this.options.constraints)return!0;var g=this.cache("element-bounds",function(){return f(b.element)}),h=g.height,j=g.width;if(0===j&&0===h&&"undefined"!=typeof this.lastSize){var k=this.lastSize;j=k.width,h=k.height}var l=this.cache("target-bounds",function(){return b.getTargetBounds()}),m=l.height,n=l.width,p=[this.getClass("pinned"),this.getClass("out-of-bounds")];this.options.constraints.forEach(function(a){var b=a.outOfBoundsClass,c=a.pinnedClass;b&&p.push(b),c&&p.push(c)}),p.forEach(function(a){["left","top","right","bottom"].forEach(function(b){p.push(a+"-"+b)})});var q=[],r=i({},e),s=i({},this.attachment);return this.options.constraints.forEach(function(a){var f=a.to,g=a.attachment,i=a.pin;"undefined"==typeof g&&(g="");var k=void 0,l=void 0;if(g.indexOf(" ")>=0){var o=g.split(" "),p=D(o,2);l=p[0],k=p[1]}else k=l=g;var u=t(b,f);("target"===l||"both"===l)&&(c<u[1]&&"top"===r.top&&(c+=m,r.top="bottom"),c+h>u[3]&&"bottom"===r.top&&(c-=m,r.top="top")),"together"===l&&(c<u[1]&&"top"===r.top&&("bottom"===s.top?(c+=m,r.top="bottom",c+=h,s.top="top"):"top"===s.top&&(c+=m,r.top="bottom",c-=h,s.top="bottom")),c+h>u[3]&&"bottom"===r.top&&("top"===s.top?(c-=m,r.top="top",c-=h,s.top="bottom"):"bottom"===s.top&&(c-=m,r.top="top",c+=h,s.top="top")),"middle"===r.top&&(c+h>u[3]&&"top"===s.top?(c-=h,s.top="bottom"):c<u[1]&&"bottom"===s.top&&(c+=h,s.top="top"))),("target"===k||"both"===k)&&(d<u[0]&&"left"===r.left&&(d+=n,r.left="right"),d+j>u[2]&&"right"===r.left&&(d-=n,r.left="left")),"together"===k&&(d<u[0]&&"left"===r.left?"right"===s.left?(d+=n,r.left="right",d+=j,s.left="left"):"left"===s.left&&(d+=n,r.left="right",d-=j,s.left="right"):d+j>u[2]&&"right"===r.left?"left"===s.left?(d-=n,r.left="left",d-=j,s.left="right"):"right"===s.left&&(d-=n,r.left="left",d+=j,s.left="left"):"center"===r.left&&(d+j>u[2]&&"left"===s.left?(d-=j,s.left="right"):d<u[0]&&"right"===s.left&&(d+=j,s.left="left"))),("element"===l||"both"===l)&&(c<u[1]&&"bottom"===s.top&&(c+=h,s.top="top"),c+h>u[3]&&"top"===s.top&&(c-=h,s.top="bottom")),("element"===k||"both"===k)&&(d<u[0]&&("right"===s.left?(d+=j,s.left="left"):"center"===s.left&&(d+=j/2,s.left="left")),d+j>u[2]&&("left"===s.left?(d-=j,s.left="right"):"center"===s.left&&(d-=j/2,s.left="right"))),"string"==typeof i?i=i.split(",").map(function(a){return a.trim()}):i===!0&&(i=["top","left","right","bottom"]),i=i||[];var v=[],w=[];c<u[1]&&(i.indexOf("top")>=0?(c=u[1],v.push("top")):w.push("top")),c+h>u[3]&&(i.indexOf("bottom")>=0?(c=u[3]-h,v.push("bottom")):w.push("bottom")),d<u[0]&&(i.indexOf("left")>=0?(d=u[0],v.push("left")):w.push("left")),d+j>u[2]&&(i.indexOf("right")>=0?(d=u[2]-j,v.push("right")):w.push("right")),v.length&&!function(){var a=void 0;a="undefined"!=typeof b.options.pinnedClass?b.options.pinnedClass:b.getClass("pinned"),q.push(a),v.forEach(function(b){q.push(a+"-"+b)})}(),w.length&&!function(){var a=void 0;a="undefined"!=typeof b.options.outOfBoundsClass?b.options.outOfBoundsClass:b.getClass("out-of-bounds"),q.push(a),w.forEach(function(b){q.push(a+"-"+b)})}(),(v.indexOf("left")>=0||v.indexOf("right")>=0)&&(s.left=r.left=!1),(v.indexOf("top")>=0||v.indexOf("bottom")>=0)&&(s.top=r.top=!1),(r.top!==e.top||r.left!==e.left||s.top!==b.attachment.top||s.left!==b.attachment.left)&&b.updateAttachClasses(s,r)}),A(function(){b.options.addTargetClasses!==!1&&o(b.target,q,p),o(b.element,q,p)}),{top:c,left:d}}});var E=v.Utils,f=E.getBounds,o=E.updateClasses,A=E.defer;v.modules.push({position:function(a){var b=this,c=a.top,d=a.left,e=this.cache("element-bounds",function(){return f(b.element)}),g=e.height,h=e.width,i=this.getTargetBounds(),j=c+g,k=d+h,l=[];c<=i.bottom&&j>=i.top&&["left","right"].forEach(function(a){var b=i[a];(b===d||b===k)&&l.push(a)}),d<=i.right&&k>=i.left&&["top","bottom"].forEach(function(a){var b=i[a];(b===c||b===j)&&l.push(a)});var m=[],n=[],p=["left","top","right","bottom"];return m.push(this.getClass("abutted")),p.forEach(function(a){m.push(b.getClass("abutted")+"-"+a)}),l.length&&n.push(this.getClass("abutted")),l.forEach(function(a){n.push(b.getClass("abutted")+"-"+a)}),A(function(){b.options.addTargetClasses!==!1&&o(b.target,n,m),o(b.element,n,m)}),!0}});var D=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();return v.modules.push({position:function(a){var b=a.top,c=a.left;if(this.options.shift){var d=this.options.shift;"function"==typeof this.options.shift&&(d=this.options.shift.call(this,{top:b,left:c}));var e=void 0,f=void 0;if("string"==typeof d){d=d.split(" "),d[1]=d[1]||d[0];var g=d,h=D(g,2);e=h[0],f=h[1],e=parseFloat(e,10),f=parseFloat(f,10)}else e=d.top,f=d.left;return b+=e,c+=f,{top:b,left:c}}}}),Q})},{}]},{},[79]);